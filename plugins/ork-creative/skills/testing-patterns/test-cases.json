{
  "skill": "testing-patterns",
  "version": "2.0.0",
  "testCases": [
    {
      "id": "unit-aaa-pattern",
      "rule": "unit-aaa-pattern",
      "query": "Write a unit test for a discount calculator",
      "expectedBehavior": [
        "Uses Arrange-Act-Assert structure",
        "Creates fresh instances per test via beforeEach",
        "Tests behavior not implementation",
        "Includes meaningful assertion messages"
      ]
    },
    {
      "id": "unit-parametrized",
      "rule": "unit-parametrized",
      "query": "Test email validation with multiple inputs",
      "expectedBehavior": [
        "Uses test.each or @pytest.mark.parametrize",
        "Covers valid, invalid, and edge case inputs",
        "Uses descriptive test names with parameters"
      ]
    },
    {
      "id": "unit-fixture-scoping",
      "rule": "unit-fixture-scoping",
      "query": "Set up pytest fixtures for database tests",
      "expectedBehavior": [
        "Uses function scope for mutable state",
        "Uses session scope for expensive setup like DB engine",
        "Includes cleanup via yield"
      ]
    },
    {
      "id": "integration-api",
      "rule": "integration-api",
      "query": "Write integration tests for a REST API endpoint",
      "expectedBehavior": [
        "Uses supertest or httpx AsyncClient",
        "Tests both success and error responses",
        "Validates response status and body"
      ]
    },
    {
      "id": "integration-database",
      "rule": "integration-database",
      "query": "Test database operations with transaction rollback",
      "expectedBehavior": [
        "Creates fresh database state per test",
        "Uses in-memory SQLite or test container",
        "Rolls back transactions after test"
      ]
    },
    {
      "id": "integration-component",
      "rule": "integration-component",
      "query": "Test a React form component with API interaction",
      "expectedBehavior": [
        "Wraps in QueryClientProvider",
        "Uses userEvent for interactions",
        "Asserts on user-visible outcomes"
      ]
    },
    {
      "id": "e2e-playwright",
      "rule": "e2e-playwright",
      "query": "Write Playwright tests for a checkout flow",
      "expectedBehavior": [
        "Uses getByRole semantic locators",
        "Avoids hardcoded waits",
        "Uses auto-wait with expect assertions"
      ]
    },
    {
      "id": "e2e-ai-agents",
      "rule": "e2e-ai-agents",
      "query": "Set up Playwright AI agents for test generation",
      "expectedBehavior": [
        "Runs npx playwright init-agents --loop=claude",
        "Creates specs/ directory and seed.spec.ts",
        "Describes Planner/Generator/Healer workflow"
      ]
    },
    {
      "id": "e2e-page-objects",
      "rule": "e2e-page-objects",
      "query": "Create page objects for a multi-page test",
      "expectedBehavior": [
        "Extracts page interactions into reusable classes",
        "Uses semantic locators within page objects",
        "Keeps tests readable and maintainable"
      ]
    },
    {
      "id": "pytest-markers",
      "rule": "pytest-execution",
      "query": "Categorize tests with custom pytest markers",
      "expectedBehavior": [
        "Defines markers in pyproject.toml",
        "Uses @pytest.mark.slow, @pytest.mark.smoke",
        "Shows CLI selection with -m flag"
      ]
    },
    {
      "id": "pytest-xdist",
      "rule": "pytest-execution",
      "query": "Run tests in parallel with pytest-xdist",
      "expectedBehavior": [
        "Configures -n auto --dist loadscope",
        "Isolates database per worker_id",
        "Handles shared resources safely"
      ]
    },
    {
      "id": "pytest-plugins",
      "rule": "pytest-plugins",
      "query": "Create reusable pytest plugins and hooks",
      "expectedBehavior": [
        "Implements factory fixtures in conftest.py",
        "Uses pytest hooks for customization",
        "Configures pytest-asyncio auto mode"
      ]
    },
    {
      "id": "mocking-msw",
      "rule": "mocking-msw",
      "query": "Mock API responses with MSW in Vitest tests",
      "expectedBehavior": [
        "Uses http.get/post handlers",
        "Sets up server.listen/resetHandlers/close lifecycle",
        "Uses server.use() for per-test overrides"
      ]
    },
    {
      "id": "mocking-vcr",
      "rule": "mocking-vcr",
      "query": "Record HTTP interactions with VCR.py",
      "expectedBehavior": [
        "Configures cassette_library_dir and record_mode",
        "Filters sensitive headers and body data",
        "Uses 'none' mode for CI"
      ]
    },
    {
      "id": "mocking-llm-apis",
      "rule": "llm-mocking",
      "query": "Mock LLM API responses for testing",
      "expectedBehavior": [
        "Uses custom matchers ignoring dynamic fields",
        "Filters API keys from cassettes",
        "Supports async VCR for httpx"
      ]
    },
    {
      "id": "data-factories",
      "rule": "data-factories",
      "query": "Create test data factories for user and analysis models",
      "expectedBehavior": [
        "Uses FactoryBoy with Faker for Python",
        "Uses faker with spread overrides for TypeScript",
        "Supports SubFactory for relationships"
      ]
    },
    {
      "id": "data-fixtures",
      "rule": "data-fixtures",
      "query": "Load JSON fixtures in pytest tests",
      "expectedBehavior": [
        "Loads fixtures from JSON files",
        "Composes fixtures for complex scenarios",
        "Uses conftest.py for shared fixtures"
      ]
    },
    {
      "id": "data-seeding-cleanup",
      "rule": "data-seeding-cleanup",
      "query": "Seed test database and clean up between tests",
      "expectedBehavior": [
        "Seeds database with factory-generated data",
        "Uses autouse fixture for automatic cleanup",
        "Truncates tables with CASCADE"
      ]
    },
    {
      "id": "verification-property",
      "rule": "verification-techniques",
      "query": "Write property-based tests with Hypothesis",
      "expectedBehavior": [
        "Uses @given with appropriate strategies",
        "Tests roundtrip and idempotence properties",
        "Bounds inputs to avoid slow generation"
      ]
    },
    {
      "id": "verification-stateful",
      "rule": "verification-stateful",
      "query": "Test a stateful API with Hypothesis state machines",
      "expectedBehavior": [
        "Uses RuleBasedStateMachine",
        "Models state transitions as rules",
        "Verifies invariants after each step"
      ]
    },
    {
      "id": "verification-contract",
      "rule": "verification-contract",
      "query": "Set up Pact contract tests between services",
      "expectedBehavior": [
        "Writes consumer test with expectations",
        "Uses Like/EachLike matchers",
        "Configures provider verification with states"
      ]
    },
    {
      "id": "perf-k6",
      "rule": "perf-k6",
      "query": "Write a k6 load test with thresholds",
      "expectedBehavior": [
        "Defines stages for ramp-up/steady/ramp-down",
        "Sets p95 and error rate thresholds",
        "Uses check() for response validation"
      ]
    },
    {
      "id": "perf-locust",
      "rule": "perf-locust",
      "query": "Create a Locust load test for an API",
      "expectedBehavior": [
        "Defines HttpUser with @task decorators",
        "Implements on_start for authentication",
        "Uses wait_time between requests"
      ]
    },
    {
      "id": "perf-types",
      "rule": "perf-types",
      "query": "What type of performance test should I run?",
      "expectedBehavior": [
        "Distinguishes load/stress/spike/soak tests",
        "Recommends appropriate profiles for each",
        "Includes CI integration patterns"
      ]
    },
    {
      "id": "llm-mocking",
      "rule": "llm-mocking",
      "query": "Mock LLM responses in unit tests",
      "expectedBehavior": [
        "Uses AsyncMock with return_value",
        "Patches model_factory.get_model",
        "Avoids live API calls in CI"
      ]
    },
    {
      "id": "llm-deepeval",
      "rule": "llm-evaluation",
      "query": "Evaluate LLM output quality with DeepEval",
      "expectedBehavior": [
        "Creates LLMTestCase with input/output/context",
        "Uses AnswerRelevancy and Faithfulness metrics",
        "Sets appropriate thresholds"
      ]
    },
    {
      "id": "llm-structured",
      "rule": "llm-evaluation",
      "query": "Test structured LLM output and timeouts",
      "expectedBehavior": [
        "Validates JSON schema compliance",
        "Tests timeout handling with asyncio.timeout",
        "Covers null/empty edge cases"
      ]
    },
    {
      "id": "a11y-jest-axe",
      "rule": "a11y-testing",
      "query": "Add accessibility tests to React components",
      "expectedBehavior": [
        "Uses jest-axe toHaveNoViolations matcher",
        "Tests all component states",
        "Renders with testing-library"
      ]
    },
    {
      "id": "a11y-playwright",
      "rule": "a11y-playwright",
      "query": "Run page-level accessibility audits with Playwright",
      "expectedBehavior": [
        "Uses @axe-core/playwright AxeBuilder",
        "Configures wcag2a/wcag2aa/wcag22aa tags",
        "Tests interactive states like modals"
      ]
    },
    {
      "id": "a11y-ci-gates",
      "rule": "a11y-testing",
      "query": "Set up CI gates for accessibility",
      "expectedBehavior": [
        "Blocks PRs with accessibility violations",
        "Runs both unit and E2E a11y tests",
        "Includes GitHub Actions workflow"
      ]
    }
  ]
}
