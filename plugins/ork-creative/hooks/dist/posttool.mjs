// OrchestKit Hooks - posttool bundle
// Generated: 2026-02-10T00:10:18.910Z

var v=(t=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(t,{get:(e,n)=>(typeof require<"u"?require:e)[n]}):t)(function(t){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+t+'" is not supported')});function Vi(t){return typeof t.command=="string"}function Yi(t){return typeof t.file_path=="string"&&typeof t.content=="string"}function Qi(t){return typeof t.file_path=="string"&&typeof t.old_string=="string"&&typeof t.new_string=="string"}function ta(t){return typeof t.file_path=="string"&&t.content===void 0}import{appendFileSync as It,existsSync as Rt,statSync as wn,renameSync as Cn,mkdirSync as En,readSync as Tn}from"node:fs";import{execSync as $n}from"node:child_process";import sn from"node:os";import O from"node:path";function it(){return process.env.HOME||process.env.USERPROFILE||sn.homedir()}function at(){return process.env.CLAUDE_PROJECT_DIR||"."}function wt(){return process.env.CLAUDE_PLUGIN_ROOT||process.env.CLAUDE_PROJECT_DIR||"."}function Ct(){return process.env.CLAUDE_PLUGIN_ROOT?O.join(it(),".claude","logs","ork"):O.join(at(),".claude","logs")}var ct=O.join,oa=O.sep;import{execSync as an}from"node:child_process";import{createHash as cn}from"node:crypto";import{existsSync as Et,readFileSync as un,writeFileSync as ln,mkdirSync as dn}from"node:fs";import{join as ut,basename as gn}from"node:path";var pn=20,mn=15,fn=/[^a-z0-9-]/g;function yn(t){let e=t||process.env.CLAUDE_PROJECT_DIR||process.cwd(),n=gn(e);return Tt(n,pn)}function hn(t){if(process.env.ORCHESTKIT_SESSION_BRANCH)return process.env.ORCHESTKIT_SESSION_BRANCH;let e=t||process.env.CLAUDE_PROJECT_DIR||process.cwd();try{let n=an("git branch --show-current",{cwd:e,encoding:"utf8",timeout:2e3,stdio:["pipe","pipe","pipe"]}).trim(),r=Tt(n||"detached",mn);return process.env.ORCHESTKIT_SESSION_BRANCH=r,r}catch{return"nobranch"}}function _n(t){let e=t||new Date,n=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0");return`${n}${r}`}function kn(t){let e=t||new Date,n=String(e.getHours()).padStart(2,"0"),r=String(e.getMinutes()).padStart(2,"0");return`${n}${r}`}function bn(){let t=`${process.pid}-${Date.now()}-${Math.random()}`;return cn("sha256").update(t).digest("hex").slice(0,4)}function Tt(t,e){return t.toLowerCase().replace(fn,"-").replace(/-+/g,"-").replace(/^-|-$/g,"").slice(0,e)}function Sn(t,e){let n=yn(t),r=hn(t),o=_n(e),s=kn(e),i=bn();return`${n}-${r}-${o}-${s}-${i}`}function xn(t){let e=t||process.env.CLAUDE_PROJECT_DIR||process.cwd(),n=ut(e,".instance","session-id.json");if(Et(n))try{let r=JSON.parse(un(n,"utf8"));if(r.session_id&&r.created_at){let o=Date.now()-new Date(r.created_at).getTime(),s=1440*60*1e3;if(o<s)return r.session_id}}catch{}}function vn(t,e){let n=e||process.env.CLAUDE_PROJECT_DIR||process.cwd(),r=ut(n,".instance"),o=ut(r,"session-id.json");try{Et(r)||dn(r,{recursive:!0}),ln(o,JSON.stringify({session_id:t,created_at:new Date().toISOString()},null,2))}catch{}}function $t(t){if(process.env.CLAUDE_SESSION_ID)return process.env.CLAUDE_SESSION_ID;let e=xn(t);if(e)return e;let n=Sn(t);return vn(n,t),n}function At(){return Ct()}function g(){return at()}function lt(){return wt()}function fa(){return process.env.CLAUDE_ENV_FILE?process.env.CLAUDE_ENV_FILE:`${lt()}/.claude/.instance_env`}function f(){return $t()}function ya(t){if(process.env.ORCHESTKIT_BRANCH)return process.env.ORCHESTKIT_BRANCH;try{let e=$n("git branch --show-current",{cwd:t||g(),encoding:"utf8",timeout:5e3,stdio:["pipe","pipe","pipe"]}).trim();return process.env.ORCHESTKIT_BRANCH=e,e}catch{return"unknown"}}function In(){return process.env.ORCHESTKIT_LOG_LEVEL||"warn"}function ha(t){return t.replace(/\r\n/g,`
`)}function Rn(t){let e=["debug","info","warn","error"];return e.indexOf(t)>=e.indexOf(In())}function l(){return{continue:!0,suppressOutput:!0}}function _a(){return{continue:!0,suppressOutput:!0,hookSpecificOutput:{permissionDecision:"allow"}}}function ka(t){return{continue:!1,stopReason:t,hookSpecificOutput:{permissionDecision:"deny",permissionDecisionReason:t}}}function D(t){return{continue:!0,suppressOutput:!0,hookSpecificOutput:{hookEventName:"PostToolUse",additionalContext:t}}}function An(t){return{continue:!0,suppressOutput:!0,hookSpecificOutput:{hookEventName:"UserPromptSubmit",additionalContext:t}}}function ba(t,e){let n={continue:!0,suppressOutput:!0};return t&&(n.systemMessage=t),e&&(n.hookSpecificOutput={hookEventName:"UserPromptSubmit",additionalContext:e}),n}function Sa(t,e){let n={continue:!0,hookSpecificOutput:{hookEventName:"PreToolUse",additionalContext:t,permissionDecision:"allow"}};return e?n.systemMessage=e:n.suppressOutput=!0,n}function xa(t){return{continue:!0,systemMessage:t}}function va(t){return{continue:!0,systemMessage:`\u26A0 ${t}`}}function wa(t){return{continue:!1,stopReason:t,hookSpecificOutput:{hookEventName:"PreToolUse",permissionDecision:"deny",permissionDecisionReason:t}}}function Ca(t){return{continue:!0,suppressOutput:!0,hookSpecificOutput:{hookEventName:"PreToolUse",updatedInput:t}}}var On=200*1024,Dn=100*1024;function Ot(t,e){if(Rt(t))try{if(wn(t).size>e){let r=`${t}.old.${Date.now()}`;Cn(t,r)}}catch{}}function Dt(t){Rt(t)||En(t,{recursive:!0})}function a(t,e,n="debug"){if(!Rn(n))return;let r=At(),o=`${r}/hooks.log`;try{Dt(r),Ot(o,On);let s=new Date().toISOString().replace("T"," ").slice(0,19);It(o,`[${s}] [${n.toUpperCase()}] [${t}] ${e}
`)}catch{}}function Ea(t,e,n){let r=At(),o=`${r}/permission-feedback.log`;try{Dt(r),Ot(o,Dn);let s=new Date().toISOString(),i=n?.tool_name||process.env.HOOK_TOOL_NAME||"unknown",u=n?.session_id||f();It(o,`${s} | ${t} | ${e} | tool=${i} | session=${u}
`)}catch{}}function dt(t){if(!t)return 0;let r=(t.match(/[{};()=><]/g)||[]).length/t.length>.03?2.8:3.5;return Math.ceil(t.length/r)}function Ta(t,e,n,r,o){let s=dt(t);return r&&r.isOverBudget(n)?(a(e,`Budget exhausted for ${n}, suppressing ${s}t`),l()):(o&&o.trackTokenUsage(e,n,s),An(t))}function $a(){try{let t=[],n=Buffer.allocUnsafe(256),r,o=0;for(;;)try{if(r=Tn(o,n,0,256,null),r===0)break;t.push(Buffer.from(n.subarray(0,r)))}catch{break}let s=Buffer.concat(t).toString("utf8").trim();return s?JSON.parse(s):{tool_name:"",session_id:f(),tool_input:{}}}catch{return{tool_name:"",session_id:f(),tool_input:{}}}}function p(t,e){let n=e.replace(/^\./,"").split("."),r=t;for(let o of n){if(r==null)return;r=r[o]}return r}function Ia(t){return t.replace(/\\\s*[\r\n]+/g," ").replace(/\n/g," ").replace(/\s+/g," ").trim()}function Ra(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}import{execSync as T}from"node:child_process";function Pn(t){let e=t||g();try{return T("git branch --show-current",{cwd:e,encoding:"utf8",timeout:5e3,stdio:["pipe","pipe","pipe"]}).trim()}catch{return"unknown"}}function Nn(t){let e=t||Pn();return["dev","main","master"].includes(e)}function Pa(t){let e=t||g();try{return T("git rev-parse --show-toplevel",{cwd:e,encoding:"utf8",timeout:5e3,stdio:["pipe","pipe","pipe"]}).trim()}catch{return e}}function Na(t){let e=t||g();try{return T("git rev-parse --git-dir",{cwd:e,encoding:"utf8",timeout:5e3,stdio:["pipe","pipe","pipe"]}),!0}catch{return!1}}function Hn(t){let e=t||g();try{return T("git status --short",{cwd:e,encoding:"utf8",timeout:1e4,stdio:["pipe","pipe","pipe"]}).trim()}catch{return""}}function Ha(t){return Hn(t).length>0}function ja(t){let e=t||g();try{return T("git rev-parse --verify main",{cwd:e,encoding:"utf8",timeout:5e3,stdio:["pipe","pipe","pipe"]}),"main"}catch{try{return T("git rev-parse --verify master",{cwd:e,encoding:"utf8",timeout:5e3,stdio:["pipe","pipe","pipe"]}),"master"}catch{return"main"}}}function jn(t){let e=[/issue\/(\d+)/i,/feature\/(\d+)/i,/fix\/(\d+)/i,/bug\/(\d+)/i,/feat\/(\d+)/i,/^(\d+)-/,/-(\d+)$/,/#(\d+)/];for(let n of e){let r=t.match(n);if(r)return parseInt(r[1],10)}return null}function Fa(t){if(Nn(t))return null;let e=["issue/","feature/","fix/","bug/","feat/","chore/","docs/","refactor/","test/","ci/","perf/","style/","release/","hotfix/"];return e.some(r=>t.startsWith(r))?t.startsWith("issue/")&&!jn(t)?"issue/ branches should include an issue number (e.g., issue/123-description)":null:`Branch name should start with a valid prefix: ${e.join(", ")}`}import{appendFileSync as Fn,existsSync as Nt,mkdirSync as Mn,statSync as Ln,renameSync as Bn}from"node:fs";var Pt="/tmp/claude-read-count";function P(t){let e=t.tool_name||"";if(["Read","Glob","Grep"].includes(e))try{let{readFileSync:o,writeFileSync:s}=v("node:fs"),i=0;try{i=parseInt(o(Pt,"utf8").trim(),10)||0}catch{}if(i++,s(Pt,String(i)),i%10!==0)return l()}catch{}let n=process.env.CLAUDE_PROJECT_DIR||".",r=`${n}/.claude/logs/audit.log`;try{let o=`${n}/.claude/logs`;Nt(o)||Mn(o,{recursive:!0}),Un(r,200*1024);let s=new Date().toISOString().replace("T"," ").slice(0,19),i="";switch(e){case"Bash":{i=(p(t,"tool_input.command")||"").substring(0,100);break}case"Write":case"Edit":{i=p(t,"tool_input.file_path")||"";break}case"Task":{i=p(t,"tool_input.subagent_type")||"";break}}let u=i?`[${s}] ${e} | ${i}
`:`[${s}] ${e}
`;Fn(r,u)}catch{}return l()}function Un(t,e){if(Nt(t))try{if(Ln(t).size>e){let r=`${t}.old.${Date.now()}`;Bn(t,r)}}catch{}}import{existsSync as $,appendFileSync as zn,readFileSync as R,writeFileSync as N,mkdirSync as Ft,statSync as Jn,renameSync as Wn}from"node:fs";import{createHash as Mt}from"node:crypto";var Ht=/error:|Error:|ERROR|FATAL|exception|failed|denied|not found|does not exist|connection refused|timeout|ENOENT|EACCES|EPERM/i,Gn=/^(echo |ls |ls$|pwd|cat |head |tail |wc |date|whoami)/,jt=2e3,qn=10,Zn=3,Kn=1e3*1024;function Xn(t){let e=String(p(t,"tool_output")||t.tool_output||""),n=String(t.tool_error||p(t,"error")||""),r=t.exit_code??0,o=!1,s="",i="";if(r!==0&&r!==void 0&&(o=!0,s="exit_code",i=`Exit code: ${r}`),n&&(o=!0,s=s||"tool_error",i=i||n),Ht.test(e)){o=!0,s=s||"output_pattern";let u=e.split(`
`).filter(c=>Ht.test(c));i=i||u[0]||""}return{isError:o,errorType:s,errorMessage:i,errorText:n||e}}function Vn(t){if($(t))try{Jn(t).size>Kn&&Wn(t,`${t}.old.${Date.now()}`)}catch{}}function Yn(t,e){let n=g(),r=`${n}/.claude/logs/errors.jsonl`,o="/tmp/claude-session-errors.json";try{Ft(`${n}/.claude/logs`,{recursive:!0}),Vn(r);let s=Mt("md5").update(JSON.stringify(t.tool_input||{})).digest("hex"),i={timestamp:new Date().toISOString(),tool:t.tool_name,session_id:f(),error_type:e.errorType,error_message:e.errorMessage.substring(0,500),input_hash:s,tool_input:t.tool_input,output_preview:e.errorText.substring(0,1e3)};zn(r,JSON.stringify(i)+`
`);try{let u={error_count:0,last_error_tool:"",last_error_time:""};$(o)&&(u=JSON.parse(R(o,"utf8"))),u.error_count=(u.error_count||0)+1,u.last_error_tool=t.tool_name||"",u.last_error_time=new Date().toISOString(),N(o,JSON.stringify(u,null,2))}catch{}a("unified-error-handler",`ERROR: ${t.tool_name} - ${e.errorType}`)}catch{a("unified-error-handler",`ERROR (fallback): ${t.tool_name}`)}}function Qn(t,e){if(!$(e))return null;try{let n=JSON.parse(R(e,"utf8")),r=t.toLowerCase();for(let o of n.patterns||[])if(o.regex)try{if(new RegExp(o.regex,"i").test(r))return o}catch{}}catch{}return null}function tr(t,e,n){if(!$(n))try{Ft(v("path").dirname(n),{recursive:!0}),N(n,JSON.stringify({suggestions:{},prompt_count:0}))}catch{return!0}try{let r=JSON.parse(R(n,"utf8")),o=Mt("md5").update(`${t}|${e.substring(0,100)}`).digest("hex"),s=(r.prompt_count||0)+1;r.prompt_count=s;let i=r.suggestions[o]?.prompt_count||0;return i===0||s-i>=qn?(r.suggestions[o]={pattern_id:t,prompt_count:s},N(n,JSON.stringify(r,null,2)),!0):(N(n,JSON.stringify(r,null,2)),!1)}catch{return!0}}function er(t,e){let n=`${e}/${t}/SKILL.md`;if(!$(n))return"";try{let o=R(n,"utf8").match(/^---\n([\s\S]*?)\n---/);if(o){let s=o[1].match(/description:\s*(.+)/);if(s)return s[1].trim()}}catch{}return""}function nr(t,e,n){let r=t.solution?.brief||"An error was detected.",o=t.solution?.steps||[],s=`## Error Solution

`;s+=`**${r}**

`,o.length>0&&(s+=`### Quick Fixes

`,o.forEach((d,m)=>{s+=`  ${m+1}. ${d}
`}),s+=`
`);let i=t.skills||[],u=[];if(t.category&&$(e))try{u=JSON.parse(R(e,"utf8")).categories?.[t.category]?.related_skills||[]}catch{}let c=[...new Set([...i,...u])].slice(0,Zn);if(c.length>0){s+=`### Related Skills

`;for(let d of c){let m=er(d,n);s+=m?`- **${d}**: ${m}
`:`- **${d}**
`}s+="\nUse `/ork:<skill-name>` or `Read skills/<skill-name>/SKILL.md`"}return s.length>jt?s.substring(0,jt-20)+`...

(truncated)`:s}function Lt(t){let e=t.tool_name||"";if(e==="Bash"){let r=p(t,"tool_input.command")||"";if(Gn.test(r))return l()}let n=Xn(t);if(!n.isError)return l();if(Yn(t,n),e==="Bash"){let r=lt(),o=`${r}/.claude/rules/error_solutions.json`,s=`${r}/skills`,i=`/tmp/claude-error-suggestions-${f()}.json`,u=Qn(n.errorText.substring(0,2e3),o);if(u&&tr(u.id,n.errorText,i)){let c=nr(u,o,s);if(c)return a("unified-error-handler",`Suggesting solution for pattern: ${u.id}`),{continue:!0,hookSpecificOutput:{additionalContext:c}}}}return l()}import{existsSync as rr}from"node:fs";import{execSync as I}from"node:child_process";import{basename as or}from"node:path";function sr(t){switch(t.split(".").pop()?.toLowerCase()){case"py":return"python";case"ts":case"tsx":return"typescript";case"js":case"jsx":return"javascript";case"json":return"json";case"css":case"scss":return"css";default:return null}}function gt(t){try{return I(`which ${t}`,{stdio:"ignore"}),!0}catch{return!1}}function Bt(t){let e=t.tool_name||"";if(e!=="Write"&&e!=="Edit")return l();let n=p(t,"tool_input.file_path")||"";if(!n||n.includes("/.claude/")||n.includes("/node_modules/")||n.includes("/.git/")||n.includes("/dist/")||n.endsWith(".lock"))return l();let r=process.env.CLAUDE_PROJECT_DIR||".",o=n.startsWith("/")?n:`${r}/${n}`;if(!rr(o))return l();if(process.env.SKIP_AUTO_LINT==="1")return l();let s=sr(n);if(!s)return l();let i=0,u=!1;try{switch(s){case"python":if(gt("ruff")){try{let c=I(`timeout 5s ruff check --output-format=concise "${o}" 2>&1`,{encoding:"utf8",stdio:["pipe","pipe","pipe"]});c&&(i=c.split(`
`).filter(Boolean).length,I(`timeout 5s ruff check --fix --unsafe-fixes=false "${o}" 2>/dev/null`,{stdio:"ignore"}),u=!0)}catch{}try{I(`timeout 5s ruff format "${o}" 2>/dev/null`,{stdio:"ignore"})}catch{}}break;case"typescript":case"javascript":if(gt("biome"))try{let c=I(`timeout 5s biome check --write "${o}" 2>&1`,{encoding:"utf8",stdio:["pipe","pipe","pipe"]});c.includes("Fixed")&&(u=!0),c.includes("error")&&(i=(c.match(/error/g)||[]).length)}catch{}break;case"json":case"css":if(gt("biome"))try{I(`timeout 5s biome format --write "${o}" 2>/dev/null`,{stdio:"ignore"}),u=!0}catch{}break}}catch(c){a("auto-lint",`Error: ${c}`)}if(u&&i>0){let c=or(n);return{continue:!0,systemMessage:`Auto-lint: fixed issues, ${i} remaining in ${c}`}}return l()}import{existsSync as pt,readFileSync as mt,writeFileSync as j,mkdirSync as ir}from"node:fs";var H=2200,Ut=.7,ar=.5,cr=.1;function ur(t){if(!pt(t))return 0;try{let e=mt(t,"utf8");return dt(e)}catch{return 0}}function zt(){let e=`${g()}/context`,n=[`${e}/identity.json`,`${e}/session/state.json`,`${e}/knowledge/index.json`,`${e}/knowledge/blockers/current.json`],r=0;for(let o of n)r+=ur(o);return r}function Jt(){let t=parseInt(process.env.CLAUDE_MAX_CONTEXT||"200000",10);return Math.floor(t*(100-20)/100)}function lr(t){let e=Jt();return e===0?!0:t/e>cr}function dr(t,e){let r=`/tmp/claude-mcp-defer-state-${f()}.json`,o=Jt(),s={mcp_deferred:t,context_tokens:e,effective_window:o,updated_at:new Date().toISOString(),reason:t?"context > 10% threshold":"context within limits"};try{j(r,JSON.stringify(s,null,2))}catch{}a("context-budget-monitor",`MCP defer state updated: defer=${t}, tokens=${e}, window=${o}`)}function gr(){let e=`${g()}/context/session/state.json`;if(pt(e))try{let n=JSON.parse(mt(e,"utf8")),r={session_id:n.session_id,started:n.started,current_task:n.current_task,next_steps:(n.next_steps||[]).slice(-3),blockers:n.blockers,_compressed:!0,_compressed_at:new Date().toISOString(),_original_files_touched:(n.files_touched||[]).length,_original_decisions:(n.decisions_this_session||[]).length};j(e,JSON.stringify(r,null,2)),a("context-budget-monitor","Session state compressed")}catch{}}function pr(){let t=g(),e=`${t}/context/knowledge/decisions/active.json`;if(pt(e))try{let n=JSON.parse(mt(e,"utf8")),r=n.decisions||[];if(r.length>10){a("context-budget-monitor","Archiving old decisions (keeping latest 5)...");let o=`${t}/context/archive/decisions`;ir(o,{recursive:!0});let s=new Date,i=`${o}/${s.getFullYear()}-${String(s.getMonth()+1).padStart(2,"0")}.json`;j(i,JSON.stringify(r.slice(0,-5),null,2)),n.decisions=r.slice(-5),j(e,JSON.stringify(n,null,2)),a("context-budget-monitor",`Archived ${r.length-5} decisions to ${i}`)}}catch{}}function Wt(t){try{let e=zt(),n=e/H,r=Math.floor(n*100);a("context-budget-monitor",`Context usage: ${e} / ${H} tokens (${r}%)`);let o=lr(e);if(dr(o,e),n>Ut){a("context-budget-monitor",`WARNING: Context usage (${r}%) exceeds threshold (${Ut*100}%)`),a("context-budget-monitor","Triggering compression..."),gr(),pr();let s=zt(),i=s/H,u=Math.floor(i*100);a("context-budget-monitor",`After compression: ${s} / ${H} tokens (${u}%)`),i>ar?a("context-budget-monitor","WARNING: Still above target. Manual review recommended."):a("context-budget-monitor","Compression successful. Target achieved.")}else a("context-budget-monitor","Context usage within budget. No compression needed.")}catch(e){a("context-budget-monitor",`Error: ${e}`)}return l()}function F(t){a("mem0-webhook-handler","Mem0 webhook handler starting");let e=t.tool_name||"",n=p(t,"tool_input.command")||"";if(e!=="Bash"||!n.includes("webhook-receiver.py"))return l();let r=p(t,"tool_result")||"";if(!r)return a("mem0-webhook-handler","No event data found in webhook call"),l();try{let o;try{o=JSON.parse(r)}catch{return a("mem0-webhook-handler","Could not parse event data"),l()}let s=o.result?.event_type||o.event_type||"",i=o.result?.memory_id||o.memory?.id||"";a("mem0-webhook-handler",`Processing webhook event: ${s} (memory: ${i})`),["memory.created","memory.updated","memory.deleted"].includes(s)?a("mem0-webhook-handler",`Received ${s} for memory ${i}`):a("mem0-webhook-handler",`Received unknown event type: ${s}`)}catch(o){a("mem0-webhook-handler",`Error processing webhook: ${o}`)}return l()}function M(t){return(t.tool_name||"")==="mcp__memory__create_entities"?(a("memory-bridge","mcp__memory__create_entities - graph is primary, no sync needed"),l()):l()}import{existsSync as Kt,readFileSync as Xt,writeFileSync as Vt,mkdirSync as mr}from"node:fs";var fr=/decided|chose|architecture|security|blocked|breaking|critical|must|cannot|deprecated|removed|migration/i,yr=/pattern|convention|preference|style|format|naming/i,hr=30,_r=85,kr=90;function br(){let t=parseInt(process.env.CLAUDE_CONTEXT_USED_PERCENTAGE||"0",10);if(t===0){let e=parseInt(process.env.CLAUDE_CONTEXT_TOKENS_USED||"0",10),n=parseInt(process.env.CLAUDE_CONTEXT_MAX_TOKENS||"0",10);if(n>0)return Math.floor(e*100/n)}return t}function Sr(t){return fr.test(t)?"IMMEDIATE":yr.test(t)?"BATCHED":"SESSION_END"}function Gt(t){let e=[/[^.]*\b(decided|chose|selected|will use|must|cannot|blocked|breaking)[^.]*/i,/[^.]*\b(architecture|security|migration|deprecated)[^.]*/i];for(let r of e){let o=t.match(r);if(o)return o[0].trim().substring(0,300)}let n=t.match(/^[^.]{30,200}\./);return n?n[0].trim():t.substring(0,300).trim()}function qt(t){let e=t.toLowerCase();return/security|auth|jwt|oauth|cors|xss/.test(e)?"security":/architecture|design|structure|system/.test(e)?"architecture":/database|schema|migration|postgres|sql/.test(e)?"database":/blocked|issue|bug|problem|cannot/.test(e)?"blocker":/breaking|deprecated|removed|migration/.test(e)?"breaking-change":/api|endpoint|route|rest/.test(e)?"api":/decided|chose|selected/.test(e)?"decision":"general"}function xr(t){if(!Kt(t))try{mr(v("path").dirname(t),{recursive:!0}),Vt(t,JSON.stringify({pending:[],created_at:new Date().toISOString()}))}catch{}}function vr(t,e,n){xr(n);try{let r=JSON.parse(Xt(n,"utf8"));r.pending.push({content:t,category:e,queued_at:new Date().toISOString()}),Vt(n,JSON.stringify(r,null,2)),a("realtime-sync",`Added to pending queue: category=${e}, length=${t.length}`)}catch{}}function Zt(t){if(!Kt(t))return 0;try{return JSON.parse(Xt(t,"utf8")).pending?.length||0}catch{return 0}}function L(t){let e=t.tool_name||"";if(!["Bash","Write","Edit","Skill","Task"].includes(e))return l();let n="";switch(e){case"Bash":{n=String(p(t,"tool_output")||t.tool_output||"");let c=p(t,"tool_input.command")||"";c&&(n=`${c}
${n}`);break}case"Write":case"Edit":{let c=p(t,"tool_input.new_string")||p(t,"tool_input.content")||"",d=p(t,"tool_input.file_path")||"";n=d?`Writing to ${d}: ${c}`:c;break}case"Skill":case"Task":{n=String(p(t,"tool_result")||t.tool_output||"");break}}if(!n||n.length<hr)return l();let r=Sr(n);a("realtime-sync",`Tool: ${e}, Priority: ${r}, Content length: ${n.length}`);let o=br(),s=g(),i=f(),u=`${s}/.claude/logs/.mem0-pending-sync-${i}.json`;if(r==="BATCHED"&&o>=_r&&(r="IMMEDIATE",a("realtime-sync",`EMERGENCY: Context at ${o}%, upgrading BATCHED to IMMEDIATE`)),o>=kr){let c=Zt(u);if(c>0)return a("realtime-sync",`CRITICAL: Context at ${o}%, flushing ${c} pending items`),{continue:!0,systemMessage:`[CRITICAL SYNC] Context at ${o}% - compaction imminent!

${c} items in pending queue need immediate sync to knowledge graph.
Pending sync file: ${u}

Execute mcp__memory__create_entities for each item in the pending file NOW
to preserve session context in the knowledge graph before compaction.`}}switch(r){case"IMMEDIATE":{let c=Gt(n);if(!c||c.length<20)return a("realtime-sync","Could not extract meaningful decision"),l();let d=qt(c);return a("realtime-sync",`IMMEDIATE sync triggered: category=${d}`),{continue:!0,systemMessage:`[IMMEDIATE SYNC] Critical decision detected - store in knowledge graph now.

Category: ${d}
Decision: "${c.substring(0,200)}"

Store in knowledge graph with mcp__memory__create_entities:
\`\`\`json
{
  "entities": [{
    "name": "${d}-decision",
    "entityType": "Decision",
    "observations": ["${c.substring(0,300).replace(/"/g,'\\"')}"]
  }]
}
\`\`\`

This decision is critical and should be synced immediately for:
- Session continuity if interrupted
- Cross-agent knowledge sharing
- Future reference in similar contexts`}}case"BATCHED":{let c=Gt(n);if(c&&c.length>=20){let d=qt(c);vr(c,d,u);let m=Zt(u);if(m>=5)return a("realtime-sync",`BATCHED queue has ${m} items - triggering batch sync`),{continue:!0,systemMessage:`[BATCHED SYNC] ${m} patterns/conventions queued for graph sync.

Latest: "${c.substring(0,100)}..." (${d})

These will be synced to knowledge graph at session end, or trigger batch sync now with mcp__memory__create_entities for each item in:
${u}`}}return l()}default:return l()}}import{existsSync as re,appendFileSync as Pr,mkdirSync as Nr,readFileSync as Hr,writeFileSync as jr}from"node:fs";import{existsSync as wr,readFileSync as Cr,writeFileSync as gc,mkdirSync as pc}from"node:fs";import{execSync as Yt}from"node:child_process";import{createHash as Er}from"node:crypto";import*as Qt from"node:os";var Tr=".claude/.user_identity.json",$r="orchestkit-user-identity-v1";var S=null;function B(t){return Er("sha256").update(t+$r).digest("hex").slice(0,32)}function Ir(){try{return Qt.hostname()}catch{return"unknown-machine"}}function Rr(t){let e=`${t}/${Tr}`;if(!wr(e))return null;try{let n=Cr(e,"utf8");return JSON.parse(n)}catch(n){return a("user-identity",`Failed to read user config: ${n}`,"warn"),null}}function Ar(t){let e={};try{e.email=Yt("git config user.email",{cwd:t,encoding:"utf8",timeout:2e3,stdio:["pipe","pipe","pipe"]}).trim()}catch{}try{e.name=Yt("git config user.name",{cwd:t,encoding:"utf8",timeout:2e3,stdio:["pipe","pipe","pipe"]}).trim()}catch{}return e}function Or(){return{username:process.env.USER||process.env.USERNAME||process.env.LOGNAME}}function Dr(t){if(S)return S;let e=t||g(),n=Ir(),r=Rr(e);if(r?.user_id)return S={user_id:r.user_id,display_name:r.display_name||r.user_id,team_id:r.team_id,machine_id:n,source:"config",anonymous_id:B(r.user_id),email:r.user_id.includes("@")?r.user_id:void 0},a("user-identity",`Resolved from config: ${S.anonymous_id}`,"debug"),S;let o=Ar(e);if(o.email)return S={user_id:o.email,display_name:o.name||o.email.split("@")[0],team_id:r?.team_id,machine_id:n,source:"git",anonymous_id:B(o.email),email:o.email},a("user-identity",`Resolved from git: ${S.anonymous_id}`,"debug"),S;let s=Or();if(s.username){let u=`${s.username}@${n}`;return S={user_id:u,display_name:s.username,team_id:r?.team_id,machine_id:n,source:"env",anonymous_id:B(u)},a("user-identity",`Resolved from env: ${S.anonymous_id}`,"debug"),S}let i=B(n+process.pid);return S={user_id:`anon-${i.slice(0,8)}`,display_name:"Anonymous",team_id:r?.team_id,machine_id:n,source:"anonymous",anonymous_id:i},a("user-identity",`Resolved as anonymous: ${S.anonymous_id}`,"debug"),S}function te(){let t=Dr();return{session_id:f(),user_id:t.user_id,anonymous_id:t.anonymous_id,team_id:t.team_id,machine_id:t.machine_id,identity_source:t.source,timestamp:new Date().toISOString()}}var Fr=/^[a-zA-Z0-9_-]{1,128}$/;function Mr(t){return Fr.test(t)}function ht(t,e){let n=t||f(),r=e||g();if(!Mr(n))throw new Error("Invalid session ID format");return`${r}/.claude/memory/sessions/${n}`}function Lr(t,e){return`${ht(t,e)}/events.jsonl`}function oe(t,e){let n=ht(t,e);re(n)||Nr(n,{recursive:!0})}var A=0,ee=!1,ft=!1,ne=0,Br=5e3;function se(t,e){return`${ht(t,e)}/counter.json`}function Ur(t,e){if(!ee){ee=!0;try{let n=se(t,e);if(re(n)){let r=JSON.parse(Hr(n,"utf8"));typeof r.counter=="number"&&r.counter>0&&(A=r.counter,a("session-tracker",`Loaded event counter: ${A}`,"debug"))}}catch{}}}function zr(t,e){if(!ft)return;let n=Date.now();if(!(n-ne<Br))try{oe(t,e);let r=se(t,e);jr(r,JSON.stringify({counter:A,updated_at:new Date().toISOString()})),ft=!1,ne=n}catch{}}function Jr(){return Ur(),A++,ft=!0,zr(),`evt-${Date.now()}-${A}`}function U(t,e,n={}){try{let r={event_id:Jr(),event_type:t,identity:te(),payload:{name:e,input:yt(n.input),output:yt(n.output),duration_ms:n.duration_ms,success:n.success??!0,context:n.context?_t(n.context,500):void 0,confidence:n.confidence}};oe();let o=Lr();Pr(o,JSON.stringify(r)+`
`),a("session-tracker",`Tracked ${t}: ${e}`,"debug")}catch(r){a("session-tracker",`Failed to track event: ${r}`,"warn")}}function ie(t,e,n=!0,r){U("skill_invoked",t,{input:e?{args:e}:void 0,success:n,duration_ms:r})}function ae(t,e,n=!0){U("agent_spawned",t,{input:e?{prompt:_t(e,200)}:void 0,success:n})}function ce(t,e,n){U("solution_found","solution",{context:t,input:e?{problem_id:e}:void 0,confidence:n,success:!0})}function ue(t,e=!0,n,r){U("tool_used",t,{success:e,duration_ms:n,input:r?{category:r}:void 0})}function _t(t,e){return t.length<=e?t:t.slice(0,e-3)+"..."}function yt(t){if(!t)return;let e={},n=["password","secret","token","key","credential","auth"];for(let[r,o]of Object.entries(t)){if(n.some(s=>r.toLowerCase().includes(s))){e[r]="[REDACTED]";continue}if(typeof o=="string"&&o.length>500){e[r]=_t(o,500);continue}if(typeof o=="object"&&o!==null&&!Array.isArray(o)){e[r]=yt(o);continue}e[r]=o}return e}var Wr={Grep:"search",Glob:"search",WebSearch:"web",Read:"file_read",Write:"file_write",Edit:"file_edit",MultiEdit:"file_edit",NotebookEdit:"file_edit",Bash:"execution",Task:"agent",Skill:"skill",WebFetch:"web",AskUserQuestion:"interaction",TaskCreate:"task_mgmt",TaskUpdate:"task_mgmt",TaskList:"task_mgmt",TaskGet:"task_mgmt",TaskOutput:"task_mgmt",TaskStop:"task_mgmt",EnterPlanMode:"interaction",ExitPlanMode:"interaction"};function le(t){return Wr[t]||"other"}import{existsSync as ge,readFileSync as Gr,writeFileSync as qr,mkdirSync as Zr,appendFileSync as wc}from"node:fs";import{join as Kr,dirname as Xr,basename as kt}from"node:path";var Vr=[/\b(pytest|jest|vitest|npm\s+test|yarn\s+test|bun\s+test|go\s+test)\b/i,/\b(test|tests|spec)\b.*\b(run|execute)\b/i],Yr=[/\b(npm\s+run\s+build|yarn\s+build|make|cargo\s+build|docker\s+build|tsc)\b/i,/\b(build|compile)\b/i],Qr=[/\bgit\s+(commit|push|pull|merge|rebase|checkout|branch|status|diff|log)\b/i,/\bgh\s+(pr|issue)\b/i];function pe(t){return Kr(g(),".claude","memory","flows",`${t}.json`)}function to(t){let e=pe(t);if(!ge(e))return null;try{let n=Gr(e,"utf-8");return JSON.parse(n)}catch(n){return a("decision-flow-tracker",`Failed to load flow for ${t}: ${n}`,"warn"),null}}function eo(t){let e=pe(t.session_id);try{let n=Xr(e);return ge(n)||Zr(n,{recursive:!0}),qr(e,JSON.stringify(t,null,2)),!0}catch(n){return a("decision-flow-tracker",`Failed to save flow: ${n}`,"warn"),!1}}function no(t,e,n){return t==="Read"||t==="Glob"||t==="Grep"?"exploration":t==="Write"||t==="Edit"||t==="MultiEdit"||t==="NotebookEdit"?"modification":t==="Task"?"agent":t==="Bash"&&e?Vr.some(r=>r.test(e))?"testing":Yr.some(r=>r.test(e))?"building":Qr.some(r=>r.test(e))?"git":"execution":"other"}function ro(t,e,n,r){let o=r==="success"?"\u2713":r==="failure"?"\u2717":"~";if(t==="Read")return`${o} Read ${kt(n??"")||"file"}`;if(t==="Write")return`${o} Write ${kt(n??"")||"file"}`;if(t==="Edit")return`${o} Edit ${kt(n??"")||"file"}`;if(t==="Glob")return`${o} Search files`;if(t==="Grep")return`${o} Search content`;if(t==="Task")return`${o} Spawn agent`;if(t==="Bash"&&e){let s=e.split(`
`)[0].slice(0,50);return`${o} ${s}${e.length>50?"...":""}`}return`${o} ${t}`}function oo(t){if(t.length<3)return"mixed";let e={exploration:0,modification:0,testing:0,building:0,agent:0,execution:0,git:0,other:0};for(let n of t)e[n.category]++;if(e.testing>=2){let n=t.map((o,s)=>o.category==="testing"?s:-1).filter(o=>o>=0),r=t.map((o,s)=>o.category==="modification"?s:-1).filter(o=>o>=0);if(n.length>=2&&r.length>0&&n[0]<r[0])return"test-first"}if(e.exploration>=3&&e.modification>0&&so(t,"exploration")>=3)return"explore-first";if(e.modification>=2&&e.execution+e.testing>=2&&io(t,"modification",["execution","testing"])>=2)return"iterate-fast";if(e.agent>=3||e.agent/t.length>.3)return"agent-delegate";if(e.modification>=3&&e.testing===1){let n=t.map((r,o)=>r.category==="testing"?o:-1).filter(r=>r>=0).pop();if(n&&n>t.length-3)return"big-bang"}return"mixed"}function so(t,e){let n=0,r=0;for(let o of t)o.category===e?(r++,n=Math.max(n,r)):r=0;return n}function io(t,e,n){let r=0,o=!1;for(let s of t){let i=s.category===e,u=n.includes(s.category);i&&!o?o=!0:u&&o&&(r++,o=!1)}return r}function de(t){let e=t.filter(n=>n.result==="success").length;return{total_actions:t.length,reads:t.filter(n=>n.category==="exploration").length,writes:t.filter(n=>n.category==="modification").length,tests:t.filter(n=>n.category==="testing").length,builds:t.filter(n=>n.category==="building").length,agent_spawns:t.filter(n=>n.category==="agent").length,success_rate:t.length>0?e/t.length:0}}function me(t,e,n,r,o){let s=new Date().toISOString(),i="success";o!==void 0&&(i=o===0?"success":"failure");let u=no(e,n,r),c=ro(e,n,r,i),d={tool:e,file:r,timestamp:s,summary:c,result:i,exit_code:o,category:u},m=to(t);return m||(m={session_id:t,actions:[],started_at:s,last_action_at:s,stats:de([])}),m.actions.push(d),m.actions.length>100&&(m.actions=m.actions.slice(-100)),m.last_action_at=s,m.inferred_pattern=oo(m.actions),m.stats=de(m.actions),eo(m),m}function ao(t){let e=t.tool_input;if(!e||typeof e!="object")return;let n=e.skill;if(typeof n=="string")return n}function co(t){let e=t.tool_input;if(!e||typeof e!="object")return;let n=e.subagent_type;if(typeof n=="string")return n}function uo(t){let e=t.tool_input;if(!e||typeof e!="object")return;let n=e.prompt;if(typeof n=="string")return n.length>200?n.slice(0,200)+"...":n}function lo(t){let e=t.tool_input;if(!e||typeof e!="object")return;let n=e.command;if(typeof n=="string")return n}function go(t){let e=t.tool_input;if(!e||typeof e!="object")return;let n=e.file_path;if(typeof n=="string")return n}function po(t){return!t.tool_error}function z(t){try{let e=t.tool_name||"unknown",n=po(t),r=le(e),o=t.session_id||f();ue(e,n,void 0,r);let s=lo(t),i=go(t);if(me(o,e,s,i,n?0:1),e==="Skill"){let c=ao(t);c&&(ie(c,void 0,n),a("user-tracking",`Tracked skill: ${c}`,"debug"))}if(e==="Task"){let c=co(t);if(c){let d=uo(t);ae(c,d,n),a("user-tracking",`Tracked agent: ${c}`,"debug")}}return l()}catch(e){return a("user-tracking",`Error: ${e}`,"warn"),l()}}import{existsSync as mo,readFileSync as fo,writeFileSync as yo}from"node:fs";var J="/tmp/claude-session-metrics.json",Nc=`${J}.lock`;function W(t){let e=t.tool_name||"";if(!e)return l();try{let n={tools:{},errors:0,warnings:0};if(mo(J))try{let o=fo(J,"utf8").trim();o&&(n=JSON.parse(o))}catch{n={tools:{},errors:0,warnings:0}}n.tools||(n.tools={});let r=n.tools[e]||0;n.tools[e]=r+1,yo(J,JSON.stringify(n,null,2))}catch(n){a("session-metrics",`Error updating metrics: ${n}`)}return l()}import{existsSync as ho,readFileSync as _o,appendFileSync as ko,mkdirSync as bo}from"node:fs";var So=[{name:"add_pagination",regex:/limit.*offset|page.*size|cursor.*pagination|paginate|Paginated/i},{name:"add_rate_limiting",regex:/rate.?limit|throttl|RateLimiter|requests.?per/i},{name:"add_caching",regex:/@cache|cache_key|TTL|redis|memcache|@cached/i},{name:"add_retry_logic",regex:/retry|backoff|max_attempts|tenacity|Retry/i},{name:"add_error_handling",regex:/try.*catch|except|raise.*Exception|throw.*Error|error.*handler/i},{name:"add_validation",regex:/validate|Validator|@validate|Pydantic|Zod|yup|schema/i},{name:"add_logging",regex:/logger[.]|logging[.]|console[.]log|winston|pino|structlog/i},{name:"add_types",regex:/: *(str|int|bool|List|Dict|Optional)|interface |type .*=/i},{name:"add_type_guards",regex:/isinstance|typeof|is.*Type|assert.*type/i},{name:"add_docstring",regex:/docstring|"""[^"]+"""|\/\*\*/i},{name:"remove_comments",regex:/^-.*#|^-.*\/\/|^-.*\*/m},{name:"add_auth_check",regex:/@auth|@require_auth|isAuthenticated|requiresAuth|@login_required/i},{name:"add_input_sanitization",regex:/escape|sanitize|htmlspecialchars|DOMPurify/i},{name:"add_test_case",regex:/def test_|it\(|describe\(|expect\(|assert|@pytest/i},{name:"add_mock",regex:/Mock|patch|jest[.]mock|vi[.]mock|MagicMock/i},{name:"modify_imports",regex:/^[+-].*import|^[+-].*from.*import|^[+-].*require\(/m},{name:"add_async",regex:/async |await |Promise|asyncio|async def/i}];function xo(t){if(!ho(t))return"";try{let e=JSON.parse(_o(t,"utf8")),r=Math.floor(Date.now()/1e3)-300;return(e.recentSkills||[]).filter(s=>s.timestamp>r).sort((s,i)=>i.timestamp-s.timestamp)[0]?.skillId||""}catch{return""}}function vo(t){let e=[];for(let{name:n,regex:r}of So)r.test(t)&&e.push(n);return e}function wo(t,e,n,r){let o=f(),i={timestamp:new Date().toISOString(),skill_id:t,file_path:e,session_id:o,patterns:n};try{bo(v("path").dirname(r),{recursive:!0}),ko(r,JSON.stringify(i)+`
`)}catch{}}function G(t){let e=t.tool_name||"";if(e!=="Write"&&e!=="Edit")return l();let n=p(t,"tool_input.file_path")||"";if(!n)return l();let r=g(),o=`${r}/.claude/session/state.json`,s=xo(o);if(!s)return l();let i="";if(e==="Edit"){let c=p(t,"tool_input.old_string")||"",d=p(t,"tool_input.new_string")||"";if(c&&d){let m=c.split(`
`),h=d.split(`
`);i=m.map(_=>`-${_}`).join(`
`)+`
`+h.map(_=>`+${_}`).join(`
`)}}else i=p(t,"tool_input.content")||"";if(!i)return l();let u=vo(i);if(u.length>0){let c=`${r}/.claude/feedback/edit-patterns.jsonl`;wo(s,n,u,c),process.env.CLAUDE_HOOK_DEBUG&&a("skill-edit-tracker",`Detected ${u.length} patterns for ${s}: ${JSON.stringify(u)}`)}return l()}import{existsSync as _e,readFileSync as Co,writeFileSync as Eo,mkdirSync as To}from"node:fs";import{createHash as $o}from"node:crypto";var fe=500;var ye=15,he=3;function ke(){return`${g()}/.claude/feedback/calibration-data.json`}function Io(){let t=`${g()}/.claude/feedback`;if(!_e(t))try{To(t,{recursive:!0})}catch{}}function Ro(){let t=ke();if(_e(t))try{return JSON.parse(Co(t,"utf8"))}catch{a("calibration-engine","Failed to load calibration data, using defaults")}return{schemaVersion:"1.0.0",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),records:[],adjustments:[],stats:{totalDispatches:0,successRate:0,avgConfidence:0,topAgents:[]}}}function Ao(t){Io();let e=ke();t.updatedAt=new Date().toISOString();try{Eo(e,JSON.stringify(t,null,2)),a("calibration-engine","Saved calibration data")}catch(n){a("calibration-engine",`Failed to save calibration data: ${n}`)}}function Oo(t){return $o("sha256").update(t.toLowerCase().trim()).digest("hex").slice(0,16)}function be(t,e,n,r,o,s,i){let u=Ro(),c={timestamp:new Date().toISOString(),sessionId:f(),agent:e,promptHash:Oo(t),matchedKeywords:n,dispatchConfidence:r,outcome:o,durationMs:s,feedback:i};u.records.push(c),u.records.length>fe&&(u.records=u.records.slice(-fe)),Do(u,c),Po(u),Ao(u),a("calibration-engine",`Recorded outcome: ${e} -> ${o} (conf: ${r})`)}function Do(t,e){let n=e.outcome==="success",r=e.outcome==="failure"||e.outcome==="rejected";if(!n&&!r)return;let o=n?he:-he;for(let s of e.matchedKeywords){let i=t.adjustments.find(u=>u.keyword===s&&u.agent===e.agent);i?(i.adjustment=Math.max(-ye,Math.min(ye,i.adjustment+o)),i.sampleCount++,i.lastUpdated=new Date().toISOString()):t.adjustments.push({keyword:s,agent:e.agent,adjustment:o,sampleCount:1,lastUpdated:new Date().toISOString()})}}function Po(t){let e=t.records;if(e.length===0)return;t.stats.totalDispatches=e.length;let n=e.filter(s=>s.outcome==="success").length;t.stats.successRate=n/e.length;let r=e.reduce((s,i)=>s+i.dispatchConfidence,0)/e.length;t.stats.avgConfidence=Math.round(r);let o=new Map;for(let s of e){let i=o.get(s.agent)||{count:0,success:0};i.count++,s.outcome==="success"&&i.success++,o.set(s.agent,i)}t.stats.topAgents=Array.from(o.entries()).map(([s,i])=>({agent:s,count:i.count,successRate:i.success/i.count})).sort((s,i)=>i.count-s.count).slice(0,10)}import{existsSync as No,readFileSync as Ho,writeFileSync as Wc,mkdirSync as Gc}from"node:fs";function jo(){let t=f();return`${g()}/.claude/orchestration/task-registry-${t}.json`}function Fo(){let t=jo();if(No(t))try{return JSON.parse(Ho(t,"utf8"))}catch{}return{schemaVersion:"1.0.0",sessionId:f(),tasks:[],pipelines:[],updatedAt:new Date().toISOString()}}function Se(t){return Fo().tasks.find(n=>n.taskId===t)}import{existsSync as ve,readFileSync as we,writeFileSync as Xc,mkdirSync as Vc}from"node:fs";function Mo(){return`${g()}/.claude/orchestration`}function Lo(){let t=f();return`${Mo()}/session-${t}.json`}function Bo(){return`${g()}/.claude/orchestration/config.json`}function Uo(){let t=Lo();if(ve(t))try{let e=we(t,"utf8");return JSON.parse(e)}catch(e){a("orchestration-state",`Failed to load state: ${e}`)}return{sessionId:f(),activeAgents:[],injectedSkills:[],promptHistory:[],maxHistorySize:10,updatedAt:new Date().toISOString()}}function Ce(){return Uo().lastClassification}var xe={enableAutoDispatch:!0,enableSkillInjection:!0,maxSkillInjectionTokens:800,enableCalibration:!0,enablePipelines:!0,maxRetries:3,retryDelayBaseMs:1e3};function Ee(){let t=Bo();if(ve(t))try{let e=we(t,"utf8");return{...xe,...JSON.parse(e)}}catch{}return xe}function zo(t){let e=t.tool_input||{};return typeof e.taskId=="string"?e.taskId:null}function Jo(t){return t.tool_name!=="TaskUpdate"?!1:typeof(t.tool_input||{}).status=="string"}function Wo(t){switch(t){case"completed":return"success";case"pending":return null;default:return null}}function q(t){if(!Jo(t))return l();if(!Ee().enableCalibration)return l();let n=t.tool_input||{},r=zo(t),o=n.status;if(!r)return l();let s=Wo(o);if(!s)return l();a("calibration-tracker",`Tracking task ${r} status update to ${o}`);let i=Se(r);if(!i)return a("calibration-tracker",`Task ${r} not found in registry`),l();let u=i.agent;if(!u)return a("calibration-tracker",`No agent associated with task ${r}`),l();let d=Ce()?.agents.find(w=>w.agent===u),m=d?.matchedKeywords||[],h=i.confidence||d?.confidence||0,_=i.createdAt?Date.now()-new Date(i.createdAt).getTime():void 0;return be("",u,m,h,s,_),a("calibration-tracker",`Recorded calibration: ${u} -> ${s} (conf: ${h})`),l()}import{appendFileSync as Go,mkdirSync as qo,statSync as Zo,renameSync as Ko}from"node:fs";import{createHash as Xo}from"node:crypto";function Vo(){return ct(it(),".claude","analytics")}function Z(t){return Xo("sha256").update(t).digest("hex").slice(0,12)}function Te(){let t=process.env.CLAUDE_CODE_TEAM_NAME;return t?{team:t}:void 0}function Yo(t,e=10485760){try{if(Zo(t).size>e){let r=new Date().toISOString().slice(0,7),o=t.replace(/\.jsonl$/,`.${r}.jsonl`);Ko(t,o)}}catch{}}function K(t,e){try{let n=Vo();qo(n,{recursive:!0});let r=ct(n,t);Yo(r),Go(r,JSON.stringify(e)+`
`)}catch{}}import{existsSync as Qo,readFileSync as ts,writeFileSync as $e,mkdirSync as es}from"node:fs";import{basename as ns}from"node:path";var rs={JWT:/jwt|jsonwebtoken/i,OAuth2:/oauth|oauth2/i,PostgreSQL:/postgres|postgresql|psql/i,Redis:/redis/i,React:/react/i,FastAPI:/fastapi/i,SQLAlchemy:/sqlalchemy/i,Alembic:/alembic/i,"cursor-pagination":/cursor.based|keyset/i,"offset-pagination":/offset.pagination/i,WebSocket:/websocket/i,SSE:/sse|server.sent/i,GraphQL:/graphql/i,REST:/rest.api|restful/i},os={feature:/^feat:|^feature:/i,bugfix:/^fix:|^bugfix:/i,refactor:/^refactor:/i,optimization:/^perf:|^performance:/i,security:/^security:|^sec:/i,testing:/^test:|^tests:/i},ss={pagination:/cursor|pagination|offset|limit|page/i,caching:/cache|redis|memcache|ttl/i,authentication:/auth|jwt|oauth|token|login/i,validation:/validate|validation|schema|pydantic|zod/i,testing:/test|spec|coverage|mock/i,security:/security|encrypt|hash|secret|credential/i,performance:/performance|optimize|cache|index/i,error_handling:/error|exception|retry|fallback/i};function is(){let t=g();return ns(t)||"unknown"}function as(t){let e=t.toLowerCase(),n="unknown",r="general";for(let[o,s]of Object.entries(rs))if(s.test(e)){n=o;break}for(let[o,s]of Object.entries(os))if(s.test(t)){r=o;break}return{tech:n,pattern:r}}function cs(t){for(let[e,n]of Object.entries(ss))if(n.test(t))return e;return"general"}function X(t,e,n,r,o){let s=new Date().toISOString(),i=is();if(!Qo(o))try{es(v("path").dirname(o),{recursive:!0}),$e(o,JSON.stringify({patterns:[]}))}catch{return}try{let u=JSON.parse(ts(o,"utf8"));u.patterns.push({text:t,category:e,outcome:n,source:r,timestamp:s,project:i}),$e(o,JSON.stringify(u,null,2)),a("pattern-extractor",`Queued pattern: category=${e} outcome=${n} source=${r}`)}catch{}}function us(t,e,n){let r="",o=t.match(/-m\s+["']([^"']+)["']/)||t.match(/-m\s+([^\s]+)/);if(o&&(r=o[1]),!r)return;let{tech:s,pattern:i}=as(r),u=cs(r),c=e===0?"success":"failed",d=r;s!=="unknown"&&(d=`[${s}] ${r}`),X(d,u,c,"commit",n)}function ls(t,e,n){if(e!==0)return;let r="PR merged successfully",o=t.match(/gh\s+pr\s+merge\s+(\d+)/);o&&(r=`PR #${o[1]} merged`),X(r,"decision","success","pr-merge",n)}function ds(t,e,n){let r="unknown";/pytest|py\.test/.test(t)?r="pytest":/jest/.test(t)?r="jest":/vitest/.test(t)?r="vitest":/npm\s+test|yarn\s+test|bun\s+test/.test(t)?r="npm-test":/go\s+test/.test(t)&&(r="go-test");let o=e===0?"success":"failed",s=`Tests ${o==="success"?"passed":"failed"} (${r})`;X(s,"testing",o,"test-run",n)}function gs(t,e,n){let r="unknown";/npm\s+run\s+build/.test(t)?r="npm":/yarn\s+build/.test(t)?r="yarn":/cargo\s+build/.test(t)?r="cargo":/make/.test(t)?r="make":/docker\s+build/.test(t)&&(r="docker");let o=e===0?"success":"failed",s=`Build ${o==="success"?"succeeded":"failed"} (${r})`;X(s,"build",o,"build",n)}function V(t){if((t.tool_name||"")!=="Bash")return l();let n=p(t,"tool_input.command")||"",r=t.exit_code??0;if(!n)return l();let o=n.toLowerCase(),i=`${g()}/.claude/feedback/patterns-queue.json`;return/git\s+commit/.test(o)?us(n,r,i):/gh\s+pr\s+merge/.test(o)?ls(n,r,i):/pytest|jest|vitest|npm\s+test|yarn\s+test|bun\s+test|go\s+test/.test(o)?ds(n,r,i):/npm\s+run\s+build|yarn\s+build|cargo\s+build|make|docker\s+build/.test(o)&&gs(n,r,i),l()}import{existsSync as Re,readFileSync as Ae,writeFileSync as ps,mkdirSync as ms}from"node:fs";var fs=["py","ts","tsx","js","jsx","go","rs","java"];function ys(t){switch(t.split(".").pop()?.toLowerCase()){case"py":return"python";case"ts":case"tsx":return"typescript";case"js":case"jsx":return"javascript";case"go":return"go";case"rs":return"rust";case"java":return"java";default:return null}}function hs(t){let e=0,n=0,r=0;for(let o of t.split(`
`))o.startsWith("	")?e++:o.startsWith("    ")?r++:o.match(/^  [^ ]/)&&n++;return e>n+r?{style:"tabs",size:1}:n>r?{style:"spaces",size:2}:r>0?{style:"spaces",size:4}:{style:"unknown",size:4}}function _s(t){let e=(t.match(/'/g)||[]).length,n=(t.match(/"/g)||[]).length;return e>n?"single":"double"}function ks(t){let e=0,n=0;for(let r of t.split(`
`)){let o=r.trim();!o||o.startsWith("//")||o.startsWith("*")||(/;\s*$/.test(r)?e++:/[a-zA-Z0-9\)\]\'\"]\\s*$/.test(r)&&n++)}return e>n?"always":"omit"}function Ie(t){return(t.match(/,\s*$/gm)||[]).length>5?"always":"minimal"}function bs(t){let e=/\) -> |: [A-Z][a-zA-Z]+(\[|$| =)/.test(t),n="unknown";return/"""[^"]+"""/.test(t)&&(/:param |:returns:|:raises:/.test(t)?n="sphinx":/Args:|Returns:|Raises:/.test(t)?n="google":/Parameters|Returns\n-+/.test(t)?n="numpy":n="simple"),{typeHints:e,docstringStyle:n}}function Ss(t){if(Re(t))try{return JSON.parse(Ae(t,"utf8"))}catch{}return{version:"1.0.0",last_updated:null,samples_count:0,languages:{},global_preferences:{indentation:{style:"unknown",size:4,confidence:0},quotes:{style:"unknown",confidence:0}}}}function xs(t,e,n,r,o,s,i,u){t.last_updated=new Date().toISOString(),t.samples_count++,t.languages[e]||(t.languages[e]={samples:0,indentation:{tabs:0,spaces_2:0,spaces_4:0},quotes:{single:0,double:0},semicolons:{always:0,omit:0},trailing_comma:{always:0,minimal:0},type_hints:{used:0,not_used:0},docstring_style:{}});let c=t.languages[e];c.samples++,n.style==="tabs"?c.indentation.tabs++:n.size===2?c.indentation.spaces_2++:c.indentation.spaces_4++,r==="single"?c.quotes.single++:c.quotes.double++,o!=="unknown"&&(o==="always"?c.semicolons.always++:c.semicolons.omit++),s!=="unknown"&&(s==="always"?c.trailing_comma.always++:c.trailing_comma.minimal++),i!==null&&(i?c.type_hints.used++:c.type_hints.not_used++),u!=="unknown"&&(c.docstring_style[u]=(c.docstring_style[u]||0)+1)}function Y(t){let e=t.tool_name||"";if(e!=="Write"&&e!=="Edit")return l();let n=p(t,"tool_input.file_path")||"";if(!n||n.includes("/.claude/")||n.includes("/node_modules/")||n.includes("/.git/")||n.includes("/dist/")||n.endsWith(".lock"))return l();let r=n.split(".").pop()?.toLowerCase()||"";if(!fs.includes(r))return l();let o=ys(n);if(!o)return l();let s=p(t,"tool_input.content")||"";if(!s){let y=g(),k=n.startsWith("/")?n:`${y}/${n}`;if(Re(k))try{s=Ae(k,"utf8").split(`
`).slice(0,100).join(`
`)}catch{return l()}}if(!s)return l();let i=hs(s),u=_s(s),c="unknown",d="unknown",m=null,h="unknown";switch(o){case"javascript":case"typescript":c=ks(s),d=Ie(s);break;case"python":{let y=bs(s);m=y.typeHints,h=y.docstringStyle,d=Ie(s);break}}let _=g(),w=`${_}/.claude/feedback/code-style-profile.json`;try{ms(`${_}/.claude/feedback`,{recursive:!0});let y=Ss(w);xs(y,o,i,u,c,d,m,h),ps(w,JSON.stringify(y,null,2))}catch(y){a("code-style-learner",`Error updating profile: ${y}`)}return a("code-style-learner",`Analyzed ${o} file: indent=${i.style}(${i.size}) quotes=${u}`),l()}import{basename as vs}from"node:path";import{existsSync as Oe,readFileSync as De,writeFileSync as ws,mkdirSync as Cs}from"node:fs";var Es=["py","ts","tsx","js","jsx","go","rs","java"];function Ts(t){return t.length<2||/^[_0-9]+$/.test(t)?"unknown":/^[A-Z][A-Z0-9_]*$/.test(t)?"SCREAMING_SNAKE_CASE":/^[A-Z][a-zA-Z0-9]*$/.test(t)?"PascalCase":/^[a-z][a-zA-Z0-9]*$/.test(t)&&!t.includes("_")?"camelCase":/^[a-z][a-z0-9_]*$/.test(t)?"snake_case":/^_[a-z][a-z0-9_]*$/.test(t)?"private_snake_case":/^__[a-z][a-z0-9_]*__$/.test(t)?"dunder":"mixed"}function $s(t){let e=(t.match(/def ([a-zA-Z_][a-zA-Z0-9_]*)/g)||[]).map(s=>s.replace("def ","")),n=(t.match(/class ([A-Za-z_][a-zA-Z0-9_]*)/g)||[]).map(s=>s.replace("class ","")),r=(t.match(/^\s*([a-zA-Z_][a-zA-Z0-9_]*)\s*=/gm)||[]).map(s=>s.replace(/\s*=.*/,"").trim()),o=(t.match(/^([A-Z][A-Z0-9_]*)\s*=/gm)||[]).map(s=>s.replace(/\s*=.*/,"").trim());return{functions:e,classes:n,variables:r,constants:o}}function Is(t){let e=[...(t.match(/(function|async function) ([a-zA-Z_][a-zA-Z0-9_]*)/g)||[]).map(i=>i.replace(/(async )?function /,"")),...(t.match(/const ([a-zA-Z_][a-zA-Z0-9_]*)\s*=\s*\(/g)||[]).map(i=>i.replace(/const /,"").replace(/\s*=.*/,""))],n=(t.match(/class ([A-Za-z_][a-zA-Z0-9_]*)/g)||[]).map(i=>i.replace("class ","")),r=(t.match(/interface ([A-Za-z_][a-zA-Z0-9_]*)/g)||[]).map(i=>i.replace("interface ","")),o=(t.match(/type ([A-Za-z_][a-zA-Z0-9_]*)/g)||[]).map(i=>i.replace("type ","")),s=(t.match(/(const|let|var) ([a-zA-Z_][a-zA-Z0-9_]*)/g)||[]).map(i=>i.replace(/(const|let|var) /,""));return{functions:e,classes:n,variables:s,interfaces:r,types:o}}function x(t){let e={camelCase:0,snake_case:0,PascalCase:0,SCREAMING_SNAKE_CASE:0,private_snake_case:0,dunder:0,mixed:0,unknown:0};for(let n of t){if(!n)continue;let r=Ts(n);e[r]++}return e}function Rs(t){let n=vs(t).replace(/\.[^.]+$/,"");return/^[a-z][a-z0-9_]*$/.test(n)?"snake_case":/^[a-z][a-z0-9-]*$/.test(n)?"kebab-case":/^[A-Z][a-zA-Z0-9]*$/.test(n)?"PascalCase":/^[a-z][a-zA-Z0-9]*$/.test(n)?"camelCase":"mixed"}function As(t){switch(t.split(".").pop()?.toLowerCase()){case"py":return"python";case"ts":case"tsx":return"typescript";case"js":case"jsx":return"javascript";case"go":return"go";case"rs":return"rust";case"java":return"java";default:return null}}function Os(t){if(Oe(t))try{return JSON.parse(De(t,"utf8"))}catch{}return{version:"1.0.0",last_updated:null,samples_count:0,languages:{},file_naming:{},detected_patterns:{functions:{},classes:{},variables:{},constants:{},types:{}}}}function Ds(){return{samples:0,functions:{camelCase:0,snake_case:0,PascalCase:0,SCREAMING_SNAKE_CASE:0,private_snake_case:0,dunder:0,mixed:0,unknown:0},classes:{camelCase:0,snake_case:0,PascalCase:0,SCREAMING_SNAKE_CASE:0,private_snake_case:0,dunder:0,mixed:0,unknown:0},variables:{camelCase:0,snake_case:0,PascalCase:0,SCREAMING_SNAKE_CASE:0,private_snake_case:0,dunder:0,mixed:0,unknown:0},constants:{camelCase:0,snake_case:0,PascalCase:0,SCREAMING_SNAKE_CASE:0,private_snake_case:0,dunder:0,mixed:0,unknown:0},types:{camelCase:0,snake_case:0,PascalCase:0,SCREAMING_SNAKE_CASE:0,private_snake_case:0,dunder:0,mixed:0,unknown:0}}}function Q(t){let e=t.tool_name||"";if(e!=="Write"&&e!=="Edit")return l();let n=p(t,"tool_input.file_path")||"";if(!n||n.includes("/.claude/")||n.includes("/node_modules/")||n.includes("/.git/")||n.includes("/dist/")||n.endsWith(".lock"))return l();let r=n.split(".").pop()?.toLowerCase()||"";if(!Es.includes(r))return l();let o=As(n);if(!o)return l();let s=p(t,"tool_input.content")||"";if(!s){let y=g(),k=n.startsWith("/")?n:`${y}/${n}`;if(Oe(k))try{s=De(k,"utf8").split(`
`).slice(0,150).join(`
`)}catch{return l()}}if(!s)return l();let i=Rs(n),u=x([]),c=x([]),d=x([]),m=x([]),h=x([]);switch(o){case"python":{let y=$s(s);u=x(y.functions),c=x(y.classes),d=x(y.variables),m=x(y.constants);break}case"typescript":case"javascript":{let y=Is(s);u=x(y.functions),c=x(y.classes),d=x(y.variables),h=x([...y.interfaces,...y.types]);break}}let _=g(),w=`${_}/.claude/feedback/naming-conventions.json`;try{Cs(`${_}/.claude/feedback`,{recursive:!0});let y=Os(w);y.last_updated=new Date().toISOString(),y.samples_count++,y.file_naming[i]=(y.file_naming[i]||0)+1,y.languages[o]||(y.languages[o]=Ds());let k=y.languages[o];k.samples++;for(let b of Object.keys(u))k.functions[b]=(k.functions[b]||0)+u[b],k.classes[b]=(k.classes[b]||0)+c[b],k.variables[b]=(k.variables[b]||0)+d[b],k.constants[b]=(k.constants[b]||0)+m[b],k.types[b]=(k.types[b]||0)+h[b];ws(w,JSON.stringify(y,null,2))}catch(y){a("naming-convention-learner",`Error updating profile: ${y}`)}return a("naming-convention-learner",`Analyzed ${o} file (${n}): file=${i}`),l()}import{existsSync as Ps,readFileSync as Ns,writeFileSync as Pe,mkdirSync as Hs}from"node:fs";var js={"api-design-framework|fastapi-advanced":"Both relate to API design. Consider using api-design-framework for patterns, fastapi-advanced for implementation.","sqlalchemy-2-async|database-schema-designer":"Both relate to database. Use database-schema-designer for schema design, sqlalchemy-2-async for async patterns.","caching-strategies|performance-optimization":"Both optimize performance. Consider consolidating caching queries.","auth-patterns|owasp-top-10":"Both relate to security. auth-patterns for implementation, owasp-top-10 for validation.","asyncio-advanced|connection-pooling":"Both relate to async. asyncio-advanced for patterns, connection-pooling for specific optimization."};function Fs(t){if(!Ps(t))try{Hs(v("path").dirname(t),{recursive:!0}),Pe(t,JSON.stringify({version:"1.0",skills:{},sessions:{},last_updated:""}))}catch{}}function tt(t){Fs(t);try{return JSON.parse(Ns(t,"utf8"))}catch{return{version:"1.0",skills:{},sessions:{},last_updated:""}}}function Ms(t,e,n){let r=tt(n),o=new Date().toISOString();r.skills[t]=(r.skills[t]||0)+1,r.sessions[e]||(r.sessions[e]=[]),r.sessions[e].includes(t)||r.sessions[e].push(t),r.last_updated=o;try{Pe(n,JSON.stringify(r,null,2)),a("skill-usage-optimizer",`Updated usage for skill: ${t} (session: ${e})`)}catch{}}function Ls(t,e){return tt(e).sessions[t]||[]}function Bs(t,e){for(let[n,r]of Object.entries(js)){let[o,s]=n.split("|");if(t===o||t===s){let i=t===o?s:o;if(e.includes(i))return a("skill-usage-optimizer",`Overlap detected: ${o} + ${s}`),r}}return null}function Us(t){let e=tt(t),n=Object.entries(e.skills);return n.length===0?"":n.sort((r,o)=>o[1]-r[1]).slice(0,3).map(([r,o])=>`${r}:${o}`).join(", ")}function et(t){let e=t.tool_name||"",n=p(t,"tool_input.skill")||p(t,"tool_name")||"";if(e!=="Skill"&&!n?.startsWith("skills/")&&!n)return l();if(!n)return l();let o=`${g()}/.claude/feedback/skill-usage.json`,s=f();Ms(n,s,o);let i=Ls(s,o),u=Bs(n,i),c=Us(o),d="";u&&(d=`Skill overlap: ${u}`,a("skill-usage-optimizer",`Suggesting consolidation for: ${n}`));let h=tt(o).skills[n]||0;return h>0&&h%5===0&&c&&(d?d=`${d} | Top skills: ${c}`:d=`Top skills this project: ${c}`),d?(d.length>200&&(d=d.substring(0,197)+"..."),{continue:!0,hookSpecificOutput:{additionalContext:d}}):l()}import{existsSync as zs,readFileSync as Js,writeFileSync as Ne,mkdirSync as Ws}from"node:fs";import{execSync as C}from"node:child_process";function Gs(t){let e=t.match(/^(issue|fix|feature|bug|feat)\/(\d+)/);return e?e[2]:(e=t.match(/^(\d+)-/),e?e[1]:null)}function qs(t){let e=t.match(/#(\d+)/);return e?e[1]:(e=t.match(/(fix|fixes|close|closes|resolve|resolves)\s+#?(\d+)/i),e?e[2]:null)}function Zs(){try{return C("git branch --show-current 2>/dev/null || git rev-parse --abbrev-ref HEAD 2>/dev/null",{encoding:"utf8",timeout:5e3}).trim()}catch{return""}}function Ks(){try{let t=C("git rev-parse --short HEAD 2>/dev/null",{encoding:"utf8",timeout:5e3}).trim(),e=C("git log -1 --pretty=%s 2>/dev/null",{encoding:"utf8",timeout:5e3}).trim(),n=C("git log -1 --pretty=%cI 2>/dev/null",{encoding:"utf8",timeout:5e3}).trim()||new Date().toISOString();return{sha:t,message:e,timestamp:n}}catch{return null}}function Xs(t,e){if(!zs(t))try{Ws(v("path").dirname(t),{recursive:!0}),Ne(t,JSON.stringify({session_id:e,issues:{}}))}catch{}}function Vs(t,e,n,r,o){Xs(r,o);try{let s=JSON.parse(Js(r,"utf8"));return s.issues[t]||(s.issues[t]={commits:[],tasks_completed:[],pr_url:null,branch:n}),s.issues[t].commits.push(e),s.issues[t].branch=n,Ne(r,JSON.stringify(s,null,2)),a("issue-progress-commenter",`Queued commit for issue #${t}`),!0}catch{return a("issue-progress-commenter",`Error queuing commit for issue #${t}`),!1}}function nt(t){if((t.tool_name||"")!=="Bash")return l();let n=p(t,"tool_input.command")||"",r=t.exit_code??0;if(!/git\s+commit/i.test(n)||r!==0)return l();a("issue-progress-commenter","Processing git commit command...");try{C("which gh",{stdio:"ignore",timeout:2e3})}catch{return a("issue-progress-commenter","gh CLI not available, skipping issue progress tracking"),l()}try{if(!C("git remote get-url origin 2>/dev/null",{encoding:"utf8",timeout:5e3}).includes("github"))return a("issue-progress-commenter","Not a GitHub repository, skipping"),l()}catch{return l()}let o=Zs();if(!o)return a("issue-progress-commenter","Could not determine current branch"),l();let s=Gs(o);if(!s)try{let d=C("git log -1 --pretty=%s 2>/dev/null",{encoding:"utf8",timeout:5e3}).trim();s=qs(d)}catch{}if(!s)return a("issue-progress-commenter",`No issue number found in branch '${o}' or commit message`),l();a("issue-progress-commenter",`Found issue #${s}`);try{C(`gh issue view ${s} --json number`,{stdio:"ignore",timeout:5e3})}catch{return a("issue-progress-commenter",`Issue #${s} not found or not accessible`),l()}let i=Ks();if(!i)return a("issue-progress-commenter","Could not get commit info"),l();let u=(t.session_id||f()).replace(/[^a-zA-Z0-9_-]/g,""),c=`/tmp/claude-session-${u}/issue-progress.json`;return Vs(s,i,o,c,u),l()}import{existsSync as Ys,readFileSync as Qs,writeFileSync as ti}from"node:fs";import{execSync as E}from"node:child_process";function ei(t){let e=t.replace(/^[a-z]+(\([^)]*\))?:\s*/i,"");return e=e.replace(/\(#\d+\)/g,""),e.trim()}function He(t){return t.toLowerCase().replace(/\s+/g," ").trim()}function ni(t,e){let n=He(t),r=He(e);if(n===r||n.includes(r)||r.includes(n))return!0;let o=new Set(n.split(" ").filter(u=>u.length>=3)),s=r.split(" ").filter(u=>u.length>=3),i=0;for(let u of s)o.has(u)&&i++;return i>=2}function ri(t){let e=t.match(/^(issue|fix|feature|bug|feat)\/(\d+)/);return e?e[2]:(e=t.match(/^(\d+)-/),e?e[1]:null)}function oi(t){let e=t.match(/#(\d+)/);return e?e[1]:null}function si(t){try{let n=E(`gh issue view ${t} --json body -q '.body' 2>/dev/null`,{encoding:"utf8",timeout:1e4}).split(`
`),r=[];for(let o of n){let s=o.match(/^\s*-\s*\[\s*\]\s+(.+)/);s&&r.push(s[1].trim())}return r}catch{return[]}}function ii(t,e){a("issue-subtask-updater",`Attempting to update checkbox: '${e}' in issue #${t}`);try{let n=E(`gh issue view ${t} --json body -q '.body' 2>/dev/null`,{encoding:"utf8",timeout:1e4}),r=e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),o=n.replace(new RegExp(`(^\\s*-\\s*)\\[\\s*\\](\\s+${r})`,"m"),"$1[x]$2");if(n===o)return a("issue-subtask-updater",`No change needed for checkbox: '${e}'`),!1;let s=E("gh repo view --json nameWithOwner -q '.nameWithOwner' 2>/dev/null",{encoding:"utf8",timeout:5e3}).trim(),i=JSON.stringify(o);return E(`gh api -X PATCH "repos/${s}/issues/${t}" -f body=${i}`,{stdio:"ignore",timeout:1e4}),a("issue-subtask-updater",`Successfully updated checkbox: '${e}'`),!0}catch(n){return a("issue-subtask-updater",`Failed to update issue body: ${n}`),!1}}function ai(t,e,n){if(Ys(n))try{let r=JSON.parse(Qs(n,"utf8"));r.issues[t]||(r.issues[t]={commits:[],tasks_completed:[],pr_url:null}),r.issues[t].tasks_completed.includes(e)||(r.issues[t].tasks_completed.push(e),ti(n,JSON.stringify(r,null,2)))}catch{}}function rt(t){if((t.tool_name||"")!=="Bash")return l();let n=p(t,"tool_input.command")||"",r=t.exit_code??0;if(!/git\s+commit/i.test(n)||r!==0)return l();a("issue-subtask-updater","Processing git commit for subtask updates...");try{E("which gh",{stdio:"ignore",timeout:2e3})}catch{return a("issue-subtask-updater","gh CLI not available, skipping subtask updates"),l()}try{if(!E("git remote get-url origin 2>/dev/null",{encoding:"utf8",timeout:5e3}).includes("github"))return a("issue-subtask-updater","Not a GitHub repository, skipping"),l()}catch{return l()}let o="",s="";try{o=E("git branch --show-current 2>/dev/null",{encoding:"utf8",timeout:5e3}).trim(),s=E("git log -1 --pretty=%s 2>/dev/null",{encoding:"utf8",timeout:5e3}).trim()}catch{return l()}let i=ri(o);if(i||(i=oi(s)),!i)return a("issue-subtask-updater","No issue number found"),l();a("issue-subtask-updater",`Found issue #${i}, checking for matching subtasks...`);let u=ei(s);if(!u)return a("issue-subtask-updater","Could not extract task from commit message"),l();a("issue-subtask-updater",`Commit task: '${u}'`);let c=si(i);if(c.length===0)return a("issue-subtask-updater",`No unchecked tasks in issue #${i}`),l();let d=!1,h=`/tmp/claude-session-${(t.session_id||f()).replace(/[^a-zA-Z0-9_-]/g,"")}/issue-progress.json`;for(let _ of c)ni(u,_)&&(a("issue-subtask-updater",`Found matching checkbox: '${_}'`),ii(i,_)&&(ai(i,_,h),d=!0));return d?{continue:!0,suppressOutput:!0,hookSpecificOutput:{hookEventName:"PostToolUse",additionalContext:`Issue #${i}: Automatically marked sub-task as complete based on commit.`}}:(a("issue-subtask-updater",`No matching checkboxes found for task: '${u}'`),l())}import{existsSync as bt,readFileSync as je,writeFileSync as Fe,mkdirSync as ci}from"node:fs";import{join as Me,dirname as ui,basename as Le}from"node:path";var St=[/\b(all )?tests?\s*(passed|passing|pass)\b/i,/\b(test|tests)\s*(suite)?\s*(passed|successful|succeeded)\b/i,/\b\d+\s*passed?,?\s*0\s*failed\b/i,/\bOK\s*\(\d+\s*tests?\)/i,/\bbuild\s*(succeeded|successful|complete(d)?)\b/i,/\bcompiled?\s*successfully\b/i,/\bbundle\s*(created|generated)\b/i,/\bfixed\b/i,/\bresolved\b/i,/\bsolved\b/i,/\bnow works\b/i,/\bworking\s*(now|correctly|properly)\b/i,/\bno\s*(more\s*)?(errors?|issues?|problems?)\b/i,/\bsuccess(ful(ly)?)?\b/i,/\bready\s*(for|to)\b/i,/\bcomplete(d)?\b/i],Be=[/\b(tests?\s*)?(failed|failing|failure)\b/i,/\berror(s)?\b/i,/\bexception\b/i,/\bcrash(ed|ing)?\b/i,/\btimeout\b/i,/\bnot\s*(found|working|defined)\b/i,/\bundefined\b/i,/\bsyntax\s*error\b/i,/\btype\s*error\b/i,/\bcannot\s*(find|read|import)\b/i];function Ue(){return Me(g(),".claude","memory","open-problems.jsonl")}function li(){return Me(g(),".claude","memory","problem-solutions.jsonl")}function di(t){let e=Ue();if(!bt(e))return[];try{let r=je(e,"utf-8").trim().split(`
`).filter(Boolean),o=[];for(let s of r)try{let i=JSON.parse(s);i.status==="open"&&(!t||i.session_id===t)&&o.push(i)}catch{}return o.slice(-50).reverse()}catch(n){return a("problem-tracker",`Failed to load open problems: ${n}`,"warn"),[]}}function gi(t,e,n){let r=Ue();if(!bt(r))return!1;try{let s=je(r,"utf-8").trim().split(`
`).filter(Boolean),i=!1,u=s.map(c=>{try{let d=JSON.parse(c);return d.id===t?(d.status=e,n&&(d.solution=n),i=!0,JSON.stringify(d)):c}catch{return c}});return i&&Fe(r,u.join(`
`)+`
`),i}catch(o){return a("problem-tracker",`Failed to update problem ${t}: ${o}`,"warn"),!1}}function pi(t){let e=li();try{let n=ui(e);bt(n)||ci(n,{recursive:!0});let r=JSON.stringify(t)+`
`;return Fe(e,r,{flag:"a"}),a("problem-tracker",`Stored problem-solution pair: ${t.problem_id} \u2192 ${t.tool}`,"info"),!0}catch(n){return a("problem-tracker",`Failed to store pair: ${n}`,"warn"),!1}}function xt(t){return St.some(e=>e.test(t))}function mi(t){return Be.some(e=>e.test(t))}function fi(t,e,n,r){let o=.3;r===0?o+=.2:r!==void 0&&r!==0&&(o-=.3);let s=St.filter(d=>d.test(e)).length;o+=Math.min(.3,s*.1);let i=Be.filter(d=>d.test(e)).length;o-=Math.min(.4,i*.15);let u=e.toLowerCase(),c=t.entities.filter(d=>u.includes(d.toLowerCase()));return o+=Math.min(.15,c.length*.05),n==="Bash"?/test|pytest|jest|vitest/i.test(e)&&(o+=.1):(n==="Write"||n==="Edit")&&(o+=.05),Math.max(0,Math.min(1,o))}function yi(t,e,n){let r=t.split(`
`).filter(o=>o.trim());for(let o of St){let s=t.match(o);if(s){let i=hi(t,s.index||0);if(i)return i.slice(0,200)}}for(let o of r.slice(0,5)){let s=o.trim();if(s.length>10&&s.length<200)return s}return n?`${e} operation on ${Le(n)} completed`:`${e} completed successfully`}function hi(t,e,n=100){let r=Math.max(0,e-20),o=Math.min(t.length,e+n),s=t.slice(r,o).trim();s=s.replace(/\s+/g," ");let i=s.search(/[.!?]\s/);return i>20&&(s=s.slice(0,i+1)),s}function ze(t,e,n,r,o){if(mi(t)&&!xt(t))return 0;let s=di(o);if(s.length===0)return 0;let i=Le(g())||"unknown",u=new Date().toISOString(),c=0;for(let d of s){let m=fi(d,t,e,r);if(m>=.6){let h={text:yi(t,e,n),tool:e,file:n,timestamp:u,confidence:m,exit_code:r};if(gi(d.id,"solved",h)){let w={problem_id:d.id,problem_text:d.text,solution_text:h.text,tool:e,file:n,entities:d.entities,confidence:m,paired_at:u,session_id:o,project:i};pi(w)&&(c++,ce(h.text,d.id,m))}}}return c}var Je="solution-detector",_i=20,ki=["Bash","Write","Edit","Task"];function ot(t){let e=t.tool_name||"";if(!ki.includes(e))return l();let n=bi(t);if(!n||n.length<_i)return l();if(!xt(n))return l();let r=t.session_id||f(),o=t.exit_code,s=p(t,"tool_input.file_path");try{let i=ze(n,e,s,o,r);i>0&&a(Je,`Paired ${i} problem(s) with solution from ${e}`,"info")}catch(i){a(Je,`Error pairing solutions: ${i}`,"warn")}return l()}function bi(t){let e=t.tool_result;if(typeof e=="string")return e;if(e&&typeof e=="object"){let o=e.content;if(typeof o=="string")return o}let n=t.tool_output;if(typeof n=="string")return n;if(n&&typeof n=="object"){let o=n.content;if(typeof o=="string")return o}let r=t.output;return typeof r=="string"?r:""}import{existsSync as Ge,readFileSync as Si,writeFileSync as xi,mkdirSync as vi}from"node:fs";import{join as wi,dirname as Ci}from"node:path";var qe="tool-preference-learner",Ei={Glob:["file_search"],"Bash:find":["file_search"],"Bash:ls":["file_search"],Grep:["content_search"],"Bash:grep":["content_search"],"Bash:rg":["content_search"],"Bash:ag":["content_search"],Read:["code_reading"],"Bash:cat":["code_reading"],"Bash:head":["code_reading"],"Bash:tail":["code_reading"],Write:["code_writing"],Edit:["code_writing"],MultiEdit:["code_writing"],NotebookEdit:["code_writing"],"Bash:test":["testing"],"Bash:pytest":["testing"],"Bash:jest":["testing"],"Bash:vitest":["testing"],"Bash:npm_test":["testing"],"Bash:build":["building"],"Bash:npm_run_build":["building"],"Bash:make":["building"],"Bash:cargo_build":["building"],"Bash:tsc":["building"],"Bash:git":["git_operations"],"Bash:gh":["git_operations"],"Skill:commit":["git_operations"],"Skill:create-pr":["git_operations"],Task:["agent_spawn"]},Ti=[[/\bfind\s+/,"Bash:find"],[/\bls\s+/,"Bash:ls"],[/\bgrep\s+/,"Bash:grep"],[/\brg\s+/,"Bash:rg"],[/\bag\s+/,"Bash:ag"],[/\bcat\s+/,"Bash:cat"],[/\bhead\s+/,"Bash:head"],[/\btail\s+/,"Bash:tail"],[/\bpytest\b/,"Bash:pytest"],[/\bjest\b/,"Bash:jest"],[/\bvitest\b/,"Bash:vitest"],[/\bnpm\s+test\b/,"Bash:npm_test"],[/\bnpm\s+run\s+build\b/,"Bash:npm_run_build"],[/\bmake\b/,"Bash:make"],[/\bcargo\s+build\b/,"Bash:cargo_build"],[/\btsc\b/,"Bash:tsc"],[/\bgit\s+/,"Bash:git"],[/\bgh\s+/,"Bash:gh"]];function $i(t){for(let[e,n]of Ti)if(e.test(t))return n;return"Bash:other"}function Ii(t,e,n){return t==="Bash"&&e?$i(e):t==="Skill"&&n?`Skill:${n}`:t}function Ri(t){return Ei[t]||["other"]}function Ze(){return wi(g(),".claude","memory","tool-preferences.json")}function Ai(){let t=Ze();if(!Ge(t))return We();try{let e=Si(t,"utf-8");return JSON.parse(e)}catch{return We()}}function Oi(t){let e=Ze();try{let n=Ci(e);return Ge(n)||vi(n,{recursive:!0}),xi(e,JSON.stringify(t,null,2)),!0}catch(n){return a(qe,`Failed to save preferences: ${n}`,"warn"),!1}}function We(){let t=["file_search","content_search","code_reading","code_writing","testing","building","git_operations","agent_spawn","other"],e={},n={};for(let r of t)e[r]={},n[r]=null;return{usage:e,preferences:n,updated_at:new Date().toISOString()}}function Di(t,e){let n=Object.entries(e);if(n.length===0)return null;n.sort((d,m)=>m[1]-d[1]);let[r,o]=n[0],s=n.reduce((d,[,m])=>d+m,0),i=Math.min(1,o/10),u=o/s,c=i*.4+u*.6;return c<.3||o<2?null:{category:t,preferred_tool:r,confidence:c,sample_count:o,updated_at:new Date().toISOString()}}function Pi(t){let e=Object.keys(t.usage);for(let n of e)t.preferences[n]=Di(n,t.usage[n]);t.updated_at=new Date().toISOString()}function st(t){let e=t.tool_name||"";if(!e)return l();let n=p(t,"tool_input.command"),r=p(t,"tool_input.skill"),o=Ii(e,n,r),i=Ri(o).filter(c=>c!=="other");if(i.length===0)return l();let u=Ai();for(let c of i)u.usage[c]||(u.usage[c]={}),u.usage[c][o]=(u.usage[c][o]||0)+1;Pi(u),Oi(u);for(let c of i){let d=u.preferences[c];d&&d.confidence>.7&&d.sample_count===10&&a(qe,`Strong preference detected: ${c} \u2192 ${d.preferred_tool} (${(d.confidence*100).toFixed(0)}%)`,"info")}return l()}var Ni=[{name:"session-metrics",fn:W,matcher:"*"},{name:"audit-logger",fn:P,matcher:"*"},{name:"calibration-tracker",fn:q,matcher:"*"},{name:"pattern-extractor",fn:V,matcher:"Bash"},{name:"issue-progress-commenter",fn:nt,matcher:"Bash"},{name:"issue-subtask-updater",fn:rt,matcher:"Bash"},{name:"mem0-webhook-handler",fn:F,matcher:"Bash"},{name:"code-style-learner",fn:Y,matcher:["Write","Edit"]},{name:"naming-convention-learner",fn:Q,matcher:["Write","Edit"]},{name:"skill-edit-tracker",fn:G,matcher:["Write","Edit"]},{name:"skill-usage-optimizer",fn:et,matcher:"Skill"},{name:"memory-bridge",fn:M,matcher:["mcp__memory__create_entities"]},{name:"realtime-sync",fn:L,matcher:["Bash","Write","Edit","Skill","Task"]},{name:"user-tracking",fn:z,matcher:"*"},{name:"solution-detector",fn:ot,matcher:["Bash","Write","Edit","Task"]},{name:"tool-preference-learner",fn:st,matcher:"*"}];function Hi(t,e){return e==="*"?!0:Array.isArray(e)?e.includes(t):t===e}async function Ke(t){let e=t.tool_name||"";if(e==="Skill"){let s=t.tool_input?.skill||"";s&&K("skill-usage.jsonl",{ts:new Date().toISOString(),pid:Z(process.env.CLAUDE_PROJECT_DIR||""),skill:s,...Te()})}let n=Ni.filter(s=>Hi(e,s.matcher));if(n.length===0)return l();let r=await Promise.allSettled(n.map(async s=>{try{let i=s.fn(t);return i instanceof Promise&&await i,{hook:s.name,status:"success"}}catch(i){let u=i instanceof Error?i.message:String(i);return a("unified-dispatcher",`${s.name} failed: ${u}`),{hook:s.name,status:"error",message:u}}})),o=[];for(let s of r)s.status==="rejected"?o.push("unknown"):s.value.status==="error"&&o.push(s.value.hook);return o.length>0&&a("posttool-dispatcher",`${o.length}/${n.length} hooks failed: ${o.join(", ")}`),l()}import{appendFileSync as Xe,mkdirSync as ji}from"node:fs";import{execSync as Fi}from"node:child_process";import{basename as Mi}from"node:path";function Ve(t){if((t.tool_name||"")!=="Write")return l();let n=p(t,"tool_input.file_path")||process.env.TOOL_OUTPUT_FILE_PATH||"";if(!n)return l();if(n.includes("test")||n.includes("spec")||n.includes("__tests__"))return l();if(!/\.(py|ts|tsx|js|jsx)$/.test(n))return l();let r=g(),o="",s=Mi(n);if(n.endsWith(".py"))o=`test_${s.replace(".py","")}.py`;else if(/\.(ts|tsx|js|jsx)$/.test(n))o=`${s.replace(/\.[^.]+$/,"")}.test.*`;else return l();let i="";try{i=Fi(`find "${r}" -type f -name "${o}" 2>/dev/null | head -1`,{encoding:"utf8",timeout:5e3}).trim()}catch{}let u=`${r}/.claude/hooks/logs`;try{ji(u,{recursive:!0});let c=new Date().toISOString();if(i)Xe(`${u}/coverage-predictor.log`,`[${c}] COVERAGE_OK: ${n} has tests at ${i}
`);else return Xe(`${u}/coverage-predictor.log`,`[${c}] COVERAGE_WARN: ${n} may lack test coverage (expected: ${o})
`),{continue:!0,systemMessage:`Consider adding tests for: ${n}`}}catch{}return l()}import{existsSync as vt,statSync as Li,appendFileSync as Bi,mkdirSync as Ui}from"node:fs";import{basename as Ye,dirname as zi}from"node:path";function Ji(t,e){let n=Ye(t),r=zi(t),o=(t.split(".").pop()||"").toLowerCase();switch(n){case"package.json":if(vt(`${e}/${t}`))try{let s=v(`${e}/${t}`);if(Object.keys(s.scripts||{}).length>5)return{changeType:"scripts",readmeSection:"Available Scripts",suggestion:"Update README with new npm scripts"}}catch{}break;case"pyproject.toml":case"setup.py":case"setup.cfg":return{changeType:"python-config",readmeSection:"Installation",suggestion:"Verify README installation instructions match project config"};case"Dockerfile":case"docker-compose.yml":case"docker-compose.yaml":return{changeType:"docker",readmeSection:"Docker / Deployment",suggestion:"Update README Docker instructions"};case".env.example":case".env.template":return{changeType:"env",readmeSection:"Environment Variables",suggestion:"Update README environment variable documentation"}}if(t.includes("/api/")||t.includes("/routes/")||t.includes("/endpoints/"))return{changeType:"api",readmeSection:"API Endpoints",suggestion:"Update README API documentation or OpenAPI spec"};if(r.includes("/config")||r.includes("/settings"))return{changeType:"config",readmeSection:"Configuration",suggestion:"Document new configuration options in README"};if(["index.ts","index.js","main.py","app.py","__init__.py"].includes(n)&&t.split(/[/\\]/).length<=4)return{changeType:"entry-point",readmeSection:"Getting Started",suggestion:"Review README getting started section for accuracy"};if((t.includes("/bin/")||t.includes("/cli/")||t.includes("/scripts/"))&&["sh","py","ts"].includes(o))return{changeType:"cli",readmeSection:"CLI / Commands",suggestion:"Update README CLI usage documentation"};if(n==="index.ts"||n==="index.js"){let s=`${e}/${t}`;if(vt(s))try{let{readFileSync:i}=v("fs");if((i(s,"utf8").match(/^export/gm)||[]).length>5)return{changeType:"exports",readmeSection:"API Reference",suggestion:"Consider updating API reference with new exports"}}catch{}}return null}function Wi(t){for(let e of["README.md","Readme.md","readme.md","README.rst","README"])if(vt(`${t}/${e}`))return`${t}/${e}`;return null}function Qe(t){if((t.tool_name||"")!=="Write")return l();let n=p(t,"tool_input.file_path")||"";if(!n)return l();if(n.includes("/.claude/")||n.includes("/node_modules/")||n.includes("/.git/")||n.includes("/dist/")||n.endsWith(".lock")||n.endsWith(".log"))return l();if(n.includes("test")||n.includes("spec")||n.includes("__tests__"))return l();let r=g(),o=Ji(n,r);if(!o)return l();let s=Wi(r),i;if(s){let c=0;try{let h=Li(s).mtime.getTime(),_=Date.now();c=Math.floor((_-h)/(86400*1e3))}catch{}let d=o.suggestion;c>30&&(d=`${d} (README last updated ${c}+ days ago)`),i=`README sync: ${o.changeType} change in ${Ye(n)}. Section: '${o.readmeSection}'. ${d}`}else i=`README sync: ${o.changeType} change detected but no README.md found. Consider creating one.`;i.length>200&&(i=`README sync: ${o.changeType} change detected. Consider updating '${o.readmeSection}' section.`);let u=`${r}/.claude/hooks/logs`;try{Ui(u,{recursive:!0});let c=new Date().toISOString();Bi(`${u}/readme-sync.log`,`[${c}] README_SYNC: ${o.changeType} change in ${n} -> ${o.readmeSection}
`)}catch{}return a("readme-sync",`README_SYNC: ${o.changeType} change suggests README update`),{continue:!0,hookSpecificOutput:{additionalContext:i}}}import{writeFileSync as Gi,mkdirSync as qi,existsSync as Zi}from"node:fs";import{join as tn}from"node:path";function en(t,e){let n=g();if(!n)return;let r=tn(n,".claude","logs");Zi(r)||qi(r,{recursive:!0});try{let o=tn(r,t);Gi(o,JSON.stringify(e)+`
`,{flag:"a"})}catch{}}function nn(t){let e=t.tool_input||{},n=e.team_name;if(!n)return l();let r=e.name||"unnamed-teammate",o=e.subagent_type||"unknown",s=e.model||"default",i=e.description||"";return a("team-member-start",`Team "${n}": member "${r}" (${o}) started`),en("teammate-activity.jsonl",{timestamp:new Date().toISOString(),event:"team_member_start",team_name:n,member_name:r,subagent_type:o,model:s,description:i,session_id:t.session_id}),K("team-activity.jsonl",{ts:new Date().toISOString(),pid:Z(process.env.CLAUDE_PROJECT_DIR||""),event:"spawn",agent:o,member:r,model:s,team:n}),D(`Team "${n}": teammate "${r}" (${o}, model=${s}) spawned.`)}var Ki=[{pattern:/ENOENT|no such file|not found/i,suggestion:"File not found. Check the path exists. Use Glob to search for the correct filename."},{pattern:/EACCES|permission denied/i,suggestion:"Permission denied. The file may be read-only or owned by another user."},{pattern:/ECONNREFUSED|ETIMEDOUT|network/i,suggestion:"Network error. Check if the service is running and accessible."},{pattern:/syntax error|SyntaxError|parse error/i,suggestion:"Syntax error in the code. Review the file for missing brackets, quotes, or semicolons."},{pattern:/command not found|not recognized/i,suggestion:"Command not found. Check if the tool is installed and in PATH."},{pattern:/timeout|timed out/i,suggestion:"Command timed out. Consider increasing the timeout or breaking the command into smaller steps."},{pattern:/ENOMEM|out of memory|heap/i,suggestion:"Out of memory. Try processing smaller chunks or increasing available memory."},{pattern:/merge conflict|CONFLICT/i,suggestion:"Merge conflict detected. Resolve conflicts manually before continuing."},{pattern:/lock|locked|ELOCK/i,suggestion:"Resource is locked. Wait for the lock to be released or check for stale locks."},{pattern:/type error|TypeError|cannot read prop/i,suggestion:"Type error. Check for null/undefined values and ensure correct types are passed."}];function rn(t){let e=t.tool_error||"",n=t.tool_name||"unknown",r=t.exit_code;if(!e&&r===0)return l();a("failure-handler",`Tool ${n} failed: ${e.slice(0,200)}`);let o=[];for(let{pattern:i,suggestion:u}of Ki)i.test(e)&&o.push(u);if(o.length===0)return l();let s=[`[OrchestKit] Tool failure analysis for ${n}:`,...o.map(i=>`- ${i}`)].join(`
`);return D(s)}var on={"posttool/audit-logger":P,"posttool/unified-error-handler":Lt,"posttool/auto-lint":Bt,"posttool/context-budget-monitor":Wt,"posttool/mem0-webhook-handler":F,"posttool/memory-bridge":M,"posttool/realtime-sync":L,"posttool/user-tracking":z,"posttool/session-metrics":W,"posttool/skill-edit-tracker":G,"posttool/calibration-tracker":q,"posttool/unified-dispatcher":Ke,"posttool/write/code-style-learner":Y,"posttool/write/coverage-predictor":Ve,"posttool/write/naming-convention-learner":Q,"posttool/write/readme-sync":Qe,"posttool/bash/issue-progress-commenter":nt,"posttool/bash/issue-subtask-updater":rt,"posttool/bash/pattern-extractor":V,"posttool/skill/skill-usage-optimizer":et,"posttool/task/team-member-start":nn,"posttool/failure-handler":rn,"posttool/solution-detector":ot,"posttool/tool-preference-learner":st};function Ql(t){return on[t]}function td(){return Object.keys(on)}export{Ra as escapeRegex,dt as estimateTokenCount,jn as extractIssueNumber,ya as getCachedBranch,Pn as getCurrentBranch,ja as getDefaultBranch,fa as getEnvFile,p as getField,Hn as getGitStatus,Ql as getHook,At as getLogDir,In as getLogLevel,lt as getPluginRoot,g as getProjectDir,Pa as getRepoRoot,f as getSessionId,Ha as hasUncommittedChanges,on as hooks,Vi as isBashInput,Qi as isEditInput,Na as isGitRepo,Nn as isProtectedBranch,ta as isReadInput,Yi as isWriteInput,td as listHooks,a as logHook,Ea as logPermissionFeedback,Ia as normalizeCommand,ha as normalizeLineEndings,Sa as outputAllowWithContext,ka as outputBlock,wa as outputDeny,xa as outputError,An as outputPromptContext,Ta as outputPromptContextBudgeted,_a as outputSilentAllow,l as outputSilentSuccess,va as outputWarning,D as outputWithContext,ba as outputWithNotification,Ca as outputWithUpdatedInput,$a as readHookInput,Rn as shouldLog,Fa as validateBranchName};
//# sourceMappingURL=posttool.mjs.map
