// Generated by OrchestKit Claude Plugin
// Created: 2026-02-18

/**
 * Global test setup for vitest
 *
 * Auto-mocks analytics-buffer so that bufferWrite delegates to appendFileSync.
 * This lets existing tests that mock node:fs continue to assert on appendFileSync
 * while the source code uses the buffered API.
 */

import { vi } from 'vitest';

vi.mock('./src/lib/analytics-buffer.js', async () => {
  const fs = await import('node:fs');
  return {
    bufferWrite: (filePath: string, content: string) => {
      fs.appendFileSync(filePath, content);
    },
    flush: vi.fn(),
    pendingCount: vi.fn(() => 0),
    _resetForTesting: vi.fn(),
  };
});
