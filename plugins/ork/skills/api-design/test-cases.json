{
  "skill": "api-design",
  "version": "2.0.0",
  "testCases": [
    {
      "id": "framework-rest-conventions",
      "rule": "framework-rest-conventions",
      "query": "Design RESTful API endpoints for a user management service",
      "expectedBehavior": [
        "Uses plural nouns for resources (/users, /orders)",
        "Maps CRUD operations to correct HTTP methods (GET, POST, PUT, DELETE)",
        "Returns appropriate status codes (200, 201, 204, 404, 422)",
        "Implements cursor-based pagination for list endpoints"
      ]
    },
    {
      "id": "framework-resource-modeling",
      "rule": "framework-resource-modeling",
      "query": "Structure API endpoints for nested resources with filtering",
      "expectedBehavior": [
        "Uses hierarchical URLs for relationships (/users/123/orders)",
        "Implements query parameter filtering (?status=active)",
        "Supports sort parameter (?sort=-created_at)",
        "Provides field selection for partial responses (?fields=id,name)"
      ]
    },
    {
      "id": "framework-openapi",
      "rule": "framework-openapi",
      "query": "Create OpenAPI specification for my API",
      "expectedBehavior": [
        "Uses OpenAPI 3.1 format with proper info section",
        "Defines reusable schemas in components section",
        "Documents all response codes including error responses",
        "Includes rate limit headers and authentication schemes"
      ]
    },
    {
      "id": "versioning-url-path",
      "rule": "versioning-url-path",
      "query": "Implement URL path versioning for a FastAPI application",
      "expectedBehavior": [
        "Creates versioned directory structure (api/v1/, api/v2/)",
        "Mounts version-specific routers with prefix (/api/v1, /api/v2)",
        "Uses version-specific schemas while sharing service layer",
        "Keeps business logic version-agnostic in services"
      ]
    },
    {
      "id": "versioning-header",
      "rule": "versioning-header",
      "query": "Implement header-based API versioning",
      "expectedBehavior": [
        "Extracts version from X-API-Version header",
        "Validates version against supported versions set",
        "Defaults to latest stable version when header absent",
        "Shows content negotiation alternative with Accept header"
      ]
    },
    {
      "id": "versioning-deprecation",
      "rule": "versioning-deprecation",
      "query": "Deprecate API v1 and sunset it in 6 months",
      "expectedBehavior": [
        "Adds Deprecation and Sunset headers to v1 responses",
        "Includes Link header pointing to successor version",
        "Distinguishes breaking vs non-breaking changes clearly",
        "Shows version lifecycle: alpha -> beta -> stable -> deprecated -> sunset"
      ]
    },
    {
      "id": "errors-problem-details",
      "rule": "errors-problem-details",
      "query": "Implement RFC 9457 Problem Details for API errors",
      "expectedBehavior": [
        "Creates ProblemException base class with type, title, status, detail, instance",
        "Returns application/problem+json media type",
        "Supports extension members for additional context",
        "Registers FastAPI exception handler for ProblemException"
      ]
    },
    {
      "id": "errors-validation",
      "rule": "errors-validation",
      "query": "Handle validation errors with field-level details",
      "expectedBehavior": [
        "Returns 422 with field-level error array",
        "Maps Pydantic RequestValidationError to Problem Details format",
        "Includes field path, error code, and human-readable message",
        "Uses consistent error structure across all validation failures"
      ]
    },
    {
      "id": "errors-error-catalog",
      "rule": "errors-error-catalog",
      "query": "Create a centralized error type registry for my API",
      "expectedBehavior": [
        "Defines problem type URIs for each error category",
        "Maps standard HTTP status codes to problem types",
        "Shows Python and TypeScript client handling examples",
        "Includes specific exception subclasses for each problem type"
      ]
    }
  ]
}
