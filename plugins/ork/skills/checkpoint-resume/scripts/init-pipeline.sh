#!/usr/bin/env bash
# Generated by OrchestKit Claude Plugin
# Created: 2026-02-19

# init-pipeline.sh â€” Initialize a fresh pipeline-state.json
# Usage: scripts/init-pipeline.sh [branch]
# Output: prints JSON to stdout; redirect to .claude/pipeline-state.json

set -euo pipefail

if [[ "${1:-}" == "--help" ]]; then
  echo "Usage: scripts/init-pipeline.sh [branch]"
  echo "Prints a skeleton pipeline-state.json to stdout."
  echo "Redirect to .claude/pipeline-state.json to initialize."
  exit 0
fi

BRANCH="${1:-$(git branch --show-current 2>/dev/null || echo "unknown")}"
NOW=$(date -u +"%Y-%m-%dT%H:%M:%SZ")

cat <<EOF
{
  "completed_phases": [],
  "current_phase": {
    "id": "",
    "name": "",
    "progress_description": ""
  },
  "remaining_phases": [],
  "context_summary": {
    "branch": "${BRANCH}",
    "key_decisions": [],
    "file_paths": []
  },
  "created_at": "${NOW}",
  "updated_at": "${NOW}"
}
EOF
