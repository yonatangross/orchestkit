// OrchestKit Hooks - notification bundle
// Generated: 2026-02-18T09:18:41.282Z

function Pt(t){return typeof t.command=="string"}function Ct(t){return typeof t.file_path=="string"&&typeof t.content=="string"}function $t(t){return typeof t.file_path=="string"&&typeof t.old_string=="string"&&typeof t.new_string=="string"}function Nt(t){return typeof t.file_path=="string"&&t.content===void 0}import{existsSync as v,statSync as pt,renameSync as at,mkdirSync as gt,readSync as ft}from"node:fs";import{appendFileSync as B,mkdirSync as j}from"node:fs";import{dirname as M}from"node:path";var p=[],d=!1,R=!1;function h(t,n){p.push({filePath:t,content:n}),G()}function m(){if(d||p.length===0)return;d=!0;let t=new Map;for(let n of p){let o=t.get(n.filePath);o?o.push(n.content):t.set(n.filePath,[n.content])}for(let[n,o]of t)try{j(M(n),{recursive:!0}),B(n,o.join(""))}catch{}p.length=0,d=!1}function G(){R||(R=!0,process.on("exit",m),process.on("SIGTERM",()=>{m(),process.exit(0)}),process.on("SIGINT",()=>{m(),process.exit(0)}))}import{execSync as lt}from"node:child_process";import W from"node:os";import a from"node:path";function J(){return process.env.HOME||process.env.USERPROFILE||W.homedir()}function S(){return process.env.CLAUDE_PROJECT_DIR||"."}function H(){return process.env.CLAUDE_PLUGIN_ROOT||process.env.CLAUDE_PROJECT_DIR||"."}function E(){return process.env.CLAUDE_PLUGIN_ROOT?a.join(J(),".claude","logs","ork"):a.join(S(),".claude","logs")}var jt=a.join,Mt=a.sep;import{execSync as K}from"node:child_process";import{createHash as z}from"node:crypto";import{existsSync as T,readFileSync as Z,writeFileSync as X,mkdirSync as q}from"node:fs";import{join as k,basename as V}from"node:path";var Q=20,Y=15,tt=/[^a-z0-9-]/g;function nt(t){let n=t||process.env.CLAUDE_PROJECT_DIR||process.cwd(),o=V(n);return b(o,Q)}function et(t){if(process.env.ORCHESTKIT_SESSION_BRANCH)return process.env.ORCHESTKIT_SESSION_BRANCH;let n=t||process.env.CLAUDE_PROJECT_DIR||process.cwd();try{let o=K("git branch --show-current",{cwd:n,encoding:"utf8",timeout:2e3,stdio:["pipe","pipe","pipe"]}).trim(),e=b(o||"detached",Y);return process.env.ORCHESTKIT_SESSION_BRANCH=e,e}catch{return"nobranch"}}function ot(t){let n=t||new Date,o=String(n.getMonth()+1).padStart(2,"0"),e=String(n.getDate()).padStart(2,"0");return`${o}${e}`}function rt(t){let n=t||new Date,o=String(n.getHours()).padStart(2,"0"),e=String(n.getMinutes()).padStart(2,"0");return`${o}${e}`}function it(){let t=`${process.pid}-${Date.now()}-${Math.random()}`;return z("sha256").update(t).digest("hex").slice(0,4)}function b(t,n){return t.toLowerCase().replace(tt,"-").replace(/-+/g,"-").replace(/^-|-$/g,"").slice(0,n)}function st(t,n){let o=nt(t),e=et(t),r=ot(n),i=rt(n),s=it();return`${o}-${e}-${r}-${i}-${s}`}function ut(t){let n=t||process.env.CLAUDE_PROJECT_DIR||process.cwd(),o=k(n,".instance","session-id.json");if(T(o))try{let e=JSON.parse(Z(o,"utf8"));if(e.session_id&&e.created_at){let r=Date.now()-new Date(e.created_at).getTime(),i=1440*60*1e3;if(r<i)return e.session_id}}catch{}}function ct(t,n){let o=n||process.env.CLAUDE_PROJECT_DIR||process.cwd(),e=k(o,".instance"),r=k(e,"session-id.json");try{T(e)||q(e,{recursive:!0}),X(r,JSON.stringify({session_id:t,created_at:new Date().toISOString()},null,2))}catch{}}function O(t){if(process.env.CLAUDE_SESSION_ID)return process.env.CLAUDE_SESSION_ID;let n=ut(t);if(n)return n;let o=st(t);return ct(o,t),o}function D(){return E()}function x(){return S()}function dt(){return H()}function tn(){return process.env.CLAUDE_ENV_FILE?process.env.CLAUDE_ENV_FILE:`${dt()}/.claude/.instance_env`}function _(){return O()}function P(t){if(process.env.ORCHESTKIT_BRANCH)return process.env.ORCHESTKIT_BRANCH;try{let n=lt("git branch --show-current",{cwd:t||x(),encoding:"utf8",timeout:5e3,stdio:["pipe","pipe","pipe"]}).trim();return process.env.ORCHESTKIT_BRANCH=n,n}catch{return"unknown"}}function mt(){return process.env.ORCHESTKIT_LOG_LEVEL||"warn"}function nn(t){return t.replace(/\r\n/g,`
`)}function ht(t){let n=["debug","info","warn","error"];return n.indexOf(t)>=n.indexOf(mt())}function u(){return{continue:!0,suppressOutput:!0}}function en(){return{continue:!0,suppressOutput:!0,hookSpecificOutput:{permissionDecision:"allow"}}}function on(t){return{continue:!1,stopReason:t,hookSpecificOutput:{permissionDecision:"deny",permissionDecisionReason:t}}}function rn(t){return{continue:!0,suppressOutput:!0,hookSpecificOutput:{hookEventName:"PostToolUse",additionalContext:t}}}function St(t){return{continue:!0,suppressOutput:!0,hookSpecificOutput:{hookEventName:"UserPromptSubmit",additionalContext:t}}}function sn(t,n){let o={continue:!0,suppressOutput:!0};return t&&(o.systemMessage=t),n&&(o.hookSpecificOutput={hookEventName:"UserPromptSubmit",additionalContext:n}),o}function un(t,n){let o={continue:!0,hookSpecificOutput:{hookEventName:"PreToolUse",additionalContext:t,permissionDecision:"allow"}};return n?o.systemMessage=n:o.suppressOutput=!0,o}function cn(t){return{continue:!0,systemMessage:t}}function pn(t){return{continue:!0,systemMessage:`\u26A0 ${t}`}}function an(t){process.stderr.write(`\u26A0 ${t}
`),process.exit(2)}function gn(t){return{continue:!1,stopReason:t,hookSpecificOutput:{hookEventName:"PreToolUse",permissionDecision:"deny",permissionDecisionReason:t}}}function fn(t){return{continue:!0,suppressOutput:!0,hookSpecificOutput:{hookEventName:"PreToolUse",updatedInput:t}}}var kt=200*1024,_t=100*1024;function C(t,n){if(v(t))try{if(pt(t).size>n){let e=`${t}.old.${Date.now()}`;at(t,e)}}catch{}}function $(t){v(t)||gt(t,{recursive:!0})}function c(t,n,o="debug"){if(!ht(o))return;let e=D(),r=`${e}/hooks.log`;try{$(e),C(r,kt);let i=new Date().toISOString().replace("T"," ").slice(0,19);h(r,`[${i}] [${o.toUpperCase()}] [${t}] ${n}
`)}catch{}}function ln(t,n,o){let e=D(),r=`${e}/permission-feedback.log`;try{$(e),C(r,_t);let i=new Date().toISOString(),s=o?.tool_name||process.env.HOOK_TOOL_NAME||"unknown",l=o?.session_id||_();h(r,`${i} | ${t} | ${n} | tool=${s} | session=${l}
`)}catch{}}function xt(t){if(!t)return 0;let e=(t.match(/[{};()=><]/g)||[]).length/t.length>.03?2.8:3.5;return Math.ceil(t.length/e)}function dn(t,n,o,e,r){let i=xt(t);return e&&e.isOverBudget(o)?(c(n,`Budget exhausted for ${o}, suppressing ${i}t`),u()):(r&&r.trackTokenUsage(n,o,i),St(t))}function mn(){try{let t=[],o=Buffer.allocUnsafe(256),e,r=0;for(;;)try{if(e=ft(r,o,0,256,null),e===0)break;t.push(Buffer.from(o.subarray(0,e)))}catch{break}let i=Buffer.concat(t).toString("utf8").trim();return i?JSON.parse(i):{tool_name:"",session_id:_(),tool_input:{}}}catch{return{tool_name:"",session_id:_(),tool_input:{}}}}function hn(t,n){let o=n.replace(/^\./,"").split("."),e=t;for(let r of o){if(e==null)return;e=e[r]}return e}function Sn(t){return t.replace(/\\\s*[\r\n]+/g," ").replace(/\n/g," ").replace(/\s+/g," ").trim()}function kn(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}import{execSync as I}from"node:child_process";import{basename as yt}from"node:path";var N={permission_prompt:"Sosumi",idle_prompt:"Ping",default:"Ping"};function y(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function w(t){try{return I(`command -v ${t}`,{stdio:"ignore"}),!0}catch{return!1}}function It(t){let n=t.match(/(?:feature|fix|bug|issue)[/-](\d+)/i);return n?`#${n[1]}`:null}function Rt(){try{let t=x();return yt(t)}catch{return"Claude Code"}}function Ht(t,n){let o=It(t),e=n==="permission_prompt"?"\u23F8 Permission needed":"\u{1F4A4} Waiting";return o?`${e} \xB7 ${o} \xB7 ${t}`:`${e} \xB7 ${t}`}function Et(t,n=120){return t.length<=n?t:t.substring(0,n-3)+"..."}function Tt(t,n,o,e){try{let r=y(t),i=y(n),s=y(Et(o));return I(`osascript -e 'display notification "${s}" with title "${r}" subtitle "${i}" sound name "${e}"'`,{stdio:"ignore",timeout:5e3}),!0}catch{return!1}}function bt(t,n,o){try{let e=`${n}
${o}`;return I(`notify-send -- "${t}" "${e}"`,{stdio:"ignore",timeout:5e3}),!0}catch{return!1}}function g(t){let n=t.tool_input||{},o=n.message||t.message||"",e=n.notification_type||t.notification_type||"";if(c("desktop",`Notification: [${e}] ${o.substring(0,100)}`),e!=="permission_prompt"&&e!=="idle_prompt")return u();let r=Rt(),i=P(),s=Ht(i,e),l=N[e]||N.default;return w("osascript")?Tt(r,s,o,l):w("notify-send")&&bt(r,s,o),u()}import{execSync as L}from"node:child_process";var Ot={permission_prompt:"/System/Library/Sounds/Sosumi.aiff",idle_prompt:"/System/Library/Sounds/Ping.aiff",auth_success:"/System/Library/Sounds/Glass.aiff"};function vt(){try{return L("command -v afplay",{stdio:"ignore"}),!0}catch{return!1}}function Dt(t){try{L(`afplay "${t}" &`,{stdio:"ignore"})}catch{}}function f(t){let o=(t.tool_input||{}).notification_type||"";if(c("sound",`Sound notification check: [${o}]`),vt()){let e=Ot[o];e&&Dt(e)}return u()}var U=[{name:"desktop",fn:g},{name:"sound",fn:f}];async function A(t){let o=(await Promise.allSettled(U.map(async e=>{try{let r=e.fn(t);return r instanceof Promise&&await r,{hook:e.name,status:"success"}}catch(r){let i=r instanceof Error?r.message:String(r);return c("notification-dispatcher",`${e.name} failed: ${i}`),{hook:e.name,status:"error",message:i}}}))).filter(e=>e.status==="rejected"||e.status==="fulfilled"&&e.value.status==="error");return o.length>0&&c("notification-dispatcher",`${o.length}/${U.length} hooks had errors`),u()}var F={"notification/desktop":g,"notification/sound":f,"notification/unified-dispatcher":A};function Nn(t){return F[t]}function wn(){return Object.keys(F)}export{kn as escapeRegex,xt as estimateTokenCount,P as getCachedBranch,tn as getEnvFile,hn as getField,Nn as getHook,D as getLogDir,mt as getLogLevel,dt as getPluginRoot,x as getProjectDir,_ as getSessionId,F as hooks,Pt as isBashInput,$t as isEditInput,Nt as isReadInput,Ct as isWriteInput,wn as listHooks,c as logHook,ln as logPermissionFeedback,Sn as normalizeCommand,nn as normalizeLineEndings,un as outputAllowWithContext,on as outputBlock,gn as outputDeny,cn as outputError,St as outputPromptContext,dn as outputPromptContextBudgeted,en as outputSilentAllow,u as outputSilentSuccess,an as outputStderrWarning,pn as outputWarning,rn as outputWithContext,sn as outputWithNotification,fn as outputWithUpdatedInput,mn as readHookInput,ht as shouldLog};
//# sourceMappingURL=notification.mjs.map
