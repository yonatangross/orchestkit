id: infrastructure-001
name: "Kubernetes deployment setup"
description: "Tests Tier 1 agent routing for infrastructure tasks and Tier 2 skill injection for IaC patterns"
scaffold: empty
timeout: 180

prompt: |
  Set up Kubernetes deployment manifests for a microservice with:
  - Deployment with resource limits and health checks
  - Service for internal communication
  - Ingress for external access
  - ConfigMap and Secret for configuration
  - HorizontalPodAutoscaler for scaling

expected:
  # Tier 1: Agent routing correctness
  agent_spawned: infrastructure-architect

  # Tier 2: Skill utilization
  skills_should_read:
    - devops-deployment

  # Output validation
  files_created:
    - "k8s/deployment.yaml"
    - "k8s/service.yaml"

  # Quality gates
  build_command: "true"
  lint_command: "true"
  test_command: "true"

tags:
  - infrastructure
  - kubernetes
  - devops
