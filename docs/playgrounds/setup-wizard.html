<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>OrchestKit Setup Wizard</title>
<link rel="stylesheet" href="nav.css">
<style>
  :root {
    --bg: #0d1117;
    --surface: #161b22;
    --surface2: #1c2128;
    --surface3: #21262d;
    --border: #30363d;
    --text: #e6edf3;
    --text-muted: #8b949e;
    --text-dim: #484f58;
    --accent: #8b5cf6;
    --accent2: #22c55e;
    --accent3: #06b6d4;
    --accent4: #f59e0b;
    --accent5: #f97316;
    --accent6: #ec4899;
    --accent7: #ef4444;
    --glow: rgba(139, 92, 246, 0.15);
  }
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
    background: var(--bg);
    color: var(--text);
    min-height: 100vh;
  }

  .layout {
    display: grid;
    grid-template-columns: 1fr 1fr;
    min-height: 100vh;
  }

  /* LEFT: Controls */
  .controls-panel {
    padding: 32px;
    border-right: 1px solid var(--border);
    overflow-y: auto;
    max-height: calc(100vh - 48px);
    position: sticky;
    top: 48px;
  }

  .wizard-header {
    margin-bottom: 28px;
  }
  .wizard-header .logo {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 8px;
  }
  .logo-box {
    width: 36px;
    height: 36px;
    background: linear-gradient(135deg, var(--accent), var(--accent3));
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 800;
    font-size: 14px;
    color: white;
  }
  .wizard-header h1 {
    font-size: 20px;
    font-weight: 700;
  }
  .wizard-header p {
    color: var(--text-muted);
    font-size: 14px;
    line-height: 1.5;
  }

  /* Step sections */
  .step {
    margin-bottom: 28px;
  }
  .step-header {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 14px;
  }
  .step-num {
    width: 28px;
    height: 28px;
    border-radius: 50%;
    background: var(--surface2);
    border: 2px solid var(--border);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 13px;
    font-weight: 700;
    color: var(--text-muted);
    flex-shrink: 0;
    transition: all 0.3s;
  }
  .step.active .step-num {
    background: var(--accent);
    border-color: var(--accent);
    color: white;
  }
  .step-title {
    font-size: 15px;
    font-weight: 600;
  }

  /* Option groups */
  .option-group {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    margin-bottom: 8px;
  }
  .option-btn {
    padding: 10px 18px;
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 10px;
    color: var(--text-muted);
    font-size: 13px;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    gap: 8px;
    user-select: none;
  }
  .option-btn:hover {
    border-color: var(--accent);
    color: var(--text);
    background: var(--surface2);
  }
  .option-btn.selected {
    background: rgba(139, 92, 246, 0.12);
    border-color: var(--accent);
    color: var(--accent);
    box-shadow: 0 0 12px var(--glow);
  }
  .option-btn .icon { font-size: 16px; }
  .option-btn.selected .icon { filter: none; }

  /* Toggle switches */
  .toggle-row {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 10px 14px;
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 10px;
    margin-bottom: 8px;
    cursor: pointer;
    transition: all 0.2s;
    user-select: none;
  }
  .toggle-row:hover { border-color: var(--accent); }
  .toggle-row.on {
    background: rgba(139, 92, 246, 0.08);
    border-color: rgba(139, 92, 246, 0.4);
  }
  .toggle-label {
    display: flex;
    flex-direction: column;
    gap: 2px;
  }
  .toggle-label .name {
    font-size: 13px;
    font-weight: 600;
  }
  .toggle-label .desc {
    font-size: 11px;
    color: var(--text-muted);
  }
  .toggle-switch {
    width: 40px;
    height: 22px;
    background: var(--surface3);
    border-radius: 11px;
    position: relative;
    transition: background 0.2s;
    flex-shrink: 0;
  }
  .toggle-switch::after {
    content: '';
    position: absolute;
    width: 16px;
    height: 16px;
    border-radius: 50%;
    background: var(--text-muted);
    top: 3px;
    left: 3px;
    transition: all 0.2s;
  }
  .toggle-row.on .toggle-switch {
    background: var(--accent);
  }
  .toggle-row.on .toggle-switch::after {
    left: 21px;
    background: white;
  }

  /* Presets */
  .preset-bar {
    display: flex;
    gap: 8px;
    margin-bottom: 24px;
    flex-wrap: wrap;
  }
  .preset-btn {
    padding: 6px 14px;
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 20px;
    color: var(--text-muted);
    font-size: 12px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
  }
  .preset-btn:hover {
    border-color: var(--accent);
    color: var(--text);
  }
  .preset-btn.active {
    background: var(--accent);
    border-color: var(--accent);
    color: white;
  }

  /* RIGHT: Preview */
  .preview-panel {
    padding: 32px;
    overflow-y: auto;
    max-height: calc(100vh - 48px);
    position: sticky;
    top: 48px;
  }

  /* Results header */
  .results-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 20px;
  }
  .results-title {
    font-size: 16px;
    font-weight: 700;
    margin-bottom: 4px;
  }
  .results-subtitle {
    font-size: 13px;
    color: var(--text-muted);
  }
  .results-stats {
    display: flex;
    gap: 16px;
  }
  .rstat {
    text-align: center;
  }
  .rstat-val {
    font-size: 24px;
    font-weight: 800;
    font-variant-numeric: tabular-nums;
  }
  .rstat-label {
    font-size: 11px;
    color: var(--text-muted);
    text-transform: uppercase;
  }

  /* Plugin list */
  .plugin-list {
    margin-bottom: 20px;
  }
  .plugin-item {
    display: flex;
    align-items: center;
    padding: 12px 16px;
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 10px;
    margin-bottom: 8px;
    transition: all 0.3s;
    animation: slideIn 0.3s ease;
  }
  @keyframes slideIn {
    from { opacity: 0; transform: translateX(10px); }
    to { opacity: 1; transform: translateX(0); }
  }
  .plugin-item.required {
    border-color: rgba(139, 92, 246, 0.4);
    background: rgba(139, 92, 246, 0.06);
  }
  .plugin-item.optional {
    border-style: dashed;
    opacity: 0.7;
  }
  .pi-badge {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    margin-right: 12px;
    flex-shrink: 0;
  }
  .pi-info {
    flex: 1;
    min-width: 0;
  }
  .pi-name {
    font-size: 14px;
    font-weight: 700;
    font-family: 'SF Mono', 'Fira Code', monospace;
  }
  .pi-desc {
    font-size: 11px;
    color: var(--text-muted);
    line-height: 1.4;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
  .pi-counts {
    display: flex;
    gap: 10px;
    margin-left: 12px;
    flex-shrink: 0;
  }
  .pi-count {
    font-size: 12px;
    font-variant-numeric: tabular-nums;
  }
  .pi-count .n { font-weight: 700; }
  .pi-count .l { color: var(--text-muted); }
  .pi-tag {
    font-size: 10px;
    padding: 2px 8px;
    border-radius: 4px;
    font-weight: 600;
    margin-left: 10px;
    flex-shrink: 0;
  }
  .pi-tag.req { background: rgba(139, 92, 246, 0.2); color: var(--accent); }
  .pi-tag.rec { background: rgba(34, 197, 94, 0.2); color: var(--accent2); }
  .pi-tag.opt { background: rgba(139, 92, 246, 0.1); color: var(--text-muted); }

  /* Plugin expand */
  .plugin-item { cursor: pointer; flex-wrap: wrap; }
  .plugin-item:hover { border-color: var(--accent); }
  .pi-row { display: flex; align-items: center; width: 100%; }
  .pi-chevron {
    margin-left: 8px;
    font-size: 10px;
    color: var(--text-dim);
    transition: transform 0.2s;
    flex-shrink: 0;
  }
  .plugin-item.expanded .pi-chevron { transform: rotate(90deg); color: var(--accent); }
  .pi-detail {
    width: 100%;
    display: none;
    padding-top: 14px;
    margin-top: 14px;
    border-top: 1px solid var(--border);
    animation: fadeIn 0.2s ease;
  }
  @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
  .plugin-item.expanded .pi-detail { display: block; }
  .pi-detail-section {
    margin-bottom: 12px;
  }
  .pi-detail-section:last-child { margin-bottom: 0; }
  .pi-detail-label {
    font-size: 10px;
    text-transform: uppercase;
    letter-spacing: 0.6px;
    color: var(--text-muted);
    margin-bottom: 8px;
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 6px;
  }
  .pi-detail-label .badge {
    font-size: 10px;
    padding: 1px 6px;
    border-radius: 3px;
    font-variant-numeric: tabular-nums;
    font-weight: 700;
  }
  .pi-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 5px;
  }
  .pi-skill-tag {
    font-size: 11px;
    padding: 4px 10px;
    border-radius: 6px;
    font-family: 'SF Mono', 'Fira Code', monospace;
    border: 1px solid var(--border);
    background: var(--bg);
    color: var(--text);
    transition: all 0.15s;
    cursor: pointer;
  }
  .pi-skill-tag:hover { border-color: var(--accent3); background: rgba(6, 182, 212, 0.08); transform: translateY(-1px); }
  .pi-skill-tag:active { transform: translateY(0); }

  /* Skill Detail Modal */
  .skill-modal-overlay {
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.7);
    backdrop-filter: blur(4px);
    z-index: 1000;
    display: none;
    align-items: center;
    justify-content: center;
    padding: 24px;
  }
  .skill-modal-overlay.visible { display: flex; }
  .skill-modal {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 16px;
    max-width: 600px;
    width: 100%;
    max-height: 80vh;
    overflow: hidden;
    animation: modalIn 0.2s ease-out;
    box-shadow: 0 24px 48px rgba(0, 0, 0, 0.4);
  }
  @keyframes modalIn {
    from { opacity: 0; transform: scale(0.95) translateY(10px); }
    to { opacity: 1; transform: scale(1) translateY(0); }
  }
  .skill-modal-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 16px 20px;
    border-bottom: 1px solid var(--border);
    background: var(--surface2);
  }
  .skill-modal-title {
    display: flex;
    align-items: center;
    gap: 10px;
    font-weight: 700;
    font-size: 16px;
  }
  .skill-modal-badge {
    font-size: 9px;
    padding: 3px 8px;
    border-radius: 4px;
    text-transform: uppercase;
    font-weight: 700;
    letter-spacing: 0.5px;
  }
  .skill-modal-badge.invocable {
    background: rgba(34, 197, 94, 0.15);
    color: var(--accent2);
    border: 1px solid rgba(34, 197, 94, 0.3);
  }
  .skill-modal-badge.version {
    background: rgba(99, 102, 241, 0.15);
    color: #818cf8;
    border: 1px solid rgba(99, 102, 241, 0.3);
  }
  .skill-modal-close {
    width: 32px;
    height: 32px;
    border-radius: 8px;
    border: 1px solid var(--border);
    background: transparent;
    color: var(--text-muted);
    font-size: 18px;
    cursor: pointer;
    transition: all 0.15s;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  .skill-modal-close:hover { background: rgba(239, 68, 68, 0.1); border-color: var(--accent7); color: var(--accent7); }
  .skill-modal-body {
    padding: 20px;
    overflow-y: auto;
    max-height: calc(80vh - 60px);
  }
  .skill-modal-desc {
    color: var(--text-muted);
    font-size: 14px;
    line-height: 1.6;
    margin-bottom: 16px;
  }
  .skill-modal-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
    margin-bottom: 16px;
  }
  .skill-modal-tag {
    font-size: 10px;
    padding: 4px 10px;
    border-radius: 6px;
    background: rgba(139, 92, 246, 0.1);
    border: 1px solid rgba(139, 92, 246, 0.2);
    color: #c4b5fd;
    font-family: 'SF Mono', monospace;
  }
  .skill-modal-section {
    margin-bottom: 16px;
  }
  .skill-modal-label {
    font-size: 10px;
    text-transform: uppercase;
    letter-spacing: 1px;
    color: var(--text-muted);
    margin-bottom: 8px;
  }
  .skill-modal-link {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 8px 14px;
    background: rgba(139, 92, 246, 0.1);
    border: 1px solid rgba(139, 92, 246, 0.3);
    border-radius: 8px;
    color: var(--accent);
    font-size: 12px;
    font-weight: 600;
    text-decoration: none;
    transition: all 0.15s;
  }
  .skill-modal-link:hover { background: rgba(139, 92, 246, 0.2); border-color: var(--accent); }
  .pi-skill-tag.cmd { border-color: rgba(139, 92, 246, 0.3); color: var(--accent); }
  .pi-skill-tag.cmd::before { content: '/ork:'; color: var(--text-muted); }
  .pi-agent-tag {
    font-size: 11px;
    padding: 4px 10px;
    border-radius: 6px;
    font-family: 'SF Mono', 'Fira Code', monospace;
    border: 1px solid rgba(34, 197, 94, 0.3);
    background: rgba(34, 197, 94, 0.06);
    color: var(--accent2);
    transition: all 0.15s;
  }
  .pi-agent-tag:hover { border-color: var(--accent2); background: rgba(34, 197, 94, 0.12); }
  .pi-full-desc {
    font-size: 12px;
    color: var(--text-muted);
    line-height: 1.6;
    margin-bottom: 12px;
  }

  /* Prompt */
  .prompt-box {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 12px;
    overflow: hidden;
    margin-bottom: 24px;
  }
  .prompt-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 16px;
    border-bottom: 1px solid var(--border);
    background: var(--surface2);
  }
  .prompt-header h3 {
    font-size: 12px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    color: var(--text-muted);
  }
  .copy-btn {
    padding: 5px 14px;
    background: var(--accent);
    border: none;
    border-radius: 6px;
    color: white;
    font-size: 12px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
  }
  .copy-btn:hover { filter: brightness(1.15); }
  .copy-btn.copied { background: var(--accent2); }
  .prompt-body {
    padding: 16px;
    font-family: 'SF Mono', 'Fira Code', monospace;
    font-size: 13px;
    line-height: 1.7;
    white-space: pre-wrap;
    word-break: break-word;
    color: var(--text);
    max-height: 300px;
    overflow-y: auto;
  }

  /* Visual summary bar */
  .summary-bar {
    display: flex;
    height: 6px;
    border-radius: 3px;
    overflow: hidden;
    margin-bottom: 20px;
    background: var(--surface2);
  }
  .summary-segment {
    transition: width 0.4s ease;
  }

  /* Welcome Screen */
  .welcome-screen {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    min-height: calc(100vh - 120px);
    text-align: center;
    padding: 24px;
  }
  .welcome-content { max-width: 480px; }
  .logo-box-large {
    width: 72px;
    height: 72px;
    background: linear-gradient(135deg, var(--accent), var(--accent3));
    border-radius: 16px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    font-weight: 800;
    font-size: 24px;
    color: white;
    margin-bottom: 20px;
  }
  .welcome-title {
    font-size: 28px;
    font-weight: 800;
    margin-bottom: 8px;
    background: linear-gradient(135deg, var(--accent), var(--accent3));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
  }
  .welcome-subtitle {
    color: var(--text-muted);
    font-size: 16px;
    margin-bottom: 32px;
  }
  .welcome-features {
    display: flex;
    flex-direction: column;
    gap: 16px;
    margin-bottom: 32px;
    text-align: left;
  }
  .welcome-feature {
    display: flex;
    align-items: center;
    gap: 14px;
    padding: 14px 18px;
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 12px;
  }
  .feature-icon {
    width: 40px;
    height: 40px;
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 20px;
    flex-shrink: 0;
  }
  .feature-text { display: flex; flex-direction: column; gap: 2px; }
  .feature-text strong { font-size: 14px; font-weight: 700; }
  .feature-text span { font-size: 12px; color: var(--text-muted); }
  .welcome-cta-text {
    color: var(--text-muted);
    font-size: 13px;
    margin-bottom: 16px;
  }
  .welcome-cta {
    width: 100%;
    padding: 14px 28px;
    background: linear-gradient(135deg, var(--accent), var(--accent3));
    border: none;
    border-radius: 12px;
    color: white;
    font-size: 16px;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.2s;
  }
  .welcome-cta:hover { transform: translateY(-2px); box-shadow: 0 8px 24px rgba(139, 92, 246, 0.3); }
  .welcome-skip {
    margin-top: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    font-size: 13px;
    color: var(--text-muted);
  }
  .skip-link {
    background: none;
    border: none;
    color: var(--accent);
    cursor: pointer;
    font-size: 13px;
    text-decoration: underline;
  }
  .skip-link:hover { color: var(--accent3); }

  /* Progress Bar */
  .progress-container { margin-bottom: 24px; }
  .progress-bar {
    height: 4px;
    background: var(--surface2);
    border-radius: 2px;
    overflow: hidden;
    margin-bottom: 12px;
  }
  .progress-fill {
    height: 100%;
    background: linear-gradient(90deg, var(--accent), var(--accent3));
    transition: width 0.4s ease;
  }
  .progress-steps {
    display: flex;
    justify-content: space-between;
    font-size: 11px;
    color: var(--text-muted);
  }
  .progress-step { transition: color 0.2s; }
  .progress-step.active { color: var(--accent); font-weight: 600; }
  .progress-step.completed { color: var(--accent2); }

  @media (max-width: 900px) {
    .layout { grid-template-columns: 1fr; }
    .controls-panel, .preview-panel {
      position: static;
      max-height: none;
    }
  }
</style>
</head>
<body>

<nav class="ork-breadcrumbs" id="breadcrumbs" aria-label="Breadcrumb"></nav>

<div class="layout">
  <div class="controls-panel">
    <!-- Welcome Screen (Step 0) -->
    <div class="welcome-screen" id="welcomeScreen">
      <div class="welcome-content">
        <div class="welcome-logo">
          <div class="logo-box-large">ork</div>
        </div>
        <h1 class="welcome-title">Welcome to OrchestKit</h1>
        <p class="welcome-subtitle">Supercharge Claude Code with AI-powered development tools</p>

        <div class="welcome-features" id="welcomeFeatures">
          <!-- Populated dynamically from ORCHESTKIT_DATA.totals -->
        </div>

        <p class="welcome-cta-text">Answer 3 quick questions to get your personalized setup</p>
        <button class="welcome-cta" onclick="startWizard()">Get Started &rarr;</button>

        <div class="welcome-skip">
          <span>Already know what you need?</span>
          <button class="skip-link" onclick="skipToPresets()">Jump to presets</button>
        </div>
      </div>
    </div>

    <!-- Wizard Content (hidden initially) -->
    <div class="wizard-content" id="wizardContent" style="display:none">
      <div class="wizard-header">
        <div class="logo">
          <div class="logo-box">ork</div>
          <h1>Setup Wizard</h1>
        </div>
        <p>Answer a few questions to get your personalized OrchestKit setup.</p>
      </div>

      <!-- Progress Bar -->
      <div class="progress-container">
        <div class="progress-bar">
          <div class="progress-fill" id="progressFill" style="width:33%"></div>
        </div>
        <div class="progress-steps">
          <span class="progress-step active" data-step="1">Language</span>
          <span class="progress-step" data-step="2">Focus</span>
          <span class="progress-step" data-step="3">Features</span>
        </div>
      </div>

      <div class="preset-bar">
      <span style="font-size:12px;color:var(--text-muted);line-height:28px;margin-right:4px">Presets:</span>
      <button class="preset-btn" onclick="applyPreset('minimal')">Minimal</button>
      <button class="preset-btn" onclick="applyPreset('backend')">Backend Dev</button>
      <button class="preset-btn" onclick="applyPreset('frontend')">Frontend Dev</button>
      <button class="preset-btn" onclick="applyPreset('fullstack')">Full-Stack</button>
      <button class="preset-btn" onclick="applyPreset('ai')">AI Engineer</button>
      <button class="preset-btn" onclick="applyPreset('everything')">Everything</button>
    </div>

    <div class="step active" id="step1">
      <div class="step-header">
        <div class="step-num">1</div>
        <div class="step-title">What's your primary language?</div>
      </div>
      <div class="option-group">
        <button class="option-btn" data-group="lang" data-value="python" onclick="toggle('lang','python')"><span class="icon">&#x1f40d;</span> Python</button>
        <button class="option-btn" data-group="lang" data-value="node" onclick="toggle('lang','node')"><span class="icon">&#x26A1;</span> Node / TypeScript</button>
        <button class="option-btn" data-group="lang" data-value="both" onclick="toggle('lang','both')"><span class="icon">&#x1f504;</span> Both</button>
      </div>
    </div>

    <div class="step active" id="step2">
      <div class="step-header">
        <div class="step-num">2</div>
        <div class="step-title">What are you building?</div>
      </div>
      <div class="option-group">
        <button class="option-btn" data-group="focus" data-value="backend" onclick="toggle('focus','backend')"><span class="icon">&#x2699;</span> Backend / API</button>
        <button class="option-btn" data-group="focus" data-value="frontend" onclick="toggle('focus','frontend')"><span class="icon">&#x1f3a8;</span> Frontend / UI</button>
        <button class="option-btn" data-group="focus" data-value="fullstack" onclick="toggle('focus','fullstack')"><span class="icon">&#x1f4e6;</span> Full-Stack</button>
        <button class="option-btn" data-group="focus" data-value="ai" onclick="toggle('focus','ai')"><span class="icon">&#x1f916;</span> AI / LLM App</button>
      </div>
    </div>

    <div class="step active" id="step3">
      <div class="step-header">
        <div class="step-num">3</div>
        <div class="step-title">What capabilities do you need?</div>
      </div>
      <div class="toggle-row on" onclick="toggleFeature('memory')">
        <div class="toggle-label">
          <span class="name">Memory & Context</span>
          <span class="desc">Remember decisions across sessions, knowledge graph</span>
        </div>
        <div class="toggle-switch"></div>
      </div>
      <div class="toggle-row on" onclick="toggleFeature('testing')">
        <div class="toggle-label">
          <span class="name">Testing</span>
          <span class="desc">Unit, integration, e2e, property-based, MSW mocking</span>
        </div>
        <div class="toggle-switch"></div>
      </div>
      <div class="toggle-row" onclick="toggleFeature('security')">
        <div class="toggle-label">
          <span class="name">Security</span>
          <span class="desc">OWASP Top 10, auth patterns, vulnerability scanning</span>
        </div>
        <div class="toggle-switch"></div>
      </div>
      <div class="toggle-row" onclick="toggleFeature('devops')">
        <div class="toggle-label">
          <span class="name">DevOps & CI/CD</span>
          <span class="desc">Deployment, monitoring, GitHub Actions, releases</span>
        </div>
        <div class="toggle-switch"></div>
      </div>
      <div class="toggle-row" onclick="toggleFeature('git')">
        <div class="toggle-label">
          <span class="name">Git Workflows</span>
          <span class="desc">PR creation, issue tracking, stacked PRs, recovery</span>
        </div>
        <div class="toggle-switch"></div>
      </div>
      <div class="toggle-row" onclick="toggleFeature('video')">
        <div class="toggle-label">
          <span class="name">Video & Demos</span>
          <span class="desc">Remotion videos, terminal recording, marketing assets</span>
        </div>
        <div class="toggle-switch"></div>
      </div>
      <div class="toggle-row" onclick="toggleFeature('mcp')">
        <div class="toggle-label">
          <span class="name">MCP Integration</span>
          <span class="desc">Build MCP servers, browser automation, security hardening</span>
        </div>
        <div class="toggle-switch"></div>
      </div>
      <div class="toggle-row" onclick="toggleFeature('a11y')">
        <div class="toggle-label">
          <span class="name">Accessibility</span>
          <span class="desc">WCAG compliance, a11y testing, focus management</span>
        </div>
        <div class="toggle-switch"></div>
      </div>
      <div class="toggle-row" onclick="toggleFeature('product')">
        <div class="toggle-label">
          <span class="name">Product Management</span>
          <span class="desc">Strategy, business cases, prioritization, market research</span>
        </div>
        <div class="toggle-switch"></div>
      </div>
    </div>
    </div><!-- end wizard-content -->
  </div>

  <div class="preview-panel">
    <div class="prompt-box">
      <div class="prompt-header">
        <h3>Install Commands</h3>
        <button class="copy-btn" id="copyBtn" onclick="copyPrompt()">Copy</button>
      </div>
      <div class="prompt-body" id="promptOutput"></div>
    </div>

    <div class="results-header">
      <div>
        <div class="results-title" id="resultsTitle">Your OrchestKit Setup</div>
        <div class="results-subtitle" id="resultsSubtitle">Select options to see recommendations</div>
      </div>
      <div class="results-stats" id="resultsStats"></div>
    </div>

    <div class="summary-bar" id="summaryBar"></div>

    <div class="plugin-list" id="pluginList"></div>
  </div>
</div>

<script src="data.js"></script>
<script src="nav.js"></script>
<script>
// Two-tier plugin system (v6.0.0)
// orkl: Universal toolkit - works for any stack
// ork: Full specialized toolkit - adds Python, React, LLM/RAG patterns

var PLUGINS = {};
ORCHESTKIT_DATA.plugins.forEach(function(p) {
  PLUGINS[p.name] = {
    desc: p.description,
    fullDesc: p.fullDescription,
    skills: p.skillCount,  // numeric count for display
    agents: p.agentCount,  // numeric count for display
    hooks: p.hooks,
    category: p.category,
    color: p.color,
    required: p.required || false,
    recommended: p.recommended || false,
  };
});

// Initialize from URL parameters
var urlParams = window.orkUrl ? window.orkUrl.getParams() : {};

// Sync state to URL
function syncToUrl() {
  if (!window.orkUrl) return;
  var params = {};
  if (state.preset) params.preset = state.preset;
  window.orkUrl.setParams(params);
}

// Update breadcrumbs
function updateBreadcrumbs() {
  if (!window.orkBreadcrumbs) return;
  window.orkBreadcrumbs.render('breadcrumbs', 'setup-wizard.html', null);
}

// State
var state = {
  lang: null,
  focus: null,
  features: {
    memory: true,
    testing: true,
    security: false,
    devops: false,
    git: false,
    video: false,
    mcp: false,
    a11y: false,
    product: false,
  },
  preset: null,
  expandedPlugin: null,
};

// Two-tier recommendation engine (v6.0.0)
// orkl: Universal - always recommended
// ork: Full - recommended for specialized Python/React/LLM work
function getRecommendations() {
  var rec = {}; // name -> { priority: 'required'|'recommended'|'optional', reason }

  var lang = state.lang;
  var focus = state.focus;
  var needsSpecialized = false;
  var specializedReasons = [];

  // Check if user needs specialized patterns (ork vs orkl)
  if (lang === 'python' || lang === 'both') {
    needsSpecialized = true;
    specializedReasons.push('Python (FastAPI, SQLAlchemy, Celery)');
  }
  if (focus === 'ai') {
    needsSpecialized = true;
    specializedReasons.push('LLM/RAG patterns');
  }
  if (focus === 'frontend' || focus === 'fullstack') {
    if (lang === 'node' || lang === 'both') {
      needsSpecialized = true;
      specializedReasons.push('React (RSC, TanStack, Zustand)');
    }
  }

  // Two-tier decision
  if (needsSpecialized) {
    // Recommend full ork plugin for specialized work
    rec['ork'] = {
      priority: 'recommended',
      reason: 'Full toolkit: ' + specializedReasons.join(', ')
    };
    rec['orkl'] = {
      priority: 'optional',
      reason: 'Universal toolkit (subset of ork)'
    };
  } else {
    // orkl is sufficient for general work
    rec['orkl'] = {
      priority: 'recommended',
      reason: 'Universal toolkit — all workflows, agents, hooks'
    };
    rec['ork'] = {
      priority: 'optional',
      reason: 'Full toolkit — adds Python, React, LLM/RAG patterns'
    };
  }

  return rec;
}

// Toggle functions
function toggle(group, value) {
  if (state[group] === value) {
    state[group] = null;
  } else {
    state[group] = value;
  }
  state.preset = null;
  updateAll();
}

function toggleFeature(feat) {
  state.features[feat] = !state.features[feat];
  state.preset = null;
  updateAll();
}

function togglePlugin(name) {
  state.expandedPlugin = state.expandedPlugin === name ? null : name;
  updateAll();
}

function applyPreset(name) {
  // Reset
  state.lang = null;
  state.focus = null;
  Object.keys(state.features).forEach(function(k) { state.features[k] = false; });

  switch (name) {
    case 'minimal':
      break;
    case 'backend':
      state.lang = 'python';
      state.focus = 'backend';
      state.features.memory = true;
      state.features.testing = true;
      state.features.git = true;
      break;
    case 'frontend':
      state.lang = 'node';
      state.focus = 'frontend';
      state.features.testing = true;
      state.features.a11y = true;
      break;
    case 'fullstack':
      state.lang = 'both';
      state.focus = 'fullstack';
      state.features.memory = true;
      state.features.testing = true;
      state.features.security = true;
      state.features.git = true;
      break;
    case 'ai':
      state.lang = 'python';
      state.focus = 'ai';
      state.features.memory = true;
      state.features.testing = true;
      break;
    case 'everything':
      state.lang = 'both';
      state.focus = 'fullstack';
      Object.keys(state.features).forEach(function(k) { state.features[k] = true; });
      break;
  }
  state.preset = name;
  updateAll();
  syncToUrl();
}

// Render
function updateAll() {
  // Update button states
  var optionBtns = document.querySelectorAll('.option-btn');
  for (var i = 0; i < optionBtns.length; i++) {
    var btn = optionBtns[i];
    var group = btn.dataset.group;
    var value = btn.dataset.value;
    if (state[group] === value) {
      btn.classList.add('selected');
    } else {
      btn.classList.remove('selected');
    }
  }

  // Update toggle states
  var toggleMap = ['memory','testing','security','devops','git','video','mcp','a11y','product'];
  var toggleRows = document.querySelectorAll('.toggle-row');
  for (var i = 0; i < toggleRows.length; i++) {
    var row = toggleRows[i];
    if (state.features[toggleMap[i]]) {
      row.classList.add('on');
    } else {
      row.classList.remove('on');
    }
  }

  // Update presets
  var presetBtns = document.querySelectorAll('.preset-btn');
  for (var i = 0; i < presetBtns.length; i++) {
    var btn = presetBtns[i];
    var presetName = btn.textContent.toLowerCase().replace('-', '').replace(' ', '');
    if (state.preset === presetName) {
      btn.classList.add('active');
    } else {
      btn.classList.remove('active');
    }
  }

  // Get recommendations
  var recs = getRecommendations();
  var recKeys = Object.keys(recs);

  // For two-tier system, show the recommended plugin's stats
  var recommendedPlugin = recKeys.find(function(name) { return recs[name].priority === 'recommended'; });
  var p = PLUGINS[recommendedPlugin];
  var totalSkills = p ? p.skills : 0;
  var totalAgents = p ? p.agents : 0;
  var totalHooks = p ? p.hooks : 0;

  // Results header
  var recommended = recKeys.filter(function(name) { return recs[name].priority === 'recommended'; }).length;
  var optional = recKeys.filter(function(name) { return recs[name].priority === 'optional'; }).length;

  document.getElementById('resultsTitle').textContent = 'Your OrchestKit Setup';
  document.getElementById('resultsSubtitle').textContent = recommended + ' recommended + ' + optional + ' optional (pick one)';

  document.getElementById('resultsStats').innerHTML =
    '<div class="rstat"><div class="rstat-val" style="color:var(--accent3)">' + totalSkills + '</div><div class="rstat-label">Skills</div></div>' +
    '<div class="rstat"><div class="rstat-val" style="color:var(--accent2)">' + totalAgents + '</div><div class="rstat-label">Agents</div></div>' +
    '<div class="rstat"><div class="rstat-val" style="color:var(--accent4)">' + totalHooks + '</div><div class="rstat-label">Hooks</div></div>';

  // Summary bar - show categories from agent data
  var categories = ORCHESTKIT_DATA.categories;
  var catKeys = Object.keys(categories);
  var totalCats = catKeys.length;
  document.getElementById('summaryBar').innerHTML = catKeys.map(function(cat) {
    return '<div class="summary-segment" style="width:' + (100/totalCats) + '%;background:' + categories[cat].color + '" title="' + categories[cat].label + '"></div>';
  }).join('');

  // Plugin list
  var recEntries = recKeys.map(function(name) { return { name: name, rec: recs[name] }; });
  var pri = { required: 0, recommended: 1, optional: 2 };
  recEntries.sort(function(a, b) {
    return pri[a.rec.priority] - pri[b.rec.priority];
  });

  document.getElementById('pluginList').innerHTML = recEntries.map(function(entry, i) {
    var name = entry.name;
    var rec = entry.rec;
    var p = PLUGINS[name];
    if (!p) return '';
    var tagClass = rec.priority === 'required' ? 'req' : rec.priority === 'recommended' ? 'rec' : 'opt';
    var tagLabel = rec.priority === 'required' ? 'REQUIRED' : rec.priority === 'recommended' ? 'RECOMMENDED' : 'OPTIONAL';
    var isExpanded = state.expandedPlugin === name;
    var skillsHtml = p.skills ? '<span class="pi-count"><span class="n">' + p.skills + '</span> <span class="l">skills</span></span>' : '';
    var agentsHtml = p.agents ? '<span class="pi-count"><span class="n">' + p.agents + '</span> <span class="l">agents</span></span>' : '';
    var hooksHtml = p.hooks ? '<span class="pi-count"><span class="n">' + p.hooks + '</span> <span class="l">hooks</span></span>' : '';

    // Build skills summary for expanded view
    var skillsSummary = ORCHESTKIT_DATA.skillsSummary[name];
    var skillsSectionHtml = '';
    if (skillsSummary) {
      var summaryParts = [];
      if (skillsSummary.includesAllOrkLite) {
        summaryParts.push('<div style="font-size:12px;color:var(--accent2);margin-bottom:8px">Includes everything from orkl plus:</div>');
      }
      Object.keys(skillsSummary).forEach(function(cat) {
        if (cat === 'includesAllOrkLite') return;
        var skills = skillsSummary[cat];
        if (Array.isArray(skills) && skills.length) {
          summaryParts.push('<div style="margin-bottom:8px"><span style="font-size:11px;color:var(--text-muted);text-transform:uppercase">' + cat + '</span><div class="pi-tags" style="margin-top:4px">' + skills.map(function(s) { return '<span class="pi-skill-tag">' + s + '</span>'; }).join('') + '</div></div>');
        }
      });
      if (summaryParts.length) {
        skillsSectionHtml = '<div class="pi-detail-section"><div class="pi-detail-label">Key Skills <span class="badge" style="background:rgba(6,182,212,0.2);color:var(--accent3)">' + p.skills + ' total</span></div>' + summaryParts.join('') + '</div>';
      }
    }

    var hooksSection = p.hooks ? '<div class="pi-detail-section"><div class="pi-detail-label">Hooks <span class="badge" style="background:rgba(245,158,11,0.2);color:var(--accent4)">' + p.hooks + '</span></div><div style="font-size:12px;color:var(--text-muted)">Lifecycle automation across 11 split bundles (89 global + 28 agent/skill-scoped)</div></div>' : '';
    var agentsSection = '<div class="pi-detail-section"><div class="pi-detail-label">Agents <span class="badge" style="background:rgba(34,197,94,0.2);color:var(--accent2)">' + p.agents + '</span></div><div style="font-size:12px;color:var(--text-muted)">36 specialized agents for backend, frontend, security, devops, AI, testing, product, and more</div></div>';

    return '<div class="plugin-item ' + rec.priority + ' ' + (isExpanded ? 'expanded' : '') + '" style="animation-delay:' + (i * 0.05) + 's" onclick="togglePlugin(\'' + name + '\')">' +
        '<div class="pi-row">' +
          '<div class="pi-badge" style="background:' + p.color + '"></div>' +
          '<div class="pi-info">' +
            '<div class="pi-name">' + name + '</div>' +
            '<div class="pi-desc">' + rec.reason + '</div>' +
          '</div>' +
          '<div class="pi-counts">' + skillsHtml + agentsHtml + hooksHtml + '</div>' +
          '<span class="pi-tag ' + tagClass + '">' + tagLabel + '</span>' +
          '<span class="pi-chevron">\u25B6</span>' +
        '</div>' +
        '<div class="pi-detail">' +
          '<div class="pi-full-desc">' + (p.fullDesc || p.desc) + '</div>' +
          skillsSectionHtml + agentsSection + hooksSection +
        '</div>' +
      '</div>';
  }).join('');

  // Prompt output
  updatePrompt(recs);
}

function updatePrompt(recs) {
  var parts = [];
  var recKeys = Object.keys(recs);
  var recommendedList = recKeys.filter(function(name) { return recs[name].priority === 'recommended'; });
  var optionalList = recKeys.filter(function(name) { return recs[name].priority === 'optional'; });

  // Build description
  var focusLabels = { backend: 'backend', frontend: 'frontend', fullstack: 'full-stack', ai: 'AI/LLM' };
  var langLabels = { python: 'Python', node: 'TypeScript/Node', both: 'Python + TypeScript' };
  var focusLabel = focusLabels[state.focus] || '';
  var langLabel = langLabels[state.lang] || '';

  var labels = [];
  if (langLabel) labels.push(langLabel);
  if (focusLabel) labels.push(focusLabel);
  if (labels.length) {
    parts.push('# OrchestKit v6.0.0 — ' + labels.join(' ') + ' development');
  } else {
    parts.push('# OrchestKit v6.0.0 — Universal AI Development Toolkit');
  }
  parts.push('');
  parts.push('# Two-tier plugin system: pick ONE plugin');
  parts.push('');

  if (recommendedList.length) {
    var recommended = recommendedList[0];
    var p = PLUGINS[recommended];
    parts.push('# Recommended for your stack:');
    parts.push('claude plugin install ' + recommended);
    parts.push('# ' + p.skills + ' skills, ' + p.agents + ' agents, ' + p.hooks + ' hooks');
    parts.push('');
  }

  if (optionalList.length) {
    parts.push('# Alternative:');
    optionalList.forEach(function(name) {
      var p = PLUGINS[name];
      parts.push('# claude plugin install ' + name + '  (' + p.skills + ' skills)');
    });
    parts.push('');
  }

  // Explanation of two-tier system
  parts.push('# orkl: Universal toolkit, language-agnostic');
  parts.push('# ork: Full toolkit with Python, React, LLM/RAG patterns');
  parts.push('#');
  parts.push('# Both include all 36 agents and 117 hooks.');
  parts.push('# ork includes everything in orkl plus specialized skills.');

  document.getElementById('promptOutput').textContent = parts.join('\n');
}

function copyPrompt() {
  var text = document.getElementById('promptOutput').textContent;
  navigator.clipboard.writeText(text).then(function() {
    var btn = document.getElementById('copyBtn');
    btn.textContent = 'Copied!';
    btn.classList.add('copied');
    setTimeout(function() { btn.textContent = 'Copy'; btn.classList.remove('copied'); }, 1500);
  });
}

// Populate welcome screen with dynamic data
function initWelcomeScreen() {
  var totals = ORCHESTKIT_DATA.totals;
  var featuresEl = document.getElementById('welcomeFeatures');

  var features = [
    { icon: '&#x1f4da;', color: 'var(--accent)', count: totals.skills, label: 'Skills', desc: 'Reusable knowledge modules for every stack' },
    { icon: '&#x1f916;', color: 'var(--accent2)', count: totals.agents, label: 'Agents', desc: 'Specialized AI personas for different tasks' },
    { icon: '&#x26a1;', color: 'var(--accent4)', count: totals.hooks, label: 'Hooks', desc: 'Automated quality gates & lifecycle automation' },
  ];

  featuresEl.innerHTML = features.map(function(f) {
    return '<div class="welcome-feature">' +
      '<span class="feature-icon" style="background:' + f.color + '">' + f.icon + '</span>' +
      '<div class="feature-text">' +
        '<strong>' + f.count + ' ' + f.label + '</strong>' +
        '<span>' + f.desc + '</span>' +
      '</div>' +
    '</div>';
  }).join('');
}

// Welcome screen functions
function startWizard() {
  document.getElementById('welcomeScreen').style.display = 'none';
  document.getElementById('wizardContent').style.display = 'block';
  updateProgress();
}

function skipToPresets() {
  startWizard();
  // Scroll to presets
  document.querySelector('.preset-bar').scrollIntoView({ behavior: 'smooth' });
}

// Progress bar
function updateProgress() {
  var progress = 0;
  var currentStep = 1;

  if (state.lang) {
    progress += 33;
    currentStep = 2;
  }
  if (state.focus) {
    progress += 33;
    currentStep = 3;
  }
  // Features always count as partial progress when visible
  if (state.lang && state.focus) {
    progress = 100;
  }

  document.getElementById('progressFill').style.width = progress + '%';

  // Update step indicators
  var progressSteps = document.querySelectorAll('.progress-step');
  for (var i = 0; i < progressSteps.length; i++) {
    var step = progressSteps[i];
    var stepNum = i + 1;
    step.classList.remove('active', 'completed');
    if (stepNum < currentStep || (stepNum === 3 && progress === 100)) {
      step.classList.add('completed');
    } else if (stepNum === currentStep) {
      step.classList.add('active');
    }
  }
}

// Override updateAll to also update progress
var originalUpdateAll = updateAll;
updateAll = function() {
  originalUpdateAll();
  if (document.getElementById('wizardContent').style.display !== 'none') {
    updateProgress();
  }
};

// Init
initWelcomeScreen();
updateBreadcrumbs();
updateAll();

// Auto-apply preset from URL ?preset= parameter
if (urlParams.preset) {
  var validPresets = ['minimal', 'backend', 'frontend', 'fullstack', 'ai', 'everything'];
  if (validPresets.indexOf(urlParams.preset) !== -1) {
    // Skip welcome screen and apply preset
    startWizard();
    applyPreset(urlParams.preset);
  }
}
</script>
</body>
</html>
