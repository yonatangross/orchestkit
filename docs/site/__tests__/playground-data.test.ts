// Generated by OrchestKit Claude Plugin
// Created: 2026-02-07

import { describe, it, expect } from "vitest";
import {
  TOTALS,
  PLUGINS,
  AGENTS,
  CATEGORIES,
  COMPOSITIONS,
  SKILLS,
  SKILLS_SUMMARY,
  type SkillDetail,
  type CategoryMeta,
} from "@/lib/playground-data";

describe("playground-data", () => {
  // ── TOTALS ────────────────────────────────────────────────

  describe("TOTALS", () => {
    it("has required numeric fields", () => {
      expect(typeof TOTALS.plugins).toBe("number");
      expect(typeof TOTALS.skills).toBe("number");
      expect(typeof TOTALS.agents).toBe("number");
      expect(typeof TOTALS.hooks).toBe("number");
      expect(typeof TOTALS.commands).toBe("number");
      expect(typeof TOTALS.compositions).toBe("number");
    });

    it("has non-zero values", () => {
      expect(TOTALS.plugins).toBeGreaterThan(0);
      expect(TOTALS.skills).toBeGreaterThan(0);
      expect(TOTALS.agents).toBeGreaterThan(0);
    });

    it("matches expected counts", () => {
      expect(TOTALS.skills).toBe(199);
      expect(TOTALS.agents).toBe(36);
      expect(TOTALS.hooks).toBe(119);
    });
  });

  // ── PLUGINS ───────────────────────────────────────────────

  describe("PLUGINS", () => {
    it("is an array", () => {
      expect(Array.isArray(PLUGINS)).toBe(true);
    });

    it("contains orkl, ork-creative, and ork plugins", () => {
      const names = PLUGINS.map((p) => p.name);
      expect(names).toContain("orkl");
      expect(names).toContain("ork-creative");
      expect(names).toContain("ork");
    });

    it("has correct Plugin shape", () => {
      const plugin = PLUGINS[0];
      expect(typeof plugin.name).toBe("string");
      expect(typeof plugin.description).toBe("string");
      expect(typeof plugin.version).toBe("string");
      expect(typeof plugin.skillCount).toBe("number");
      expect(typeof plugin.agentCount).toBe("number");
      expect(typeof plugin.hooks).toBe("number");
      expect(Array.isArray(plugin.skills)).toBe(true);
      expect(Array.isArray(plugin.agents)).toBe(true);
    });

    it("orkl has 88 skills", () => {
      const orkl = PLUGINS.find((p) => p.name === "orkl");
      expect(orkl).toBeDefined();
      expect(orkl!.skillCount).toBe(88);
    });

    it("ork-creative has 16 skills", () => {
      const orkCreative = PLUGINS.find((p) => p.name === "ork-creative");
      expect(orkCreative).toBeDefined();
      expect(orkCreative!.skillCount).toBe(16);
    });

    it("ork has 200 skills", () => {
      const ork = PLUGINS.find((p) => p.name === "ork");
      expect(ork).toBeDefined();
      expect(ork!.skillCount).toBe(200);
    });
  });

  // ── AGENTS ────────────────────────────────────────────────

  describe("AGENTS", () => {
    it("is an array of 36 agents", () => {
      expect(Array.isArray(AGENTS)).toBe(true);
      expect(AGENTS.length).toBe(36);
    });

    it("has correct AgentSummary shape", () => {
      const agent = AGENTS[0];
      expect(typeof agent.name).toBe("string");
      expect(typeof agent.description).toBe("string");
      expect(Array.isArray(agent.plugins)).toBe(true);
      expect(typeof agent.model).toBe("string");
      expect(typeof agent.category).toBe("string");
    });

    it("includes known agents", () => {
      const names = AGENTS.map((a) => a.name);
      expect(names).toContain("frontend-ui-developer");
      expect(names).toContain("backend-system-architect");
      expect(names).toContain("security-auditor");
    });
  });

  // ── CATEGORIES ────────────────────────────────────────────

  describe("CATEGORIES", () => {
    it("is a non-empty object", () => {
      expect(typeof CATEGORIES).toBe("object");
      expect(Object.keys(CATEGORIES).length).toBeGreaterThan(0);
    });

    it("has CategoryMeta shape", () => {
      const first = Object.values(CATEGORIES)[0] as CategoryMeta;
      expect(typeof first.color).toBe("string");
      expect(typeof first.label).toBe("string");
    });
  });

  // ── COMPOSITIONS ──────────────────────────────────────────

  describe("COMPOSITIONS", () => {
    it("is a non-empty array", () => {
      expect(Array.isArray(COMPOSITIONS)).toBe(true);
      expect(COMPOSITIONS.length).toBeGreaterThan(0);
    });

    it("has correct Composition shape", () => {
      const comp = COMPOSITIONS[0];
      expect(typeof comp.id).toBe("string");
      expect(typeof comp.command).toBe("string");
      expect(typeof comp.format).toBe("string");
      expect(typeof comp.width).toBe("number");
      expect(typeof comp.height).toBe("number");
      expect(typeof comp.fps).toBe("number");
      expect(typeof comp.durationSeconds).toBe("number");
      expect(typeof comp.category).toBe("string");
      expect(Array.isArray(comp.tags)).toBe(true);
    });

    it("has valid formats", () => {
      const validFormats = ["landscape", "vertical", "square"];
      for (const comp of COMPOSITIONS) {
        expect(validFormats).toContain(comp.format);
      }
    });

    it("CDN thumbnail URLs point to Sanity CDN", () => {
      const withThumb = COMPOSITIONS.filter((c) => c.thumbnailCdn);
      expect(withThumb.length).toBeGreaterThan(0);
      for (const comp of withThumb) {
        expect(comp.thumbnailCdn).toMatch(/^https:\/\/cdn\.sanity\.io\//);
      }
    });

    it("CDN video URLs point to Sanity CDN mp4 files", () => {
      const withVideo = COMPOSITIONS.filter((c) => c.videoCdn);
      // At least some compositions should have videos
      for (const comp of withVideo) {
        expect(comp.videoCdn).toMatch(/^https:\/\/cdn\.sanity\.io\/.*\.mp4$/);
      }
    });

    it("every composition with videoCdn also has thumbnailCdn", () => {
      const withVideo = COMPOSITIONS.filter((c) => c.videoCdn);
      for (const comp of withVideo) {
        expect(comp.thumbnailCdn).toBeTruthy();
      }
    });
  });

  // ── SKILLS ────────────────────────────────────────────────

  describe("SKILLS", () => {
    it("is a non-empty object", () => {
      expect(typeof SKILLS).toBe("object");
      expect(Object.keys(SKILLS).length).toBeGreaterThan(0);
    });

    it("has 200 skills", () => {
      expect(Object.keys(SKILLS).length).toBe(200);
    });

    it("has correct SkillDetail shape", () => {
      const first = Object.values(SKILLS)[0] as SkillDetail;
      expect(typeof first.name).toBe("string");
      expect(typeof first.description).toBe("string");
      expect(Array.isArray(first.tags)).toBe(true);
      expect(typeof first.userInvocable).toBe("boolean");
      expect(Array.isArray(first.plugins)).toBe(true);
      expect(Array.isArray(first.relatedAgents)).toBe(true);
    });

    it("every skill has a non-empty name", () => {
      for (const skill of Object.values(SKILLS)) {
        expect(skill.name).toBeTruthy();
        expect(skill.name.length).toBeGreaterThan(0);
      }
    });

    it("every skill has valid plugins array", () => {
      const validPlugins = ["orkl", "ork", "ork-creative"];
      for (const skill of Object.values(SKILLS)) {
        expect(skill.plugins.length).toBeGreaterThan(0);
        for (const plugin of skill.plugins) {
          expect(validPlugins).toContain(plugin);
        }
      }
    });
  });

  // ── SKILLS_SUMMARY ────────────────────────────────────────

  describe("SKILLS_SUMMARY", () => {
    it("is a non-empty object keyed by plugin", () => {
      expect(typeof SKILLS_SUMMARY).toBe("object");
      expect(Object.keys(SKILLS_SUMMARY).length).toBeGreaterThan(0);
    });

    it("contains orkl and ork keys", () => {
      const keys = Object.keys(SKILLS_SUMMARY);
      expect(keys).toContain("orkl");
      expect(keys).toContain("ork");
    });
  });

  // ── Cross-module consistency ──────────────────────────────

  describe("cross-module consistency", () => {
    it("TOTALS.compositions matches COMPOSITIONS.length", () => {
      expect(TOTALS.compositions).toBe(COMPOSITIONS.length);
    });

    it("TOTALS.agents matches AGENTS.length", () => {
      expect(TOTALS.agents).toBe(AGENTS.length);
    });

    it("TOTALS.skills matches SKILLS keys count", () => {
      expect(TOTALS.skills).toBe(Object.keys(SKILLS).length);
    });

    it("TOTALS.plugins matches PLUGINS.length", () => {
      expect(TOTALS.plugins).toBe(PLUGINS.length);
    });
  });
});
