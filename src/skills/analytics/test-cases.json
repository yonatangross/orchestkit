{
  "skill": "analytics",
  "version": "1.0.0",
  "testCases": [
    {
      "id": "analytics-agents",
      "rule": "analytics-agents",
      "query": "/ork:analytics agents",
      "expectedBehavior": [
        "Reads agent-usage.jsonl from ~/.claude/analytics/",
        "Runs jq query from references/jq-queries.md agents section",
        "Presents results as markdown table with agent name, count, avg duration, success rate",
        "Includes per-agent model breakdown"
      ]
    },
    {
      "id": "analytics-session-latest",
      "rule": "analytics-session",
      "query": "/ork:analytics session latest",
      "expectedBehavior": [
        "Finds CC session directory using encoded project path",
        "Locates most recently modified .jsonl file",
        "Parses JSONL entries for tool calls, token usage, timestamps",
        "Presents timeline with session metadata, tool usage table, token breakdown"
      ]
    },
    {
      "id": "analytics-cost",
      "rule": "analytics-cost",
      "query": "/ork:analytics cost",
      "expectedBehavior": [
        "Reads ~/.claude/stats-cache.json for modelUsage data",
        "Applies model-specific pricing (opus/sonnet/haiku) to 4 token types",
        "Calculates cache savings (cache reads vs full-price input)",
        "Shows daily costs for last 7 days",
        "Presents as markdown table with per-model breakdown and totals"
      ]
    },
    {
      "id": "analytics-trends",
      "rule": "analytics-trends",
      "query": "/ork:analytics trends 30",
      "expectedBehavior": [
        "Reads dailyActivity and dailyModelTokens from stats-cache.json for last 30 days",
        "Shows daily activity table with sessions, messages, tools, estimated cost",
        "Shows model delegation trend over time",
        "Shows peak productivity hours",
        "Shows all-time stats (total sessions, longest session)"
      ]
    },
    {
      "id": "analytics-no-trigger-general",
      "rule": "analytics-trigger",
      "query": "How many tokens did I use today?",
      "expectedBehavior": [
        "Analytics skill should NOT activate for general token questions",
        "This is a conversational question, not an analytics subcommand",
        "Claude should answer from context or suggest using /ork:analytics cost"
      ]
    },
    {
      "id": "analytics-no-subcommand",
      "rule": "analytics-subcommands",
      "query": "/ork:analytics",
      "expectedBehavior": [
        "No subcommand provided â€” uses AskUserQuestion to let user pick",
        "Offers all available subcommands: agents, models, skills, hooks, teams, session, cost, trends, summary"
      ]
    },
    {
      "id": "analytics-summary",
      "rule": "analytics-summary",
      "query": "/ork:analytics summary",
      "expectedBehavior": [
        "Runs all subcommand queries and presents unified view",
        "Shows total sessions, total tool invocations",
        "Shows top 5 agents, top 5 skills",
        "Shows team activity overview if team data exists",
        "Shows unique project hash count",
        "Gracefully handles missing files (notes 'no data collected yet')"
      ]
    }
  ]
}
