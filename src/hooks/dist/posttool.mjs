// OrchestKit Hooks - posttool bundle
// Generated: 2026-02-28T13:40:06.801Z

var w=(t=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(t,{get:(e,n)=>(typeof require<"u"?require:e)[n]}):t)(function(t){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+t+'" is not supported')});function ta(t){return typeof t.command=="string"}function ea(t){return typeof t.file_path=="string"&&typeof t.content=="string"}function na(t){return typeof t.file_path=="string"&&typeof t.old_string=="string"&&typeof t.new_string=="string"}function ra(t){return typeof t.file_path=="string"&&t.content===void 0}import{existsSync as F,statSync as $n,renameSync as Rn,mkdirSync as Ht,readSync as An,readFileSync as Pn,writeFileSync as On}from"node:fs";import{join as Dn}from"node:path";import{appendFileSync as cn,mkdirSync as un}from"node:fs";import{dirname as ln}from"node:path";var j=[],ct=!1,vt=!1;function _(t,e){j.push({filePath:t,content:e}),dn()}function ut(){if(ct||j.length===0)return;ct=!0;let t=new Map;for(let e of j){let n=t.get(e.filePath);n?n.push(e.content):t.set(e.filePath,[e.content])}for(let[e,n]of t)try{un(ln(e),{recursive:!0}),cn(e,n.join(""))}catch{}j.length=0,ct=!1}function dn(){vt||(vt=!0,process.on("exit",ut),process.on("SIGTERM",()=>{ut(),process.exit(0)}),process.on("SIGINT",()=>{ut(),process.exit(0)}))}import{execSync as jn}from"node:child_process";import wt from"node:os";import T from"node:path";function lt(){return process.env.HOME||process.env.USERPROFILE||wt.homedir()}function H(){return wt.tmpdir()}function dt(){return process.env.CLAUDE_PROJECT_DIR||"."}function Tt(){return process.env.CLAUDE_PLUGIN_ROOT||process.env.CLAUDE_PROJECT_DIR||"."}function It(){return process.env.CLAUDE_PLUGIN_ROOT?T.join(lt(),".claude","logs","ork"):T.join(dt(),".claude","logs")}function $t(){return process.env.CLAUDE_METRICS_FILE||T.join(H(),"claude-session-metrics.json")}function Rt(){return process.env.CLAUDE_SESSION_ERRORS_FILE||T.join(H(),"claude-session-errors.json")}function N(t){return T.join(H(),`claude-session-${t}`)}function At(){return T.join(H(),"claude-read-count")}var gt=T.join,la=T.sep;import{execSync as gn}from"node:child_process";import{createHash as pn}from"node:crypto";import{existsSync as Pt,readFileSync as fn,writeFileSync as mn,mkdirSync as yn}from"node:fs";import{join as pt,basename as hn}from"node:path";var _n=20,kn=15,Sn=/[^a-z0-9-]/g;function bn(t){let e=t||process.env.CLAUDE_PROJECT_DIR||process.cwd(),n=hn(e);return Ot(n,_n)}function xn(t){if(process.env.ORCHESTKIT_SESSION_BRANCH)return process.env.ORCHESTKIT_SESSION_BRANCH;let e=t||process.env.CLAUDE_PROJECT_DIR||process.cwd();try{let n=gn("git branch --show-current",{cwd:e,encoding:"utf8",timeout:2e3,stdio:["pipe","pipe","pipe"]}).trim(),r=Ot(n||"detached",kn);return process.env.ORCHESTKIT_SESSION_BRANCH=r,r}catch{return"nobranch"}}function Cn(t){let e=t||new Date,n=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0");return`${n}${r}`}function En(t){let e=t||new Date,n=String(e.getHours()).padStart(2,"0"),r=String(e.getMinutes()).padStart(2,"0");return`${n}${r}`}function vn(){let t=`${process.pid}-${Date.now()}-${Math.random()}`;return pn("sha256").update(t).digest("hex").slice(0,4)}function Ot(t,e){return t.toLowerCase().replace(Sn,"-").replace(/-+/g,"-").replace(/^-|-$/g,"").slice(0,e)}function wn(t,e){let n=bn(t),r=xn(t),s=Cn(e),o=En(e),i=vn();return`${n}-${r}-${s}-${o}-${i}`}function Tn(t){let e=t||process.env.CLAUDE_PROJECT_DIR||process.cwd(),n=pt(e,".instance","session-id.json");if(Pt(n))try{let r=JSON.parse(fn(n,"utf8"));if(r.session_id&&r.created_at){let s=Date.now()-new Date(r.created_at).getTime(),o=1440*60*1e3;if(s<o)return r.session_id}}catch{}}function In(t,e){let n=e||process.env.CLAUDE_PROJECT_DIR||process.cwd(),r=pt(n,".instance"),s=pt(r,"session-id.json");try{Pt(r)||yn(r,{recursive:!0}),mn(s,JSON.stringify({session_id:t,created_at:new Date().toISOString()},null,2))}catch{}}function Dt(t){if(process.env.CLAUDE_SESSION_ID)return process.env.CLAUDE_SESSION_ID;let e=Tn(t);if(e)return e;let n=wn(t);return In(n,t),n}function Nt(){return It()}function g(){return dt()}function Hn(){return Tt()}function Ca(){return process.env.CLAUDE_ENV_FILE?process.env.CLAUDE_ENV_FILE:`${Hn()}/.claude/.instance_env`}function y(){return Dt()}function Ea(t){if(process.env.ORCHESTKIT_BRANCH)return process.env.ORCHESTKIT_BRANCH;try{let e=jn("git branch --show-current",{cwd:t||g(),encoding:"utf8",timeout:5e3,stdio:["pipe","pipe","pipe"]}).trim();return process.env.ORCHESTKIT_BRANCH=e,e}catch{return"unknown"}}function Nn(){return process.env.ORCHESTKIT_LOG_LEVEL||"warn"}function va(t){return t.replace(/\r\n/g,`
`)}function Fn(t){let e=["debug","info","warn","error"];return e.indexOf(t)>=e.indexOf(Nn())}function c(){return{continue:!0,suppressOutput:!0}}function wa(){return{continue:!0,suppressOutput:!0,hookSpecificOutput:{permissionDecision:"allow"}}}function Ta(t){return{continue:!1,stopReason:t,hookSpecificOutput:{permissionDecision:"deny",permissionDecisionReason:t}}}function Ft(t){return{continue:!0,suppressOutput:!0,hookSpecificOutput:{hookEventName:"PostToolUse",additionalContext:t}}}function Ln(t){return{continue:!0,suppressOutput:!0,hookSpecificOutput:{hookEventName:"UserPromptSubmit",additionalContext:t}}}function Ia(t,e){let n={continue:!0,suppressOutput:!0};return t&&(n.systemMessage=t),e&&(n.hookSpecificOutput={hookEventName:"UserPromptSubmit",additionalContext:e}),n}function $a(t,e){let n={continue:!0,hookSpecificOutput:{hookEventName:"PreToolUse",additionalContext:t,permissionDecision:"allow"}};return e?n.systemMessage=e:n.suppressOutput=!0,n}function Ra(t){return{continue:!0,systemMessage:t}}function Aa(t){return{continue:!0,systemMessage:`\u26A0 ${t}`}}function Pa(t){process.stderr.write(`\u26A0 ${t}
`),process.exit(2)}function Oa(t){return{continue:!1,stopReason:t,hookSpecificOutput:{hookEventName:"PreToolUse",permissionDecision:"deny",permissionDecisionReason:t}}}function Da(t){return{continue:!0,suppressOutput:!0,hookSpecificOutput:{hookEventName:"PreToolUse",updatedInput:t}}}var Mn=200*1024,Bn=100*1024;function Lt(t,e){if(F(t))try{if($n(t).size>e){let r=`${t}.old.${Date.now()}`;Rn(t,r)}}catch{}}function Mt(t){F(t)||Ht(t,{recursive:!0})}function l(t,e,n="debug"){if(!Fn(n))return;let r=Nt(),s=`${r}/hooks.log`;try{Mt(r),Lt(s,Mn);let o=new Date().toISOString().replace("T"," ").slice(0,19);_(s,`[${o}] [${n.toUpperCase()}] [${t}] ${e}
`)}catch{}}function ja(t,e,n){let r=Nt(),s=`${r}/permission-feedback.log`;try{Mt(r),Lt(s,Bn);let o=new Date().toISOString(),i=n?.tool_name||process.env.HOOK_TOOL_NAME||"unknown",u=n?.session_id||y();_(s,`${o} | ${t} | ${e} | tool=${i} | session=${u}
`)}catch{}}function Ha(t){return t.hookSpecificOutput?.additionalContext?t.hookSpecificOutput.additionalContext:t.systemMessage&&typeof t.systemMessage=="string"?t.systemMessage:null}function Un(t){if(!t)return 0;let r=(t.match(/[{};()=><]/g)||[]).length/t.length>.03?2.8:3.5;return Math.ceil(t.length/r)}function Na(t,e,n,r,s){let o=Un(t);return r?.isOverBudget(n)?(l(e,`Budget exhausted for ${n}, suppressing ${o}t`),c()):(s&&s.trackTokenUsage(e,n,o),Ln(t))}function jt(t){let e=2166136261;for(let n=0;n<t.length;n++)e^=t.charCodeAt(n),e=Math.imul(e,16777619);return(e>>>0).toString(16).padStart(8,"0")}function Fa(t,e,n,r){let s=Dn(t,e);if(F(s))try{let o=Pn(s,"utf8");if(jt(o)===jt(n))return l(r,`Rules file ${e} unchanged, skipping write`),!1}catch{}return F(t)||Ht(t,{recursive:!0}),On(s,n,"utf8"),l(r,`Wrote rules file: ${s}`),!0}function La(){try{let t=[],n=Buffer.allocUnsafe(256),r,s=0;for(;;)try{if(r=An(s,n,0,256,null),r===0)break;t.push(Buffer.from(n.subarray(0,r)))}catch{break}let o=Buffer.concat(t).toString("utf8").trim();return o?JSON.parse(o):{tool_name:"",session_id:y(),tool_input:{}}}catch{return{tool_name:"",session_id:y(),tool_input:{}}}}function p(t,e){let n=e.replace(/^\./,"").split("."),r=t;for(let s of n){if(r==null)return;r=r[s]}return r}function Ma(t,...e){return t.split(`
`).some(n=>e.every(r=>n.includes(r)))}function E(t,...e){return t.split(`
`).some(n=>{let r=n.toLowerCase();return e.every(s=>r.includes(s.toLowerCase()))})}function Ba(t){return t.replace(/\\\s*[\r\n]+/g," ").replace(/\n/g," ").replace(/\s+/g," ").trim()}function Ua(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}import{execSync as R}from"node:child_process";function zn(t){let e=t||g();try{return R("git branch --show-current",{cwd:e,encoding:"utf8",timeout:5e3,stdio:["pipe","pipe","pipe"]}).trim()}catch{return"unknown"}}function Wn(t){let e=t||zn();return["dev","main","master"].includes(e)}function Ga(t){let e=t||g();try{return R("git rev-parse --show-toplevel",{cwd:e,encoding:"utf8",timeout:5e3,stdio:["pipe","pipe","pipe"]}).trim()}catch{return e}}function qa(t){let e=t||g();try{return R("git rev-parse --git-dir",{cwd:e,encoding:"utf8",timeout:5e3,stdio:["pipe","pipe","pipe"]}),!0}catch{return!1}}function Jn(t){let e=t||g();try{return R("git status --short",{cwd:e,encoding:"utf8",timeout:1e4,stdio:["pipe","pipe","pipe"]}).trim()}catch{return""}}function Za(t){return Jn(t).length>0}function Ka(t){let e=t||g();try{return R("git rev-parse --verify main",{cwd:e,encoding:"utf8",timeout:5e3,stdio:["pipe","pipe","pipe"]}),"main"}catch{try{return R("git rev-parse --verify master",{cwd:e,encoding:"utf8",timeout:5e3,stdio:["pipe","pipe","pipe"]}),"master"}catch{return"main"}}}function Gn(t){let e=[/issue\/(\d+)/i,/feature\/(\d+)/i,/fix\/(\d+)/i,/bug\/(\d+)/i,/feat\/(\d+)/i,/^(\d+)-/,/-(\d+)$/,/#(\d+)/];for(let n of e){let r=t.match(n);if(r)return parseInt(r[1],10)}return null}function qn(t){let e=t||g();try{let n=R("git diff --cached --name-only",{cwd:e,encoding:"utf8",timeout:1e4,stdio:["pipe","pipe","pipe"]}).trim();return n?n.split(`
`).filter(r=>r.trim()):[]}catch{return[]}}function Va(t){let e=qn(t),n=new Set,r=new Set,s=!1,o=!1,i=!1,u=!1;for(let a of e){let d=a.split("/");d.length>1&&(n.add(d[0]),d.length>2&&n.add(`${d[0]}/${d[1]}`));let f=a.split(".").pop()||"";r.add(f),/\.(test|spec)\.\w+$/.test(a)||/^tests?\//.test(a)||/__tests__\//.test(a)?s=!0:/\.(md|mdx|txt|rst)$/.test(a)||/^docs?\//.test(a)||a==="README.md"?i=!0:/\.(json|ya?ml|toml|ini|cfg|env)$/.test(a)||/config/i.test(a)||a==="package.json"||a==="tsconfig.json"?o=!0:u=!0}return{files:e,directories:n,extensions:r,hasTests:s,hasConfig:o,hasDocs:i,hasSource:u}}function Xa(t){if(Wn(t))return null;let e=["issue/","feature/","fix/","bug/","feat/","chore/","docs/","refactor/","test/","ci/","perf/","style/","release/","hotfix/"];return e.some(r=>t.startsWith(r))?t.startsWith("issue/")&&!Gn(t)?"issue/ branches should include an issue number (e.g., issue/123-description)":null:`Branch name should start with a valid prefix: ${e.join(", ")}`}import{existsSync as Ut,mkdirSync as Zn,statSync as Kn,renameSync as Vn}from"node:fs";var Bt=At();function L(t){let e=t.tool_name||"";if(["Read","Glob","Grep"].includes(e))try{let{readFileSync:s,writeFileSync:o}=w("node:fs"),i=0;try{i=parseInt(s(Bt,"utf8").trim(),10)||0}catch{}if(i++,o(Bt,String(i)),i%10!==0)return c()}catch{}let n=process.env.CLAUDE_PROJECT_DIR||".",r=`${n}/.claude/logs/audit.log`;try{let s=`${n}/.claude/logs`;Ut(s)||Zn(s,{recursive:!0}),Xn(r,200*1024);let o=new Date().toISOString().replace("T"," ").slice(0,19),i="";switch(e){case"Bash":{i=(p(t,"tool_input.command")||"").substring(0,100);break}case"Write":case"Edit":{i=p(t,"tool_input.file_path")||"";break}case"Task":{i=p(t,"tool_input.subagent_type")||"";break}}let u=i?`[${o}] ${e} | ${i}
`:`[${o}] ${e}
`;_(r,u)}catch{}return c()}function Xn(t,e){if(Ut(t))try{if(Kn(t).size>e){let r=`${t}.old.${Date.now()}`;Vn(t,r)}}catch{}}import{existsSync as Wt,readFileSync as Yn,writeFileSync as Qn,mkdirSync as tr,statSync as er,renameSync as nr}from"node:fs";import{createHash as rr}from"node:crypto";var zt=/error:|Error:|ERROR|FATAL|exception|failed|denied|not found|does not exist|connection refused|timeout|ENOENT|EACCES|EPERM/i,sr=/^(echo |ls |ls$|pwd|cat |head |tail |wc |date|whoami)/,or=1e3*1024;function ir(t){let e=String(p(t,"tool_output")||t.tool_output||""),n=String(t.tool_error||p(t,"error")||""),r=t.exit_code??0,s=!1,o="",i="";if(r!==0&&r!==void 0&&(s=!0,o="exit_code",i=`Exit code: ${r}`),n&&(s=!0,o=o||"tool_error",i=i||n),zt.test(e)){s=!0,o=o||"output_pattern";let u=e.split(`
`).filter(a=>zt.test(a));i=i||u[0]||""}return{isError:s,errorType:o,errorMessage:i,errorText:n||e}}function ar(t){if(Wt(t))try{er(t).size>or&&nr(t,`${t}.old.${Date.now()}`)}catch{}}function cr(t,e){let n=g(),r=`${n}/.claude/logs/errors.jsonl`,s=Rt();try{tr(`${n}/.claude/logs`,{recursive:!0}),ar(r);let o=rr("md5").update(JSON.stringify(t.tool_input||{})).digest("hex"),i={timestamp:new Date().toISOString(),tool:t.tool_name,session_id:y(),error_type:e.errorType,error_message:e.errorMessage.substring(0,500),input_hash:o,tool_input:t.tool_input,output_preview:e.errorText.substring(0,1e3)};_(r,`${JSON.stringify(i)}
`);try{let u={error_count:0,last_error_tool:"",last_error_time:""};Wt(s)&&(u=JSON.parse(Yn(s,"utf8"))),u.error_count=(u.error_count||0)+1,u.last_error_tool=t.tool_name||"",u.last_error_time=new Date().toISOString(),Qn(s,JSON.stringify(u,null,2))}catch{}l("error-logger",`ERROR: ${t.tool_name} - ${e.errorType}`)}catch{l("error-logger",`ERROR (fallback): ${t.tool_name}`)}}function M(t){if((t.tool_name||"")==="Bash"){let r=p(t,"tool_input.command")||"";if(sr.test(r))return c()}let n=ir(t);return n.isError?(cr(t,n),c()):c()}import{existsSync as lr}from"node:fs";import{execSync as A}from"node:child_process";import{basename as dr}from"node:path";var ur=/^[a-zA-Z0-9._/~=:@-]+$/;function B(t,e="argument"){if(!t||!ur.test(t))throw new Error(`Unsafe shell ${e}: ${JSON.stringify(t)}`);return t}function Jt(t){if(!t||!/^[a-zA-Z0-9_-]+$/.test(t))throw new Error(`Unsafe command name: ${JSON.stringify(t)}`);return t}function Gt(t,e="glob pattern"){if(!t||!/^[a-zA-Z0-9._*-]+$/.test(t))throw new Error(`Unsafe ${e}: ${JSON.stringify(t)}`);return t}function gr(t){switch(t.split(".").pop()?.toLowerCase()){case"py":return"python";case"ts":case"tsx":return"typescript";case"js":case"jsx":return"javascript";case"json":return"json";case"css":case"scss":return"css";default:return null}}function ft(t){try{return Jt(t),A(`which ${t}`,{stdio:"ignore"}),!0}catch{return!1}}function qt(t){let e=t.tool_name||"";if(e!=="Write"&&e!=="Edit")return c();let n=p(t,"tool_input.file_path")||"";if(!n||n.includes("/.claude/")||n.includes("/node_modules/")||n.includes("/.git/")||n.includes("/dist/")||n.endsWith(".lock"))return c();let r=process.env.CLAUDE_PROJECT_DIR||".",s=n.startsWith("/")?n:`${r}/${n}`;if(!lr(s))return c();if(process.env.SKIP_AUTO_LINT==="1")return c();let o=gr(n);if(!o)return c();let i=0,u=!1,a=B(s,"file path");try{switch(o){case"python":if(ft("ruff")){try{let d=A(`timeout 5s ruff check --output-format=concise "${a}" 2>&1`,{encoding:"utf8",stdio:["pipe","pipe","pipe"]});d&&(i=d.split(`
`).filter(Boolean).length,A(`timeout 5s ruff check --fix --unsafe-fixes=false "${a}" 2>/dev/null`,{stdio:"ignore"}),u=!0)}catch{}try{A(`timeout 5s ruff format "${a}" 2>/dev/null`,{stdio:"ignore"})}catch{}}break;case"typescript":case"javascript":if(ft("biome"))try{let d=A(`timeout 5s biome check --write "${a}" 2>&1`,{encoding:"utf8",stdio:["pipe","pipe","pipe"]});d.includes("Fixed")&&(u=!0),d.includes("error")&&(i=(d.match(/error/g)||[]).length)}catch{}break;case"json":case"css":if(ft("biome"))try{A(`timeout 5s biome format --write "${a}" 2>/dev/null`,{stdio:"ignore"}),u=!0}catch{}break}}catch(d){l("auto-lint",`Error: ${d}`)}if(u&&i>0){let d=dr(n);return{continue:!0,systemMessage:`Auto-lint: fixed issues, ${i} remaining in ${d}`}}return c()}function Zt(t){return(t.tool_name||"")==="mcp__memory__create_entities"?(l("memory-bridge","mcp__memory__create_entities - graph is primary, no sync needed"),c()):c()}import{existsSync as Qt,readFileSync as te,writeFileSync as ee,mkdirSync as pr}from"node:fs";var fr=/decided|chose|architecture|security|blocked|breaking|critical|deprecated|removed|migration/i,mr=/pattern|convention|preference|style|format|naming/i,yr=60,hr=85,_r=90;function kr(){let t=parseInt(process.env.CLAUDE_CONTEXT_USED_PERCENTAGE||"0",10);if(t===0){let e=parseInt(process.env.CLAUDE_CONTEXT_TOKENS_USED||"0",10),n=parseInt(process.env.CLAUDE_CONTEXT_MAX_TOKENS||"0",10);if(n>0)return Math.floor(e*100/n)}return t}function Sr(t){return fr.test(t)?"IMMEDIATE":mr.test(t)?"BATCHED":"SESSION_END"}function Kt(t){let e=/\b(decided|chose|selected|will use|must|cannot|blocked|breaking)\b/i,n=/\b(architecture|security|migration|deprecated)\b/i,r=t.split(".");for(let o of[e,n])for(let i of r)if(o.test(i))return i.trim().substring(0,300);let s=r.find(o=>o.trim().length>=30);return s?`${s.trim().substring(0,200)}.`:t.substring(0,300).trim()}function Vt(t){let e=t.toLowerCase();return/security|auth|jwt|oauth|cors|xss/.test(e)?"security":/architecture|design|structure|system/.test(e)?"architecture":/database|schema|migration|postgres|sql/.test(e)?"database":/blocked|issue|bug|problem|cannot/.test(e)?"blocker":/breaking|deprecated|removed|migration/.test(e)?"breaking-change":/api|endpoint|route|rest/.test(e)?"api":/decided|chose|selected/.test(e)?"decision":"general"}function br(t){if(!Qt(t))try{pr(w("node:path").dirname(t),{recursive:!0}),ee(t,JSON.stringify({pending:[],created_at:new Date().toISOString()}))}catch{}}function Xt(t,e,n){br(n);try{let r=JSON.parse(te(n,"utf8"));r.pending.push({content:t,category:e,queued_at:new Date().toISOString()}),ee(n,JSON.stringify(r,null,2)),l("realtime-sync",`Added to pending queue: category=${e}, length=${t.length}`)}catch{}}function Yt(t){if(!Qt(t))return 0;try{return JSON.parse(te(t,"utf8")).pending?.length||0}catch{return 0}}function U(t){let e=t.tool_name||"";if(!["Bash","Write","Edit","Skill","Task"].includes(e))return c();let n="";switch(e){case"Bash":{n=String(p(t,"tool_output")||t.tool_output||"");let a=p(t,"tool_input.command")||"";a&&(n=`${a}
${n}`);break}case"Write":case"Edit":{let a=p(t,"tool_input.new_string")||p(t,"tool_input.content")||"",d=p(t,"tool_input.file_path")||"";n=d?`Writing to ${d}: ${a}`:a;break}case"Skill":case"Task":{n=String(p(t,"tool_result")||t.tool_output||"");break}}if(!n||n.length<yr)return c();let r=Sr(n);l("realtime-sync",`Tool: ${e}, Priority: ${r}, Content length: ${n.length}`);let s=kr(),o=g(),i=y(),u=`${o}/.claude/logs/.pending-sync-${i}.json`;if(r==="BATCHED"&&s>=hr&&(r="IMMEDIATE",l("realtime-sync",`EMERGENCY: Context at ${s}%, upgrading BATCHED to IMMEDIATE`)),s>=_r){let a=Yt(u);a>0&&l("realtime-sync",`CRITICAL: Context at ${s}%, ${a} pending items need sync. File: ${u}`)}switch(r){case"IMMEDIATE":{let a=Kt(n);if(!a||a.length<20)return l("realtime-sync","Could not extract meaningful decision"),c();let d=Vt(a);return Xt(a,d,u),l("realtime-sync",`IMMEDIATE decision queued: category=${d}, decision="${a.substring(0,100)}"`),c()}case"BATCHED":{let a=Kt(n);if(a&&a.length>=20){let d=Vt(a);Xt(a,d,u);let f=Yt(u);l("realtime-sync",`BATCHED queued: ${f} items, latest="${a.substring(0,100)}" (${d})`)}return c()}default:return c()}}import{existsSync as ae,mkdirSync as Pr,readFileSync as Or,writeFileSync as Dr}from"node:fs";import{existsSync as xr,readFileSync as Cr,writeFileSync as Cc,mkdirSync as Ec}from"node:fs";import{execSync as ne}from"node:child_process";import{createHash as Er}from"node:crypto";import*as re from"node:os";var vr=".claude/.user_identity.json",wr="orchestkit-user-identity-v1";var x=null;function z(t){return Er("sha256").update(t+wr).digest("hex").slice(0,32)}function Tr(){try{return re.hostname()}catch{return"unknown-machine"}}function Ir(t){let e=`${t}/${vr}`;if(!xr(e))return null;try{let n=Cr(e,"utf8");return JSON.parse(n)}catch(n){return l("user-identity",`Failed to read user config: ${n}`,"warn"),null}}function $r(t){let e={};try{e.email=ne("git config user.email",{cwd:t,encoding:"utf8",timeout:2e3,stdio:["pipe","pipe","pipe"]}).trim()}catch{}try{e.name=ne("git config user.name",{cwd:t,encoding:"utf8",timeout:2e3,stdio:["pipe","pipe","pipe"]}).trim()}catch{}return e}function Rr(){return{username:process.env.USER||process.env.USERNAME||process.env.LOGNAME}}function Ar(t){if(x)return x;let e=t||g(),n=Tr(),r=Ir(e);if(r?.user_id)return x={user_id:r.user_id,display_name:r.display_name||r.user_id,team_id:r.team_id,machine_id:n,source:"config",anonymous_id:z(r.user_id),email:r.user_id.includes("@")?r.user_id:void 0},l("user-identity",`Resolved from config: ${x.anonymous_id}`,"debug"),x;let s=$r(e);if(s.email)return x={user_id:s.email,display_name:s.name||s.email.split("@")[0],team_id:r?.team_id,machine_id:n,source:"git",anonymous_id:z(s.email),email:s.email},l("user-identity",`Resolved from git: ${x.anonymous_id}`,"debug"),x;let o=Rr();if(o.username){let u=`${o.username}@${n}`;return x={user_id:u,display_name:o.username,team_id:r?.team_id,machine_id:n,source:"env",anonymous_id:z(u)},l("user-identity",`Resolved from env: ${x.anonymous_id}`,"debug"),x}let i=z(n+process.pid);return x={user_id:`anon-${i.slice(0,8)}`,display_name:"Anonymous",team_id:r?.team_id,machine_id:n,source:"anonymous",anonymous_id:i},l("user-identity",`Resolved as anonymous: ${x.anonymous_id}`,"debug"),x}function se(){let t=Ar();return{session_id:y(),user_id:t.user_id,anonymous_id:t.anonymous_id,team_id:t.team_id,machine_id:t.machine_id,identity_source:t.source,timestamp:new Date().toISOString()}}var jr=/^[a-zA-Z0-9_-]{1,128}$/;function Hr(t){return jr.test(t)}function ht(t,e){let n=t||y(),r=e||g();if(!Hr(n))throw new Error("Invalid session ID format");return`${r}/.claude/memory/sessions/${n}`}function Nr(t,e){return`${ht(t,e)}/events.jsonl`}function ce(t,e){let n=ht(t,e);ae(n)||Pr(n,{recursive:!0})}var P=0,oe=!1,mt=!1,ie=0,Fr=5e3;function ue(t,e){return`${ht(t,e)}/counter.json`}function Lr(t,e){if(!oe){oe=!0;try{let n=ue(t,e);if(ae(n)){let r=JSON.parse(Or(n,"utf8"));typeof r.counter=="number"&&r.counter>0&&(P=r.counter,l("session-tracker",`Loaded event counter: ${P}`,"debug"))}}catch{}}}function Mr(t,e){if(!mt)return;let n=Date.now();if(!(n-ie<Fr))try{ce(t,e);let r=ue(t,e);Dr(r,JSON.stringify({counter:P,updated_at:new Date().toISOString()})),mt=!1,ie=n}catch{}}function Br(){return Lr(),P++,mt=!0,Mr(),`evt-${Date.now()}-${P}`}function W(t,e,n={}){try{let r={event_id:Br(),event_type:t,identity:se(),payload:{name:e,input:yt(n.input),output:yt(n.output),duration_ms:n.duration_ms,success:n.success??!0,context:n.context?_t(n.context,500):void 0,confidence:n.confidence}};ce();let s=Nr();_(s,`${JSON.stringify(r)}
`),l("session-tracker",`Tracked ${t}: ${e}`,"debug")}catch(r){l("session-tracker",`Failed to track event: ${r}`,"warn")}}function le(t,e,n=!0,r){W("skill_invoked",t,{input:e?{args:e}:void 0,success:n,duration_ms:r})}function de(t,e,n=!0){W("agent_spawned",t,{input:e?{prompt:_t(e,200)}:void 0,success:n})}function ge(t,e,n){W("solution_found","solution",{context:t,input:e?{problem_id:e}:void 0,confidence:n,success:!0})}function pe(t,e=!0,n,r){W("tool_used",t,{success:e,duration_ms:n,input:r?{category:r}:void 0})}function _t(t,e){return t.length<=e?t:`${t.slice(0,e-3)}...`}function yt(t){if(!t)return;let e={},n=["password","secret","token","key","credential","auth"];for(let[r,s]of Object.entries(t)){if(n.some(o=>r.toLowerCase().includes(o))){e[r]="[REDACTED]";continue}if(typeof s=="string"&&s.length>500){e[r]=_t(s,500);continue}if(typeof s=="object"&&s!==null&&!Array.isArray(s)){e[r]=yt(s);continue}e[r]=s}return e}var Ur={Grep:"search",Glob:"search",WebSearch:"web",Read:"file_read",Write:"file_write",Edit:"file_edit",MultiEdit:"file_edit",NotebookEdit:"file_edit",Bash:"execution",Task:"agent",Skill:"skill",WebFetch:"web",AskUserQuestion:"interaction",TaskCreate:"task_mgmt",TaskUpdate:"task_mgmt",TaskList:"task_mgmt",TaskGet:"task_mgmt",TaskOutput:"task_mgmt",TaskStop:"task_mgmt",EnterPlanMode:"interaction",ExitPlanMode:"interaction"};function fe(t){return Ur[t]||"other"}import{existsSync as ye,readFileSync as zr,writeFileSync as Wr,mkdirSync as Jr}from"node:fs";import{join as Gr,dirname as qr,basename as kt}from"node:path";var Zr=[/\b(pytest|jest|vitest|npm\s+test|yarn\s+test|bun\s+test|go\s+test)\b/i,/\b(test|tests|spec)\b.*\b(run|execute)\b/i],Kr=[/\b(npm\s+run\s+build|yarn\s+build|make|cargo\s+build|docker\s+build|tsc)\b/i,/\b(build|compile)\b/i],Vr=[/\bgit\s+(commit|push|pull|merge|rebase|checkout|branch|status|diff|log)\b/i,/\bgh\s+(pr|issue)\b/i];function he(t){return Gr(g(),".claude","memory","flows",`${t}.json`)}function Xr(t){let e=he(t);if(!ye(e))return null;try{let n=zr(e,"utf-8");return JSON.parse(n)}catch(n){return l("decision-flow-tracker",`Failed to load flow for ${t}: ${n}`,"warn"),null}}function Yr(t){let e=he(t.session_id);try{let n=qr(e);return ye(n)||Jr(n,{recursive:!0}),Wr(e,JSON.stringify(t,null,2)),!0}catch(n){return l("decision-flow-tracker",`Failed to save flow: ${n}`,"warn"),!1}}function Qr(t,e,n){return t==="Read"||t==="Glob"||t==="Grep"?"exploration":t==="Write"||t==="Edit"||t==="MultiEdit"||t==="NotebookEdit"?"modification":t==="Task"?"agent":t==="Bash"&&e?Zr.some(r=>r.test(e))?"testing":Kr.some(r=>r.test(e))?"building":Vr.some(r=>r.test(e))?"git":"execution":"other"}function ts(t,e,n,r){let s=r==="success"?"\u2713":r==="failure"?"\u2717":"~";if(t==="Read")return`${s} Read ${kt(n??"")||"file"}`;if(t==="Write")return`${s} Write ${kt(n??"")||"file"}`;if(t==="Edit")return`${s} Edit ${kt(n??"")||"file"}`;if(t==="Glob")return`${s} Search files`;if(t==="Grep")return`${s} Search content`;if(t==="Task")return`${s} Spawn agent`;if(t==="Bash"&&e){let o=e.split(`
`)[0].slice(0,50);return`${s} ${o}${e.length>50?"...":""}`}return`${s} ${t}`}function es(t){if(t.length<3)return"mixed";let e={exploration:0,modification:0,testing:0,building:0,agent:0,execution:0,git:0,other:0};for(let n of t)e[n.category]++;if(e.testing>=2){let n=t.map((s,o)=>s.category==="testing"?o:-1).filter(s=>s>=0),r=t.map((s,o)=>s.category==="modification"?o:-1).filter(s=>s>=0);if(n.length>=2&&r.length>0&&n[0]<r[0])return"test-first"}if(e.exploration>=3&&e.modification>0&&ns(t,"exploration")>=3)return"explore-first";if(e.modification>=2&&e.execution+e.testing>=2&&rs(t,"modification",["execution","testing"])>=2)return"iterate-fast";if(e.agent>=3||e.agent/t.length>.3)return"agent-delegate";if(e.modification>=3&&e.testing===1){let n=t.map((r,s)=>r.category==="testing"?s:-1).filter(r=>r>=0).pop();if(n&&n>t.length-3)return"big-bang"}return"mixed"}function ns(t,e){let n=0,r=0;for(let s of t)s.category===e?(r++,n=Math.max(n,r)):r=0;return n}function rs(t,e,n){let r=0,s=!1;for(let o of t){let i=o.category===e,u=n.includes(o.category);i&&!s?s=!0:u&&s&&(r++,s=!1)}return r}function me(t){let e=t.filter(n=>n.result==="success").length;return{total_actions:t.length,reads:t.filter(n=>n.category==="exploration").length,writes:t.filter(n=>n.category==="modification").length,tests:t.filter(n=>n.category==="testing").length,builds:t.filter(n=>n.category==="building").length,agent_spawns:t.filter(n=>n.category==="agent").length,success_rate:t.length>0?e/t.length:0}}function _e(t,e,n,r,s){let o=new Date().toISOString(),i="success";s!==void 0&&(i=s===0?"success":"failure");let u=Qr(e,n,r),a=ts(e,n,r,i),d={tool:e,file:r,timestamp:o,summary:a,result:i,exit_code:s,category:u},f=Xr(t);return f||(f={session_id:t,actions:[],started_at:o,last_action_at:o,stats:me([])}),f.actions.push(d),f.actions.length>100&&(f.actions=f.actions.slice(-100)),f.last_action_at=o,f.inferred_pattern=es(f.actions),f.stats=me(f.actions),Yr(f),f}function ss(t){let e=t.tool_input;if(!e||typeof e!="object")return;let n=e.skill;if(typeof n=="string")return n}function os(t){let e=t.tool_input;if(!e||typeof e!="object")return;let n=e.subagent_type;if(typeof n=="string")return n}function is(t){let e=t.tool_input;if(!e||typeof e!="object")return;let n=e.prompt;if(typeof n=="string")return n.length>200?`${n.slice(0,200)}...`:n}function as(t){let e=t.tool_input;if(!e||typeof e!="object")return;let n=e.command;if(typeof n=="string")return n}function cs(t){let e=t.tool_input;if(!e||typeof e!="object")return;let n=e.file_path;if(typeof n=="string")return n}function us(t){return!t.tool_error}function J(t){try{let e=t.tool_name||"unknown",n=us(t),r=fe(e),s=t.session_id||y();pe(e,n,void 0,r);let o=as(t),i=cs(t);if(_e(s,e,o,i,n?0:1),e==="Skill"){let a=ss(t);a&&(le(a,void 0,n),l("user-tracking",`Tracked skill: ${a}`,"debug"))}if(e==="Task"){let a=os(t);if(a){let d=is(t);de(a,d,n),l("user-tracking",`Tracked agent: ${a}`,"debug")}}return c()}catch(e){return l("user-tracking",`Error: ${e}`,"warn"),c()}}import{existsSync as ls,readFileSync as ds,writeFileSync as gs}from"node:fs";var G=$t(),Zc=`${G}.lock`;function q(t){let e=t.tool_name||"";if(!e)return c();try{let n={tools:{},errors:0,warnings:0};if(ls(G))try{let s=ds(G,"utf8").trim();s&&(n=JSON.parse(s))}catch{n={tools:{},errors:0,warnings:0}}n.tools||(n.tools={});let r=n.tools[e]||0;n.tools[e]=r+1,gs(G,JSON.stringify(n,null,2))}catch(n){l("session-metrics",`Error updating metrics: ${n}`)}return c()}import{existsSync as ps,readFileSync as fs,mkdirSync as ms}from"node:fs";var ys=[{name:"add_pagination",test:t=>E(t,"limit","offset")||E(t,"page","size")||E(t,"cursor","pagination")||/paginate|Paginated/i.test(t)},{name:"add_rate_limiting",test:t=>/rate.?limit|throttl|RateLimiter|requests.?per/i.test(t)},{name:"add_caching",test:t=>/[@]cache|cache_key|TTL|redis|memcache|[@]cached/i.test(t)},{name:"add_retry_logic",test:t=>/retry|backoff|max_attempts|tenacity|Retry/i.test(t)},{name:"add_error_handling",test:t=>E(t,"try","catch")||/except/i.test(t)||E(t,"raise","Exception")||E(t,"throw","Error")||E(t,"error","handler")},{name:"add_validation",test:t=>/validate|Validator|[@]validate|Pydantic|Zod|yup|schema/i.test(t)},{name:"add_logging",test:t=>/logger[.]|logging[.]|console[.]log|winston|pino|structlog/i.test(t)},{name:"add_types",test:t=>/: *(str|int|bool|List|Dict|Optional)|interface |type .*=/i.test(t)},{name:"add_type_guards",test:t=>/isinstance|typeof/i.test(t)||E(t,"is","Type")||E(t,"assert","type")},{name:"add_docstring",test:t=>/docstring|"""[^"]+"""|\/\*\*/i.test(t)},{name:"remove_comments",test:t=>t.split(`
`).some(e=>/^-.*#|^-.*\/\/|^-.*\*/.test(e))},{name:"add_auth_check",test:t=>/[@]auth|[@]require_auth|isAuthenticated|requiresAuth|[@]login_required/i.test(t)},{name:"add_input_sanitization",test:t=>/escape|sanitize|htmlspecialchars|DOMPurify/i.test(t)},{name:"add_test_case",test:t=>/def test_|it\(|describe\(|expect\(|assert|[@]pytest/i.test(t)},{name:"add_mock",test:t=>/Mock|patch|jest[.]mock|vi[.]mock|MagicMock/i.test(t)},{name:"modify_imports",test:t=>t.split(`
`).some(e=>/^[+-].*import/.test(e)||/^[+-].*require\(/.test(e))},{name:"add_async",test:t=>/async |await |Promise|asyncio|async def/i.test(t)}];function hs(t){if(!ps(t))return"";try{let e=JSON.parse(fs(t,"utf8")),r=Math.floor(Date.now()/1e3)-300;return(e.recentSkills||[]).filter(o=>o.timestamp>r).sort((o,i)=>i.timestamp-o.timestamp)[0]?.skillId||""}catch{return""}}function _s(t){let e=[];for(let{name:n,test:r}of ys)r(t)&&e.push(n);return e}function ks(t,e,n,r){let s=y(),i={timestamp:new Date().toISOString(),skill_id:t,file_path:e,session_id:s,patterns:n};try{ms(w("node:path").dirname(r),{recursive:!0}),_(r,`${JSON.stringify(i)}
`)}catch{}}function Z(t){let e=t.tool_name||"";if(e!=="Write"&&e!=="Edit")return c();let n=p(t,"tool_input.file_path")||"";if(!n)return c();let r=g(),s=`${r}/.claude/context/session/state.json`,o=hs(s);if(!o)return c();let i="";if(e==="Edit"){let a=p(t,"tool_input.old_string")||"",d=p(t,"tool_input.new_string")||"";if(a&&d){let f=a.split(`
`),h=d.split(`
`);i=f.map(k=>`-${k}`).join(`
`)+`
`+h.map(k=>`+${k}`).join(`
`)}}else i=p(t,"tool_input.content")||"";if(!i)return c();let u=_s(i);if(u.length>0){let a=`${r}/.claude/feedback/edit-patterns.jsonl`;ks(o,n,u,a),process.env.CLAUDE_HOOK_DEBUG&&l("skill-edit-tracker",`Detected ${u.length} patterns for ${o}: ${JSON.stringify(u)}`)}return c()}import{existsSync as xe,readFileSync as Ss,writeFileSync as bs,mkdirSync as xs}from"node:fs";import{createHash as Cs}from"node:crypto";var ke=500;var Se=15,be=3;function Ce(){return`${g()}/.claude/feedback/calibration-data.json`}function Es(){let t=`${g()}/.claude/feedback`;if(!xe(t))try{xs(t,{recursive:!0})}catch{}}function vs(){let t=Ce();if(xe(t))try{return JSON.parse(Ss(t,"utf8"))}catch{l("calibration-engine","Failed to load calibration data, using defaults")}return{schemaVersion:"1.0.0",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),records:[],adjustments:[],stats:{totalDispatches:0,successRate:0,avgConfidence:0,topAgents:[]}}}function ws(t){Es();let e=Ce();t.updatedAt=new Date().toISOString();try{bs(e,JSON.stringify(t,null,2)),l("calibration-engine","Saved calibration data")}catch(n){l("calibration-engine",`Failed to save calibration data: ${n}`)}}function Ts(t){return Cs("sha256").update(t.toLowerCase().trim()).digest("hex").slice(0,16)}function Ee(t,e,n,r,s,o,i){let u=vs(),a={timestamp:new Date().toISOString(),sessionId:y(),agent:e,promptHash:Ts(t),matchedKeywords:n,dispatchConfidence:r,outcome:s,durationMs:o,feedback:i};u.records.push(a),u.records.length>ke&&(u.records=u.records.slice(-ke)),Is(u,a),$s(u),ws(u),l("calibration-engine",`Recorded outcome: ${e} -> ${s} (conf: ${r})`)}function Is(t,e){let n=e.outcome==="success",r=e.outcome==="failure"||e.outcome==="rejected";if(!n&&!r)return;let s=n?be:-be;for(let o of e.matchedKeywords){let i=t.adjustments.find(u=>u.keyword===o&&u.agent===e.agent);i?(i.adjustment=Math.max(-Se,Math.min(Se,i.adjustment+s)),i.sampleCount++,i.lastUpdated=new Date().toISOString()):t.adjustments.push({keyword:o,agent:e.agent,adjustment:s,sampleCount:1,lastUpdated:new Date().toISOString()})}}function $s(t){let e=t.records;if(e.length===0)return;t.stats.totalDispatches=e.length;let n=e.filter(o=>o.outcome==="success").length;t.stats.successRate=n/e.length;let r=e.reduce((o,i)=>o+i.dispatchConfidence,0)/e.length;t.stats.avgConfidence=Math.round(r);let s=new Map;for(let o of e){let i=s.get(o.agent)||{count:0,success:0};i.count++,o.outcome==="success"&&i.success++,s.set(o.agent,i)}t.stats.topAgents=Array.from(s.entries()).map(([o,i])=>({agent:o,count:i.count,successRate:i.success/i.count})).sort((o,i)=>i.count-o.count).slice(0,10)}import{existsSync as Rs,readFileSync as As,writeFileSync as ou,mkdirSync as iu}from"node:fs";function Ps(){let t=y();return`${g()}/.claude/orchestration/task-registry-${t}.json`}function Os(){let t=Ps();if(Rs(t))try{return JSON.parse(As(t,"utf8"))}catch{}return{schemaVersion:"1.0.0",sessionId:y(),tasks:[],pipelines:[],updatedAt:new Date().toISOString()}}function ve(t){return Os().tasks.find(n=>n.taskId===t)}import{existsSync as Te,readFileSync as Ie,writeFileSync as lu,mkdirSync as du}from"node:fs";function Ds(){return`${g()}/.claude/orchestration`}function js(){let t=y();return`${Ds()}/session-${t}.json`}function Hs(){return`${g()}/.claude/orchestration/config.json`}function Ns(){let t=js();if(Te(t))try{let e=Ie(t,"utf8");return JSON.parse(e)}catch(e){l("orchestration-state",`Failed to load state: ${e}`)}return{sessionId:y(),activeAgents:[],injectedSkills:[],promptHistory:[],maxHistorySize:10,updatedAt:new Date().toISOString()}}function $e(){return Ns().lastClassification}var we={enableAutoDispatch:!0,enableSkillInjection:!0,maxSkillInjectionTokens:1200,enableCalibration:!0,enablePipelines:!0,maxRetries:3,retryDelayBaseMs:1e3};function Re(){let t=Hs();if(Te(t))try{let e=Ie(t,"utf8");return{...we,...JSON.parse(e)}}catch{}return we}function Fs(t){let e=t.tool_input||{};return typeof e.taskId=="string"?e.taskId:null}function Ls(t){return t.tool_name!=="TaskUpdate"?!1:typeof(t.tool_input||{}).status=="string"}function Ms(t){switch(t){case"completed":return"success";case"pending":return null;default:return null}}function K(t){if(!Ls(t))return c();if(!Re().enableCalibration)return c();let n=t.tool_input||{},r=Fs(t),s=n.status;if(!r)return c();let o=Ms(s);if(!o)return c();l("calibration-tracker",`Tracking task ${r} status update to ${s}`);let i=ve(r);if(!i)return l("calibration-tracker",`Task ${r} not found in registry`),c();let u=i.agent;if(!u)return l("calibration-tracker",`No agent associated with task ${r}`),c();let d=$e()?.agents.find(v=>v.agent===u),f=d?.matchedKeywords||[],h=i.confidence||d?.confidence||0,k=i.createdAt?Date.now()-new Date(i.createdAt).getTime():void 0;return Ee("",u,f,h,o,k),l("calibration-tracker",`Recorded calibration: ${u} -> ${o} (conf: ${h})`),c()}import{mkdirSync as Bs,statSync as Us,renameSync as zs}from"node:fs";import{createHash as Ws}from"node:crypto";function Js(){return gt(lt(),".claude","analytics")}function O(t){return Ws("sha256").update(t).digest("hex").slice(0,12)}function St(){let t=process.env.CLAUDE_CODE_TEAM_NAME;return t?{team:t}:void 0}function Gs(t,e=10485760){try{if(Us(t).size>e){let r=new Date().toISOString().slice(0,7),s=t.replace(/\.jsonl$/,`.${r}.jsonl`);zs(t,s)}}catch{}}function qs(){return!!(process.env.VITEST||process.env.JEST_WORKER_ID)}function D(t,e){if(!qs())try{let n=Js();Bs(n,{recursive:!0});let r=gt(n,t);Gs(r),_(r,`${JSON.stringify(e)}
`)}catch{}}import{existsSync as Zs,readFileSync as Ks,writeFileSync as Ae,mkdirSync as Vs}from"node:fs";import{basename as Xs}from"node:path";var Ys={JWT:/jwt|jsonwebtoken/i,OAuth2:/oauth|oauth2/i,PostgreSQL:/postgres|postgresql|psql/i,Redis:/redis/i,React:/react/i,FastAPI:/fastapi/i,SQLAlchemy:/sqlalchemy/i,Alembic:/alembic/i,"cursor-pagination":/cursor.based|keyset/i,"offset-pagination":/offset.pagination/i,WebSocket:/websocket/i,SSE:/sse|server.sent/i,GraphQL:/graphql/i,REST:/rest.api|restful/i},Qs={feature:/^feat:|^feature:/i,bugfix:/^fix:|^bugfix:/i,refactor:/^refactor:/i,optimization:/^perf:|^performance:/i,security:/^security:|^sec:/i,testing:/^test:|^tests:/i},to={pagination:/cursor|pagination|offset|limit|page/i,caching:/cache|redis|memcache|ttl/i,authentication:/auth|jwt|oauth|token|login/i,validation:/validate|validation|schema|pydantic|zod/i,testing:/test|spec|coverage|mock/i,security:/security|encrypt|hash|secret|credential/i,performance:/performance|optimize|cache|index/i,error_handling:/error|exception|retry|fallback/i};function eo(){let t=g();return Xs(t)||"unknown"}function no(t){let e=t.toLowerCase(),n="unknown",r="general";for(let[s,o]of Object.entries(Ys))if(o.test(e)){n=s;break}for(let[s,o]of Object.entries(Qs))if(o.test(t)){r=s;break}return{tech:n,pattern:r}}function ro(t){for(let[e,n]of Object.entries(to))if(n.test(t))return e;return"general"}function V(t,e,n,r,s){let o=new Date().toISOString(),i=eo();if(!Zs(s))try{Vs(w("node:path").dirname(s),{recursive:!0}),Ae(s,JSON.stringify({patterns:[]}))}catch{return}try{let u=JSON.parse(Ks(s,"utf8"));u.patterns.push({text:t,category:e,outcome:n,source:r,timestamp:o,project:i}),Ae(s,JSON.stringify(u,null,2)),l("pattern-extractor",`Queued pattern: category=${e} outcome=${n} source=${r}`)}catch{}}function so(t,e,n){let r="",s=t.match(/-m\s+["']([^"']+)["']/)||t.match(/-m\s+([^\s]+)/);if(s&&(r=s[1]),!r)return;let{tech:o,pattern:i}=no(r),u=ro(r),a=e===0?"success":"failed",d=r;o!=="unknown"&&(d=`[${o}] ${r}`),V(d,u,a,"commit",n)}function oo(t,e,n){if(e!==0)return;let r="PR merged successfully",s=t.match(/gh\s+pr\s+merge\s+(\d+)/);s&&(r=`PR #${s[1]} merged`),V(r,"decision","success","pr-merge",n)}function io(t,e,n){let r="unknown";/pytest|py\.test/.test(t)?r="pytest":/jest/.test(t)?r="jest":/vitest/.test(t)?r="vitest":/npm\s+test|yarn\s+test|bun\s+test/.test(t)?r="npm-test":/go\s+test/.test(t)&&(r="go-test");let s=e===0?"success":"failed",o=`Tests ${s==="success"?"passed":"failed"} (${r})`;V(o,"testing",s,"test-run",n)}function ao(t,e,n){let r="unknown";/npm\s+run\s+build/.test(t)?r="npm":/yarn\s+build/.test(t)?r="yarn":/cargo\s+build/.test(t)?r="cargo":/make/.test(t)?r="make":/docker\s+build/.test(t)&&(r="docker");let s=e===0?"success":"failed",o=`Build ${s==="success"?"succeeded":"failed"} (${r})`;V(o,"build",s,"build",n)}function X(t){if((t.tool_name||"")!=="Bash")return c();let n=p(t,"tool_input.command")||"",r=t.exit_code??0;if(!n)return c();let s=n.toLowerCase(),i=`${g()}/.claude/feedback/patterns-queue.json`;return/git\s+commit/.test(s)?so(n,r,i):/gh\s+pr\s+merge/.test(s)?oo(n,r,i):/pytest|jest|vitest|npm\s+test|yarn\s+test|bun\s+test|go\s+test/.test(s)?io(n,r,i):/npm\s+run\s+build|yarn\s+build|cargo\s+build|make|docker\s+build/.test(s)&&ao(n,r,i),c()}import{existsSync as Oe,readFileSync as De,writeFileSync as co,mkdirSync as uo}from"node:fs";var lo=["py","ts","tsx","js","jsx","go","rs","java"];function go(t){switch(t.split(".").pop()?.toLowerCase()){case"py":return"python";case"ts":case"tsx":return"typescript";case"js":case"jsx":return"javascript";case"go":return"go";case"rs":return"rust";case"java":return"java";default:return null}}function po(t){let e=0,n=0,r=0;for(let s of t.split(`
`))s.startsWith("	")?e++:s.startsWith("    ")?r++:s.match(/^ {2}[^ ]/)&&n++;return e>n+r?{style:"tabs",size:1}:n>r?{style:"spaces",size:2}:r>0?{style:"spaces",size:4}:{style:"unknown",size:4}}function fo(t){let e=(t.match(/'/g)||[]).length,n=(t.match(/"/g)||[]).length;return e>n?"single":"double"}function mo(t){let e=0,n=0;for(let r of t.split(`
`)){let s=r.trim();!s||s.startsWith("//")||s.startsWith("*")||(/;\s*$/.test(r)?e++:/[a-zA-Z0-9)\]'"]\\s*$/.test(r)&&n++)}return e>n?"always":"omit"}function Pe(t){return(t.match(/,\s*$/gm)||[]).length>5?"always":"minimal"}function yo(t){let e=/\) -> |: [A-Z][a-zA-Z]+(\[|$| =)/.test(t),n="unknown";return/"""[^"]+"""/.test(t)&&(/:param |:returns:|:raises:/.test(t)?n="sphinx":/Args:|Returns:|Raises:/.test(t)?n="google":/Parameters|Returns\n-+/.test(t)?n="numpy":n="simple"),{typeHints:e,docstringStyle:n}}function ho(t){if(Oe(t))try{return JSON.parse(De(t,"utf8"))}catch{}return{version:"1.0.0",last_updated:null,samples_count:0,languages:{},global_preferences:{indentation:{style:"unknown",size:4,confidence:0},quotes:{style:"unknown",confidence:0}}}}function _o(t,e,n,r,s,o,i,u){t.last_updated=new Date().toISOString(),t.samples_count++,t.languages[e]||(t.languages[e]={samples:0,indentation:{tabs:0,spaces_2:0,spaces_4:0},quotes:{single:0,double:0},semicolons:{always:0,omit:0},trailing_comma:{always:0,minimal:0},type_hints:{used:0,not_used:0},docstring_style:{}});let a=t.languages[e];a.samples++,n.style==="tabs"?a.indentation.tabs++:n.size===2?a.indentation.spaces_2++:a.indentation.spaces_4++,r==="single"?a.quotes.single++:a.quotes.double++,s!=="unknown"&&(s==="always"?a.semicolons.always++:a.semicolons.omit++),o!=="unknown"&&(o==="always"?a.trailing_comma.always++:a.trailing_comma.minimal++),i!==null&&(i?a.type_hints.used++:a.type_hints.not_used++),u!=="unknown"&&(a.docstring_style[u]=(a.docstring_style[u]||0)+1)}function Y(t){let e=t.tool_name||"";if(e!=="Write"&&e!=="Edit")return c();let n=p(t,"tool_input.file_path")||"";if(!n||n.includes("/.claude/")||n.includes("/node_modules/")||n.includes("/.git/")||n.includes("/dist/")||n.endsWith(".lock"))return c();let r=n.split(".").pop()?.toLowerCase()||"";if(!lo.includes(r))return c();let s=go(n);if(!s)return c();let o=p(t,"tool_input.content")||"";if(!o){let m=g(),S=n.startsWith("/")?n:`${m}/${n}`;if(Oe(S))try{o=De(S,"utf8").split(`
`).slice(0,100).join(`
`)}catch{return c()}}if(!o)return c();let i=po(o),u=fo(o),a="unknown",d="unknown",f=null,h="unknown";switch(s){case"javascript":case"typescript":a=mo(o),d=Pe(o);break;case"python":{let m=yo(o);f=m.typeHints,h=m.docstringStyle,d=Pe(o);break}}let k=g(),v=`${k}/.claude/feedback/code-style-profile.json`;try{uo(`${k}/.claude/feedback`,{recursive:!0});let m=ho(v);_o(m,s,i,u,a,d,f,h),co(v,JSON.stringify(m,null,2))}catch(m){l("code-style-learner",`Error updating profile: ${m}`)}return l("code-style-learner",`Analyzed ${s} file: indent=${i.style}(${i.size}) quotes=${u}`),c()}import{basename as ko}from"node:path";import{existsSync as je,readFileSync as He,writeFileSync as So,mkdirSync as bo}from"node:fs";var xo=["py","ts","tsx","js","jsx","go","rs","java"];function Co(t){return t.length<2||/^[_0-9]+$/.test(t)?"unknown":/^[A-Z][A-Z0-9_]*$/.test(t)?"SCREAMING_SNAKE_CASE":/^[A-Z][a-zA-Z0-9]*$/.test(t)?"PascalCase":/^[a-z][a-zA-Z0-9]*$/.test(t)&&!t.includes("_")?"camelCase":/^[a-z][a-z0-9_]*$/.test(t)?"snake_case":/^_[a-z][a-z0-9_]*$/.test(t)?"private_snake_case":/^__[a-z][a-z0-9_]*__$/.test(t)?"dunder":"mixed"}function Eo(t){let e=(t.match(/def ([a-zA-Z_][a-zA-Z0-9_]*)/g)||[]).map(o=>o.replace("def ","")),n=(t.match(/class ([A-Za-z_][a-zA-Z0-9_]*)/g)||[]).map(o=>o.replace("class ","")),r=t.split(`
`).filter(o=>{let i=o.trim();return/^[a-zA-Z_]\w*/.test(i)&&i.includes("=")}).map(o=>o.trim().split("=")[0].trim()),s=t.split(`
`).filter(o=>{let i=o.trim();return/^[A-Z][A-Z0-9_]*/.test(i)&&i.includes("=")}).map(o=>o.trim().split("=")[0].trim());return{functions:e,classes:n,variables:r,constants:s}}function vo(t){let e=[...(t.match(/(function|async function) ([a-zA-Z_][a-zA-Z0-9_]*)/g)||[]).map(i=>i.replace(/(async )?function /,"")),...t.split(`
`).filter(i=>i.trimStart().startsWith("const ")&&i.includes("= (")).map(i=>{let u=i.trimStart().match(/^const\s+([a-zA-Z_]\w*)/);return u?u[1]:""}).filter(Boolean)],n=(t.match(/class ([A-Za-z_][a-zA-Z0-9_]*)/g)||[]).map(i=>i.replace("class ","")),r=(t.match(/interface ([A-Za-z_][a-zA-Z0-9_]*)/g)||[]).map(i=>i.replace("interface ","")),s=(t.match(/type ([A-Za-z_][a-zA-Z0-9_]*)/g)||[]).map(i=>i.replace("type ","")),o=(t.match(/(const|let|var) ([a-zA-Z_][a-zA-Z0-9_]*)/g)||[]).map(i=>i.replace(/(const|let|var) /,""));return{functions:e,classes:n,variables:o,interfaces:r,types:s}}function C(t){let e={camelCase:0,snake_case:0,PascalCase:0,SCREAMING_SNAKE_CASE:0,private_snake_case:0,dunder:0,mixed:0,unknown:0};for(let n of t){if(!n)continue;let r=Co(n);e[r]++}return e}function wo(t){let n=ko(t).replace(/\.[^.]+$/,"");return/^[a-z][a-z0-9_]*$/.test(n)?"snake_case":/^[a-z][a-z0-9-]*$/.test(n)?"kebab-case":/^[A-Z][a-zA-Z0-9]*$/.test(n)?"PascalCase":/^[a-z][a-zA-Z0-9]*$/.test(n)?"camelCase":"mixed"}function To(t){switch(t.split(".").pop()?.toLowerCase()){case"py":return"python";case"ts":case"tsx":return"typescript";case"js":case"jsx":return"javascript";case"go":return"go";case"rs":return"rust";case"java":return"java";default:return null}}function Io(t){if(je(t))try{return JSON.parse(He(t,"utf8"))}catch{}return{version:"1.0.0",last_updated:null,samples_count:0,languages:{},file_naming:{},detected_patterns:{functions:{},classes:{},variables:{},constants:{},types:{}}}}function $o(){return{samples:0,functions:{camelCase:0,snake_case:0,PascalCase:0,SCREAMING_SNAKE_CASE:0,private_snake_case:0,dunder:0,mixed:0,unknown:0},classes:{camelCase:0,snake_case:0,PascalCase:0,SCREAMING_SNAKE_CASE:0,private_snake_case:0,dunder:0,mixed:0,unknown:0},variables:{camelCase:0,snake_case:0,PascalCase:0,SCREAMING_SNAKE_CASE:0,private_snake_case:0,dunder:0,mixed:0,unknown:0},constants:{camelCase:0,snake_case:0,PascalCase:0,SCREAMING_SNAKE_CASE:0,private_snake_case:0,dunder:0,mixed:0,unknown:0},types:{camelCase:0,snake_case:0,PascalCase:0,SCREAMING_SNAKE_CASE:0,private_snake_case:0,dunder:0,mixed:0,unknown:0}}}function Q(t){let e=t.tool_name||"";if(e!=="Write"&&e!=="Edit")return c();let n=p(t,"tool_input.file_path")||"";if(!n||n.includes("/.claude/")||n.includes("/node_modules/")||n.includes("/.git/")||n.includes("/dist/")||n.endsWith(".lock"))return c();let r=n.split(".").pop()?.toLowerCase()||"";if(!xo.includes(r))return c();let s=To(n);if(!s)return c();let o=p(t,"tool_input.content")||"";if(!o){let m=g(),S=n.startsWith("/")?n:`${m}/${n}`;if(je(S))try{o=He(S,"utf8").split(`
`).slice(0,150).join(`
`)}catch{return c()}}if(!o)return c();let i=wo(n),u=C([]),a=C([]),d=C([]),f=C([]),h=C([]);switch(s){case"python":{let m=Eo(o);u=C(m.functions),a=C(m.classes),d=C(m.variables),f=C(m.constants);break}case"typescript":case"javascript":{let m=vo(o);u=C(m.functions),a=C(m.classes),d=C(m.variables),h=C([...m.interfaces,...m.types]);break}}let k=g(),v=`${k}/.claude/feedback/naming-conventions.json`;try{bo(`${k}/.claude/feedback`,{recursive:!0});let m=Io(v);m.last_updated=new Date().toISOString(),m.samples_count++,m.file_naming[i]=(m.file_naming[i]||0)+1,m.languages[s]||(m.languages[s]=$o());let S=m.languages[s];S.samples++;for(let b of Object.keys(u))S.functions[b]=(S.functions[b]||0)+u[b],S.classes[b]=(S.classes[b]||0)+a[b],S.variables[b]=(S.variables[b]||0)+d[b],S.constants[b]=(S.constants[b]||0)+f[b],S.types[b]=(S.types[b]||0)+h[b];So(v,JSON.stringify(m,null,2))}catch(m){l("naming-convention-learner",`Error updating profile: ${m}`)}return l("naming-convention-learner",`Analyzed ${s} file (${n}): file=${i}`),c()}import{existsSync as Ro,readFileSync as Ao,writeFileSync as Ne,mkdirSync as Po}from"node:fs";var Oo={"api-design|python-backend":"Both relate to API design. Consider using api-design for patterns, python-backend for implementation.","python-backend|database-patterns":"Both relate to database. Use database-patterns for schema design, python-backend for async patterns.","caching|performance":"Both optimize performance. Consider consolidating caching queries."};function Do(t){if(!Ro(t))try{Po(w("node:path").dirname(t),{recursive:!0}),Ne(t,JSON.stringify({version:"1.0",skills:{},sessions:{},last_updated:""}))}catch{}}function tt(t){Do(t);try{return JSON.parse(Ao(t,"utf8"))}catch{return{version:"1.0",skills:{},sessions:{},last_updated:""}}}function jo(t,e,n){let r=tt(n),s=new Date().toISOString();r.skills[t]=(r.skills[t]||0)+1,r.sessions[e]||(r.sessions[e]=[]),r.sessions[e].includes(t)||r.sessions[e].push(t),r.last_updated=s;try{Ne(n,JSON.stringify(r,null,2)),l("skill-usage-optimizer",`Updated usage for skill: ${t} (session: ${e})`)}catch{}}function Ho(t,e){return tt(e).sessions[t]||[]}function No(t,e){for(let[n,r]of Object.entries(Oo)){let[s,o]=n.split("|");if(t===s||t===o){let i=t===s?o:s;if(e.includes(i))return l("skill-usage-optimizer",`Overlap detected: ${s} + ${o}`),r}}return null}function Fo(t){let e=tt(t),n=Object.entries(e.skills);return n.length===0?"":n.sort((r,s)=>s[1]-r[1]).slice(0,3).map(([r,s])=>`${r}:${s}`).join(", ")}function et(t){let e=t.tool_name||"",n=p(t,"tool_input.skill")||p(t,"tool_name")||"";if(e!=="Skill"&&!n?.startsWith("skills/")&&!n)return c();if(!n)return c();let s=`${g()}/.claude/feedback/skill-usage.json`,o=y();jo(n,o,s);let i=Ho(o,s),u=No(n,i),a=Fo(s),d="";u&&(d=`Skill overlap: ${u}`,l("skill-usage-optimizer",`Suggesting consolidation for: ${n}`));let h=tt(s).skills[n]||0;return h>0&&h%5===0&&a&&(d?d=`${d} | Top skills: ${a}`:d=`Top skills this project: ${a}`),d?(d.length>200&&(d=`${d.substring(0,197)}...`),{continue:!0,hookSpecificOutput:{additionalContext:d}}):c()}import{existsSync as Lo,readFileSync as Mo,writeFileSync as Fe,mkdirSync as Bo}from"node:fs";import{execSync as I}from"node:child_process";function Uo(t){let e=t.match(/^(issue|fix|feature|bug|feat)\/(\d+)/);return e?e[2]:(e=t.match(/^(\d+)-/),e?e[1]:null)}function zo(t){let e=t.match(/#(\d+)/);return e?e[1]:(e=t.match(/(fix|fixes|close|closes|resolve|resolves)\s+#?(\d+)/i),e?e[2]:null)}function Wo(){try{return I("git branch --show-current 2>/dev/null || git rev-parse --abbrev-ref HEAD 2>/dev/null",{encoding:"utf8",timeout:5e3}).trim()}catch{return""}}function Jo(){try{let t=I("git rev-parse --short HEAD 2>/dev/null",{encoding:"utf8",timeout:5e3}).trim(),e=I("git log -1 --pretty=%s 2>/dev/null",{encoding:"utf8",timeout:5e3}).trim(),n=I("git log -1 --pretty=%cI 2>/dev/null",{encoding:"utf8",timeout:5e3}).trim()||new Date().toISOString();return{sha:t,message:e,timestamp:n}}catch{return null}}function Go(t,e){if(!Lo(t))try{Bo(w("node:path").dirname(t),{recursive:!0}),Fe(t,JSON.stringify({session_id:e,issues:{}}))}catch{}}function qo(t,e,n,r,s){Go(r,s);try{let o=JSON.parse(Mo(r,"utf8"));return o.issues[t]||(o.issues[t]={commits:[],tasks_completed:[],pr_url:null,branch:n}),o.issues[t].commits.push(e),o.issues[t].branch=n,Fe(r,JSON.stringify(o,null,2)),l("issue-progress-commenter",`Queued commit for issue #${t}`),!0}catch{return l("issue-progress-commenter",`Error queuing commit for issue #${t}`),!1}}function nt(t){if((t.tool_name||"")!=="Bash")return c();let n=p(t,"tool_input.command")||"",r=t.exit_code??0;if(!/git\s+commit/i.test(n)||r!==0)return c();l("issue-progress-commenter","Processing git commit command...");try{I("which gh",{stdio:"ignore",timeout:2e3})}catch{return l("issue-progress-commenter","gh CLI not available, skipping issue progress tracking"),c()}try{if(!I("git remote get-url origin 2>/dev/null",{encoding:"utf8",timeout:5e3}).includes("github"))return l("issue-progress-commenter","Not a GitHub repository, skipping"),c()}catch{return c()}let s=Wo();if(!s)return l("issue-progress-commenter","Could not determine current branch"),c();let o=Uo(s);if(!o)try{let d=I("git log -1 --pretty=%s 2>/dev/null",{encoding:"utf8",timeout:5e3}).trim();o=zo(d)}catch{}if(!o)return l("issue-progress-commenter",`No issue number found in branch '${s}' or commit message`),c();l("issue-progress-commenter",`Found issue #${o}`);try{I(`gh issue view ${o} --json number`,{stdio:"ignore",timeout:5e3})}catch{return l("issue-progress-commenter",`Issue #${o} not found or not accessible`),c()}let i=Jo();if(!i)return l("issue-progress-commenter","Could not get commit info"),c();let u=(t.session_id||y()).replace(/[^a-zA-Z0-9_-]/g,""),a=`${N(u)}/issue-progress.json`;return qo(o,i,s,a,u),c()}import{existsSync as Zo,readFileSync as Ko,writeFileSync as Vo}from"node:fs";import{execSync as $}from"node:child_process";function Xo(t){let e=t.replace(/^[a-z]+(\([^)]*\))?:\s*/i,"");return e=e.replace(/\(#\d+\)/g,""),e.trim()}function Le(t){return t.toLowerCase().replace(/\s+/g," ").trim()}function Yo(t,e){let n=Le(t),r=Le(e);if(n===r||n.includes(r)||r.includes(n))return!0;let s=new Set(n.split(" ").filter(u=>u.length>=3)),o=r.split(" ").filter(u=>u.length>=3),i=0;for(let u of o)s.has(u)&&i++;return i>=2}function Qo(t){let e=t.match(/^(issue|fix|feature|bug|feat)\/(\d+)/);return e?e[2]:(e=t.match(/^(\d+)-/),e?e[1]:null)}function ti(t){let e=t.match(/#(\d+)/);return e?e[1]:null}function ei(t){try{let n=$(`gh issue view ${t} --json body -q '.body' 2>/dev/null`,{encoding:"utf8",timeout:1e4}).split(`
`),r=[];for(let s of n){let o=s.match(/^\s*-\s*\[\s*\]\s+(.+)/);o&&r.push(o[1].trim())}return r}catch{return[]}}function ni(t,e){l("issue-subtask-updater",`Attempting to update checkbox: '${e}' in issue #${t}`);try{let n=$(`gh issue view ${t} --json body -q '.body' 2>/dev/null`,{encoding:"utf8",timeout:1e4}),r=e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),s=n.replace(new RegExp(`(^\\s*-\\s*)\\[\\s*\\](\\s+${r})`,"m"),"$1[x]$2");if(n===s)return l("issue-subtask-updater",`No change needed for checkbox: '${e}'`),!1;let o=$("gh repo view --json nameWithOwner -q '.nameWithOwner' 2>/dev/null",{encoding:"utf8",timeout:5e3}).trim(),i=JSON.stringify(s);return $(`gh api -X PATCH "repos/${o}/issues/${t}" -f body=${i}`,{stdio:"ignore",timeout:1e4}),l("issue-subtask-updater",`Successfully updated checkbox: '${e}'`),!0}catch(n){return l("issue-subtask-updater",`Failed to update issue body: ${n}`),!1}}function ri(t,e,n){if(Zo(n))try{let r=JSON.parse(Ko(n,"utf8"));r.issues[t]||(r.issues[t]={commits:[],tasks_completed:[],pr_url:null}),r.issues[t].tasks_completed.includes(e)||(r.issues[t].tasks_completed.push(e),Vo(n,JSON.stringify(r,null,2)))}catch{}}function rt(t){if((t.tool_name||"")!=="Bash")return c();let n=p(t,"tool_input.command")||"",r=t.exit_code??0;if(!/git\s+commit/i.test(n)||r!==0)return c();l("issue-subtask-updater","Processing git commit for subtask updates...");try{$("which gh",{stdio:"ignore",timeout:2e3})}catch{return l("issue-subtask-updater","gh CLI not available, skipping subtask updates"),c()}try{if(!$("git remote get-url origin 2>/dev/null",{encoding:"utf8",timeout:5e3}).includes("github"))return l("issue-subtask-updater","Not a GitHub repository, skipping"),c()}catch{return c()}let s="",o="";try{s=$("git branch --show-current 2>/dev/null",{encoding:"utf8",timeout:5e3}).trim(),o=$("git log -1 --pretty=%s 2>/dev/null",{encoding:"utf8",timeout:5e3}).trim()}catch{return c()}let i=Qo(s);if(i||(i=ti(o)),!i)return l("issue-subtask-updater","No issue number found"),c();l("issue-subtask-updater",`Found issue #${i}, checking for matching subtasks...`);let u=Xo(o);if(!u)return l("issue-subtask-updater","Could not extract task from commit message"),c();l("issue-subtask-updater",`Commit task: '${u}'`);let a=ei(i);if(a.length===0)return l("issue-subtask-updater",`No unchecked tasks in issue #${i}`),c();let d=!1,f=(t.session_id||y()).replace(/[^a-zA-Z0-9_-]/g,""),h=`${N(f)}/issue-progress.json`;for(let k of a)Yo(u,k)&&(l("issue-subtask-updater",`Found matching checkbox: '${k}'`),ni(i,k)&&(ri(i,k,h),d=!0));return d?{continue:!0,suppressOutput:!0,hookSpecificOutput:{hookEventName:"PostToolUse",additionalContext:`Issue #${i}: Automatically marked sub-task as complete based on commit.`}}:(l("issue-subtask-updater",`No matching checkboxes found for task: '${u}'`),c())}import{existsSync as bt,readFileSync as Me,writeFileSync as Be,mkdirSync as si}from"node:fs";import{join as Ue,dirname as oi,basename as ze}from"node:path";var xt=[/\b(all )?tests?\s*(passed|passing|pass)\b/i,/\b(test|tests)\s*(suite)?\s*(passed|successful|succeeded)\b/i,/\b\d+\s*passed?,?\s*0\s*failed\b/i,/\bOK\s*\(\d+\s*tests?\)/i,/\bbuild\s*(succeeded|successful|complete(d)?)\b/i,/\bcompiled?\s*successfully\b/i,/\bbundle\s*(created|generated)\b/i,/\bfixed\b/i,/\bresolved\b/i,/\bsolved\b/i,/\bnow works\b/i,/\bworking\s*(now|correctly|properly)\b/i,/\bno\s*(more\s*)?(errors?|issues?|problems?)\b/i,/\bsuccess(ful(ly)?)?\b/i,/\bready\s*(for|to)\b/i,/\bcomplete(d)?\b/i],We=[/\b(tests?\s*)?(failed|failing|failure)\b/i,/\berror(s)?\b/i,/\bexception\b/i,/\bcrash(ed|ing)?\b/i,/\btimeout\b/i,/\bnot\s*(found|working|defined)\b/i,/\bundefined\b/i,/\bsyntax\s*error\b/i,/\btype\s*error\b/i,/\bcannot\s*(find|read|import)\b/i];function Je(){return Ue(g(),".claude","memory","open-problems.jsonl")}function ii(){return Ue(g(),".claude","memory","problem-solutions.jsonl")}function ai(t){let e=Je();if(!bt(e))return[];try{let r=Me(e,"utf-8").trim().split(`
`).filter(Boolean),s=[];for(let o of r)try{let i=JSON.parse(o);i.status==="open"&&(!t||i.session_id===t)&&s.push(i)}catch{}return s.slice(-50).reverse()}catch(n){return l("problem-tracker",`Failed to load open problems: ${n}`,"warn"),[]}}function ci(t,e,n){let r=Je();if(!bt(r))return!1;try{let o=Me(r,"utf-8").trim().split(`
`).filter(Boolean),i=!1,u=o.map(a=>{try{let d=JSON.parse(a);return d.id===t?(d.status=e,n&&(d.solution=n),i=!0,JSON.stringify(d)):a}catch{return a}});return i&&Be(r,`${u.join(`
`)}
`),i}catch(s){return l("problem-tracker",`Failed to update problem ${t}: ${s}`,"warn"),!1}}function ui(t){let e=ii();try{let n=oi(e);bt(n)||si(n,{recursive:!0});let r=`${JSON.stringify(t)}
`;return Be(e,r,{flag:"a"}),l("problem-tracker",`Stored problem-solution pair: ${t.problem_id} \u2192 ${t.tool}`,"info"),!0}catch(n){return l("problem-tracker",`Failed to store pair: ${n}`,"warn"),!1}}function Ct(t){return xt.some(e=>e.test(t))}function li(t){return We.some(e=>e.test(t))}function di(t,e,n,r){let s=.3;r===0?s+=.2:r!==void 0&&r!==0&&(s-=.3);let o=xt.filter(d=>d.test(e)).length;s+=Math.min(.3,o*.1);let i=We.filter(d=>d.test(e)).length;s-=Math.min(.4,i*.15);let u=e.toLowerCase(),a=t.entities.filter(d=>u.includes(d.toLowerCase()));return s+=Math.min(.15,a.length*.05),n==="Bash"?/test|pytest|jest|vitest/i.test(e)&&(s+=.1):(n==="Write"||n==="Edit")&&(s+=.05),Math.max(0,Math.min(1,s))}function gi(t,e,n){let r=t.split(`
`).filter(s=>s.trim());for(let s of xt){let o=t.match(s);if(o){let i=pi(t,o.index||0);if(i)return i.slice(0,200)}}for(let s of r.slice(0,5)){let o=s.trim();if(o.length>10&&o.length<200)return o}return n?`${e} operation on ${ze(n)} completed`:`${e} completed successfully`}function pi(t,e,n=100){let r=Math.max(0,e-20),s=Math.min(t.length,e+n),o=t.slice(r,s).trim();o=o.replace(/\s+/g," ");let i=o.search(/[.!?]\s/);return i>20&&(o=o.slice(0,i+1)),o}function Ge(t,e,n,r,s){if(li(t)&&!Ct(t))return 0;let o=ai(s);if(o.length===0)return 0;let i=ze(g())||"unknown",u=new Date().toISOString(),a=0;for(let d of o){let f=di(d,t,e,r);if(f>=.6){let h={text:gi(t,e,n),tool:e,file:n,timestamp:u,confidence:f,exit_code:r};if(ci(d.id,"solved",h)){let v={problem_id:d.id,problem_text:d.text,solution_text:h.text,tool:e,file:n,entities:d.entities,confidence:f,paired_at:u,session_id:s,project:i};ui(v)&&(a++,ge(h.text,d.id,f))}}}return a}var qe="solution-detector",fi=20,mi=["Bash","Write","Edit","Task"];function st(t){let e=t.tool_name||"";if(!mi.includes(e))return c();let n=yi(t);if(!n||n.length<fi)return c();if(!Ct(n))return c();let r=t.session_id||y(),s=t.exit_code,o=p(t,"tool_input.file_path");try{let i=Ge(n,e,o,s,r);i>0&&l(qe,`Paired ${i} problem(s) with solution from ${e}`,"info")}catch(i){l(qe,`Error pairing solutions: ${i}`,"warn")}return c()}function yi(t){let e=t.tool_result;if(typeof e=="string")return e;if(e&&typeof e=="object"){let s=e.content;if(typeof s=="string")return s}let n=t.tool_output;if(typeof n=="string")return n;if(n&&typeof n=="object"){let s=n.content;if(typeof s=="string")return s}let r=t.output;return typeof r=="string"?r:""}var hi=[/sk-[a-zA-Z0-9]{20,}/,/ghp_[a-zA-Z0-9]{36}/,/AKIA[A-Z0-9]{16}/,/xox[baprs]-[a-zA-Z0-9-]+/,/tvly-[a-zA-Z0-9-]{10,}/,/m0-[a-zA-Z0-9]{10,}/],_i=[/password\s*[:=]\s*['"][^'"]+['"]/i,/secret\s*[:=]\s*['"][^'"]+['"]/i];function Ze(t){let e=t.tool_result||t.output||"";if(!e)return c();for(let n of hi)if(n.test(e)){process.stderr.write(`::warning::Potential API key detected in output - verify redaction
`);break}for(let n of _i)if(n.test(e)){process.stderr.write(`::warning::Potential hardcoded credential in output
`);break}return c()}import{existsSync as ki,mkdirSync as Si}from"node:fs";var bi=[{pattern:/"allow"\s*:.*"Bash"/,label:"permission-escalation: Bash added to allow list"},{pattern:/--no-verify/,label:"hook-bypass: --no-verify detected"},{pattern:/["'](API_KEY|SECRET_KEY|AUTH_TOKEN|DB_PASSWORD)["']\s*[:=]/i,label:"secret-exposure: credential key in config"},{pattern:/"deny"\s*:\s*\[\s*\]/,label:"permission-gap: empty deny list"}];function xi(t){if(!t)return!1;let e=t.replace(/\\/g,"/");return/\/\.claude(\/|$)/.test(e)||e.startsWith(".claude/")}function Ci(t){let e=[];for(let{pattern:n,label:r}of bi)n.test(t)&&e.push(r);return e}function ot(t){let e=t.tool_name||"";if(e!=="Write"&&e!=="Edit")return c();let n=p(t,"tool_input.file_path")||"";if(!xi(n))return c();let s=`${g()}/.claude/logs`,o=`${s}/config-audit.jsonl`;try{ki(s)||Si(s,{recursive:!0});let i={timestamp:new Date().toISOString(),tool:e,file:n,session_id:t.session_id||"unknown"};_(o,`${JSON.stringify(i)}
`),l("config-change-auditor",`Config change: ${e} -> ${n}`);let u=p(t,"tool_input.content")||p(t,"tool_input.new_string")||"";u||l("config-change-auditor",`Warning: empty content for ${e} on ${n} \u2014 pattern detection skipped`);let a=Ci(u);if(a.length>0){let d=`Config audit: ${a.join("; ")} in ${n}`;l("config-change-auditor",`DANGEROUS: ${d}`,"warn")}}catch(i){l("config-change-auditor",`Error: ${i.message}`,"error")}return c()}import{writeFileSync as Ei,mkdirSync as vi,existsSync as wi}from"node:fs";import{join as Ke,basename as Ti}from"node:path";function Ve(t,e){let n=g();if(!n)return;let r=Ke(n,".claude","logs");wi(r)||vi(r,{recursive:!0});try{let s=Ke(r,Ti(t));Ei(s,`${JSON.stringify(e)}
`,{flag:"a"})}catch{}}function it(t){let e=t.tool_input||{},n=e.team_name;if(!n)return c();let r=e.name||"unnamed-teammate",s=e.subagent_type||"unknown",o=e.model||"default",i=e.description||"";return l("team-member-start",`Team "${n}": member "${r}" (${s}) started`),Ve("teammate-activity.jsonl",{timestamp:new Date().toISOString(),event:"team_member_start",team_name:n,member_name:r,subagent_type:s,model:o,description:i,session_id:t.session_id}),D("team-activity.jsonl",{ts:new Date().toISOString(),pid:O(process.env.CLAUDE_PROJECT_DIR||""),event:"spawn",agent:s,member:r,model:o,team:n}),c()}import{existsSync as Ye,readFileSync as Ii,writeFileSync as $i,mkdirSync as Ri}from"node:fs";import{join as Ai,dirname as Pi}from"node:path";var Qe="tool-preference-learner",Oi={Glob:["file_search"],"Bash:find":["file_search"],"Bash:ls":["file_search"],Grep:["content_search"],"Bash:grep":["content_search"],"Bash:rg":["content_search"],"Bash:ag":["content_search"],Read:["code_reading"],"Bash:cat":["code_reading"],"Bash:head":["code_reading"],"Bash:tail":["code_reading"],Write:["code_writing"],Edit:["code_writing"],MultiEdit:["code_writing"],NotebookEdit:["code_writing"],"Bash:test":["testing"],"Bash:pytest":["testing"],"Bash:jest":["testing"],"Bash:vitest":["testing"],"Bash:npm_test":["testing"],"Bash:build":["building"],"Bash:npm_run_build":["building"],"Bash:make":["building"],"Bash:cargo_build":["building"],"Bash:tsc":["building"],"Bash:git":["git_operations"],"Bash:gh":["git_operations"],"Skill:commit":["git_operations"],"Skill:create-pr":["git_operations"],Task:["agent_spawn"]},Di=[[/\bfind\s+/,"Bash:find"],[/\bls\s+/,"Bash:ls"],[/\bgrep\s+/,"Bash:grep"],[/\brg\s+/,"Bash:rg"],[/\bag\s+/,"Bash:ag"],[/\bcat\s+/,"Bash:cat"],[/\bhead\s+/,"Bash:head"],[/\btail\s+/,"Bash:tail"],[/\bpytest\b/,"Bash:pytest"],[/\bjest\b/,"Bash:jest"],[/\bvitest\b/,"Bash:vitest"],[/\bnpm\s+test\b/,"Bash:npm_test"],[/\bnpm\s+run\s+build\b/,"Bash:npm_run_build"],[/\bmake\b/,"Bash:make"],[/\bcargo\s+build\b/,"Bash:cargo_build"],[/\btsc\b/,"Bash:tsc"],[/\bgit\s+/,"Bash:git"],[/\bgh\s+/,"Bash:gh"]];function ji(t){for(let[e,n]of Di)if(e.test(t))return n;return"Bash:other"}function Hi(t,e,n){return t==="Bash"&&e?ji(e):t==="Skill"&&n?`Skill:${n}`:t}function Ni(t){return Oi[t]||["other"]}function tn(){return Ai(g(),".claude","memory","tool-preferences.json")}function Fi(){let t=tn();if(!Ye(t))return Xe();try{let e=Ii(t,"utf-8");return JSON.parse(e)}catch{return Xe()}}function Li(t){let e=tn();try{let n=Pi(e);return Ye(n)||Ri(n,{recursive:!0}),$i(e,JSON.stringify(t,null,2)),!0}catch(n){return l(Qe,`Failed to save preferences: ${n}`,"warn"),!1}}function Xe(){let t=["file_search","content_search","code_reading","code_writing","testing","building","git_operations","agent_spawn","other"],e={},n={};for(let r of t)e[r]={},n[r]=null;return{usage:e,preferences:n,updated_at:new Date().toISOString()}}function Mi(t,e){let n=Object.entries(e);if(n.length===0)return null;n.sort((d,f)=>f[1]-d[1]);let[r,s]=n[0],o=n.reduce((d,[,f])=>d+f,0),i=Math.min(1,s/10),u=s/o,a=i*.4+u*.6;return a<.3||s<2?null:{category:t,preferred_tool:r,confidence:a,sample_count:s,updated_at:new Date().toISOString()}}function Bi(t){let e=Object.keys(t.usage);for(let n of e)t.preferences[n]=Mi(n,t.usage[n]);t.updated_at=new Date().toISOString()}function at(t){let e=t.tool_name||"";if(!e)return c();let n=p(t,"tool_input.command"),r=p(t,"tool_input.skill"),s=Hi(e,n,r),i=Ni(s).filter(a=>a!=="other");if(i.length===0)return c();let u=Fi();for(let a of i)u.usage[a]||(u.usage[a]={}),u.usage[a][s]=(u.usage[a][s]||0)+1;Bi(u),Li(u);for(let a of i){let d=u.preferences[a];d&&d.confidence>.7&&d.sample_count===10&&l(Qe,`Strong preference detected: ${a} \u2192 ${d.preferred_tool} (${(d.confidence*100).toFixed(0)}%)`,"info")}return c()}var Ui=[{name:"session-metrics",fn:q,matcher:"*"},{name:"audit-logger",fn:L,matcher:"*"},{name:"calibration-tracker",fn:K,matcher:"*"},{name:"pattern-extractor",fn:X,matcher:"Bash"},{name:"issue-progress-commenter",fn:nt,matcher:"Bash"},{name:"issue-subtask-updater",fn:rt,matcher:"Bash"},{name:"code-style-learner",fn:Y,matcher:["Write","Edit"]},{name:"naming-convention-learner",fn:Q,matcher:["Write","Edit"]},{name:"skill-edit-tracker",fn:Z,matcher:["Write","Edit"]},{name:"skill-usage-optimizer",fn:et,matcher:"Skill"},{name:"realtime-sync",fn:U,matcher:["Bash","Write","Edit","Skill","Task"]},{name:"user-tracking",fn:J,matcher:"*"},{name:"solution-detector",fn:st,matcher:["Bash","Write","Edit","Task"]},{name:"tool-preference-learner",fn:at,matcher:"*"},{name:"redact-secrets",fn:Ze,matcher:"Bash"},{name:"config-change-auditor",fn:ot,matcher:["Write","Edit"]},{name:"team-member-start",fn:it,matcher:"Task"},{name:"error-logger",fn:M,matcher:["Bash","Write","Edit","Task"]}];function zi(t,e){return e==="*"?!0:Array.isArray(e)?e.includes(t):t===e}async function en(t){let e=t.tool_name||"";if(e==="Skill"){let o=t.tool_input?.skill||"";o&&D("skill-usage.jsonl",{ts:new Date().toISOString(),pid:O(process.env.CLAUDE_PROJECT_DIR||""),skill:o,...St()})}if(e==="TaskUpdate"){let o=t.tool_input?.status,i=t.tool_input?.taskId;o&&(o==="completed"||o==="in_progress")&&D("task-usage.jsonl",{ts:new Date().toISOString(),pid:O(process.env.CLAUDE_PROJECT_DIR||""),task_id:i||"unknown",task_status:o,source:"tool",...St()})}let n=Ui.filter(o=>zi(e,o.matcher));if(n.length===0)return c();let r=await Promise.allSettled(n.map(async o=>{try{let i=o.fn(t);return i instanceof Promise&&await i,{hook:o.name,status:"success"}}catch(i){let u=i instanceof Error?i.message:String(i);return l("unified-dispatcher",`${o.name} failed: ${u}`),{hook:o.name,status:"error",message:u}}})),s=[];for(let o of r)o.status==="rejected"?s.push("unknown"):o.value.status==="error"&&s.push(o.value.hook);return s.length>0&&l("posttool-dispatcher",`${s.length}/${n.length} hooks failed: ${s.join(", ")}`),c()}import{mkdirSync as Wi}from"node:fs";import{execSync as Ji}from"node:child_process";import{basename as Gi}from"node:path";function nn(t){if((t.tool_name||"")!=="Write")return c();let n=p(t,"tool_input.file_path")||process.env.TOOL_OUTPUT_FILE_PATH||"";if(!n)return c();if(n.includes("test")||n.includes("spec")||n.includes("__tests__"))return c();if(!/\.(py|ts|tsx|js|jsx)$/.test(n))return c();let r=g(),s="",o=Gi(n);if(n.endsWith(".py"))s=`test_${o.replace(".py","")}.py`;else if(/\.(ts|tsx|js|jsx)$/.test(n))s=`${o.replace(/\.[^.]+$/,"")}.test.*`;else return c();let i="";try{let a=B(r,"project dir"),d=Gt(s,"test pattern");i=Ji(`find "${a}" -type f -name "${d}" 2>/dev/null | head -1`,{encoding:"utf8",timeout:5e3}).trim()}catch{}let u=`${r}/.claude/hooks/logs`;try{Wi(u,{recursive:!0});let a=new Date().toISOString();if(i)_(`${u}/coverage-predictor.log`,`[${a}] COVERAGE_OK: ${n} has tests at ${i}
`);else return _(`${u}/coverage-predictor.log`,`[${a}] COVERAGE_WARN: ${n} may lack test coverage (expected: ${s})
`),{continue:!0,systemMessage:`Consider adding tests for: ${n}`}}catch{}return c()}import{existsSync as Et,statSync as qi,mkdirSync as Zi}from"node:fs";import{basename as rn,dirname as Ki}from"node:path";function Vi(t,e){let n=rn(t),r=Ki(t),s=(t.split(".").pop()||"").toLowerCase();switch(n){case"package.json":if(Et(`${e}/${t}`))try{let o=w(`${e}/${t}`);if(Object.keys(o.scripts||{}).length>5)return{changeType:"scripts",readmeSection:"Available Scripts",suggestion:"Update README with new npm scripts"}}catch{}break;case"pyproject.toml":case"setup.py":case"setup.cfg":return{changeType:"python-config",readmeSection:"Installation",suggestion:"Verify README installation instructions match project config"};case"Dockerfile":case"docker-compose.yml":case"docker-compose.yaml":return{changeType:"docker",readmeSection:"Docker / Deployment",suggestion:"Update README Docker instructions"};case".env.example":case".env.template":return{changeType:"env",readmeSection:"Environment Variables",suggestion:"Update README environment variable documentation"}}if(t.includes("/api/")||t.includes("/routes/")||t.includes("/endpoints/"))return{changeType:"api",readmeSection:"API Endpoints",suggestion:"Update README API documentation or OpenAPI spec"};if(r.includes("/config")||r.includes("/settings"))return{changeType:"config",readmeSection:"Configuration",suggestion:"Document new configuration options in README"};if(["index.ts","index.js","main.py","app.py","__init__.py"].includes(n)&&t.split(/[/\\]/).length<=4)return{changeType:"entry-point",readmeSection:"Getting Started",suggestion:"Review README getting started section for accuracy"};if((t.includes("/bin/")||t.includes("/cli/")||t.includes("/scripts/"))&&["sh","py","ts"].includes(s))return{changeType:"cli",readmeSection:"CLI / Commands",suggestion:"Update README CLI usage documentation"};if(n==="index.ts"||n==="index.js"){let o=`${e}/${t}`;if(Et(o))try{let{readFileSync:i}=w("node:fs");if((i(o,"utf8").match(/^export/gm)||[]).length>5)return{changeType:"exports",readmeSection:"API Reference",suggestion:"Consider updating API reference with new exports"}}catch{}}return null}function Xi(t){for(let e of["README.md","Readme.md","readme.md","README.rst","README"])if(Et(`${t}/${e}`))return`${t}/${e}`;return null}function sn(t){if((t.tool_name||"")!=="Write")return c();let n=p(t,"tool_input.file_path")||"";if(!n)return c();if(n.includes("/.claude/")||n.includes("/node_modules/")||n.includes("/.git/")||n.includes("/dist/")||n.endsWith(".lock")||n.endsWith(".log"))return c();if(n.includes("test")||n.includes("spec")||n.includes("__tests__"))return c();let r=g(),s=Vi(n,r);if(!s)return c();let o=Xi(r),i;if(o){let a=0;try{let h=qi(o).mtime.getTime(),k=Date.now();a=Math.floor((k-h)/(86400*1e3))}catch{}let d=s.suggestion;a>30&&(d=`${d} (README last updated ${a}+ days ago)`),i=`README sync: ${s.changeType} change in ${rn(n)}. Section: '${s.readmeSection}'. ${d}`}else i=`README sync: ${s.changeType} change detected but no README.md found. Consider creating one.`;i.length>200&&(i=`README sync: ${s.changeType} change detected. Consider updating '${s.readmeSection}' section.`);let u=`${r}/.claude/hooks/logs`;try{Zi(u,{recursive:!0});let a=new Date().toISOString();_(`${u}/readme-sync.log`,`[${a}] README_SYNC: ${s.changeType} change in ${n} -> ${s.readmeSection}
`)}catch{}return l("readme-sync",`README_SYNC: ${s.changeType} change suggests README update`),{continue:!0,hookSpecificOutput:{additionalContext:i}}}var Yi=[{pattern:/ENOENT|no such file|not found/i,suggestion:"File not found. Check the path exists. Use Glob to search for the correct filename."},{pattern:/EACCES|permission denied/i,suggestion:"Permission denied. The file may be read-only or owned by another user."},{pattern:/ECONNREFUSED|ETIMEDOUT|network/i,suggestion:"Network error. Check if the service is running and accessible."},{pattern:/syntax error|SyntaxError|parse error/i,suggestion:"Syntax error in the code. Review the file for missing brackets, quotes, or semicolons."},{pattern:/command not found|not recognized/i,suggestion:"Command not found. Check if the tool is installed and in PATH."},{pattern:/timeout|timed out/i,suggestion:"Command timed out. Consider increasing the timeout or breaking the command into smaller steps."},{pattern:/ENOMEM|out of memory|heap/i,suggestion:"Out of memory. Try processing smaller chunks or increasing available memory."},{pattern:/merge conflict|CONFLICT/i,suggestion:"Merge conflict detected. Resolve conflicts manually before continuing."},{pattern:/lock|locked|ELOCK/i,suggestion:"Resource is locked. Wait for the lock to be released or check for stale locks."},{pattern:/type error|TypeError|cannot read prop/i,suggestion:"Type error. Check for null/undefined values and ensure correct types are passed."}];function on(t){let e=t.tool_error||"",n=t.tool_name||"unknown",r=t.exit_code;if(!e&&r===0)return c();l("failure-handler",`Tool ${n} failed: ${e.slice(0,200)}`);let s=[];for(let{pattern:i,suggestion:u}of Yi)i.test(e)&&s.push(u);if(s.length===0)return c();let o=[`[OrchestKit] Tool failure analysis for ${n}:`,...s.map(i=>`- ${i}`)].join(`
`);return Ft(o)}var an={"posttool/audit-logger":L,"posttool/unified-error-handler":M,"posttool/auto-lint":qt,"posttool/memory-bridge":Zt,"posttool/realtime-sync":U,"posttool/user-tracking":J,"posttool/session-metrics":q,"posttool/skill-edit-tracker":Z,"posttool/calibration-tracker":K,"posttool/unified-dispatcher":en,"posttool/write/code-style-learner":Y,"posttool/write/coverage-predictor":nn,"posttool/write/naming-convention-learner":Q,"posttool/write/readme-sync":sn,"posttool/bash/issue-progress-commenter":nt,"posttool/bash/issue-subtask-updater":rt,"posttool/bash/pattern-extractor":X,"posttool/skill/skill-usage-optimizer":et,"posttool/task/team-member-start":it,"posttool/failure-handler":on,"posttool/solution-detector":st,"posttool/tool-preference-learner":at,"posttool/config-change/security-auditor":ot};function vd(t){return an[t]}function wd(){return Object.keys(an)}export{Va as analyzeStagedChanges,Ua as escapeRegex,Un as estimateTokenCount,Ha as extractContext,Gn as extractIssueNumber,jt as fnv1aHash,Ea as getCachedBranch,zn as getCurrentBranch,Ka as getDefaultBranch,Ca as getEnvFile,p as getField,Jn as getGitStatus,vd as getHook,Nt as getLogDir,Nn as getLogLevel,Hn as getPluginRoot,g as getProjectDir,Ga as getRepoRoot,y as getSessionId,qn as getStagedFiles,Za as hasUncommittedChanges,an as hooks,ta as isBashInput,na as isEditInput,qa as isGitRepo,Wn as isProtectedBranch,ra as isReadInput,ea as isWriteInput,Ma as lineContainsAll,E as lineContainsAllCI,wd as listHooks,l as logHook,ja as logPermissionFeedback,Ba as normalizeCommand,va as normalizeLineEndings,$a as outputAllowWithContext,Ta as outputBlock,Oa as outputDeny,Ra as outputError,Ln as outputPromptContext,Na as outputPromptContextBudgeted,wa as outputSilentAllow,c as outputSilentSuccess,Pa as outputStderrWarning,Aa as outputWarning,Ft as outputWithContext,Ia as outputWithNotification,Da as outputWithUpdatedInput,La as readHookInput,Fn as shouldLog,Xa as validateBranchName,Fa as writeRulesFile};
//# sourceMappingURL=posttool.mjs.map
