// OrchestKit Hooks - notification bundle
// Generated: 2026-02-13T15:38:12.728Z

function Rt(t){return typeof t.command=="string"}function Ht(t){return typeof t.file_path=="string"&&typeof t.content=="string"}function Et(t){return typeof t.file_path=="string"&&typeof t.old_string=="string"&&typeof t.new_string=="string"}function Ot(t){return typeof t.file_path=="string"&&t.content===void 0}import{appendFileSync as H,existsSync as E,statSync as nt,renameSync as ot,mkdirSync as et,readSync as rt}from"node:fs";import{execSync as it}from"node:child_process";import L from"node:os";import a from"node:path";function U(){return process.env.HOME||process.env.USERPROFILE||L.homedir()}function l(){return process.env.CLAUDE_PROJECT_DIR||"."}function _(){return process.env.CLAUDE_PLUGIN_ROOT||process.env.CLAUDE_PROJECT_DIR||"."}function x(){return process.env.CLAUDE_PLUGIN_ROOT?a.join(U(),".claude","logs","ork"):a.join(l(),".claude","logs")}var Ct=a.join,Pt=a.sep;import{execSync as A}from"node:child_process";import{createHash as F}from"node:crypto";import{existsSync as y,readFileSync as B,writeFileSync as j,mkdirSync as M}from"node:fs";import{join as d,basename as G}from"node:path";var J=20,W=15,K=/[^a-z0-9-]/g;function z(t){let o=t||process.env.CLAUDE_PROJECT_DIR||process.cwd(),e=G(o);return I(e,J)}function Z(t){if(process.env.ORCHESTKIT_SESSION_BRANCH)return process.env.ORCHESTKIT_SESSION_BRANCH;let o=t||process.env.CLAUDE_PROJECT_DIR||process.cwd();try{let e=A("git branch --show-current",{cwd:o,encoding:"utf8",timeout:2e3,stdio:["pipe","pipe","pipe"]}).trim(),n=I(e||"detached",W);return process.env.ORCHESTKIT_SESSION_BRANCH=n,n}catch{return"nobranch"}}function X(t){let o=t||new Date,e=String(o.getMonth()+1).padStart(2,"0"),n=String(o.getDate()).padStart(2,"0");return`${e}${n}`}function q(t){let o=t||new Date,e=String(o.getHours()).padStart(2,"0"),n=String(o.getMinutes()).padStart(2,"0");return`${e}${n}`}function V(){let t=`${process.pid}-${Date.now()}-${Math.random()}`;return F("sha256").update(t).digest("hex").slice(0,4)}function I(t,o){return t.toLowerCase().replace(K,"-").replace(/-+/g,"-").replace(/^-|-$/g,"").slice(0,o)}function Q(t,o){let e=z(t),n=Z(t),r=X(o),i=q(o),s=V();return`${e}-${n}-${r}-${i}-${s}`}function Y(t){let o=t||process.env.CLAUDE_PROJECT_DIR||process.cwd(),e=d(o,".instance","session-id.json");if(y(e))try{let n=JSON.parse(B(e,"utf8"));if(n.session_id&&n.created_at){let r=Date.now()-new Date(n.created_at).getTime(),i=1440*60*1e3;if(r<i)return n.session_id}}catch{}}function tt(t,o){let e=o||process.env.CLAUDE_PROJECT_DIR||process.cwd(),n=d(e,".instance"),r=d(n,"session-id.json");try{y(n)||M(n,{recursive:!0}),j(r,JSON.stringify({session_id:t,created_at:new Date().toISOString()},null,2))}catch{}}function R(t){if(process.env.CLAUDE_SESSION_ID)return process.env.CLAUDE_SESSION_ID;let o=Y(t);if(o)return o;let e=Q(t);return tt(e,t),e}function O(){return x()}function S(){return l()}function st(){return _()}function Mt(){return process.env.CLAUDE_ENV_FILE?process.env.CLAUDE_ENV_FILE:`${st()}/.claude/.instance_env`}function m(){return R()}function T(t){if(process.env.ORCHESTKIT_BRANCH)return process.env.ORCHESTKIT_BRANCH;try{let o=it("git branch --show-current",{cwd:t||S(),encoding:"utf8",timeout:5e3,stdio:["pipe","pipe","pipe"]}).trim();return process.env.ORCHESTKIT_BRANCH=o,o}catch{return"unknown"}}function ut(){return process.env.ORCHESTKIT_LOG_LEVEL||"warn"}function Gt(t){return t.replace(/\r\n/g,`
`)}function ct(t){let o=["debug","info","warn","error"];return o.indexOf(t)>=o.indexOf(ut())}function u(){return{continue:!0,suppressOutput:!0}}function Jt(){return{continue:!0,suppressOutput:!0,hookSpecificOutput:{permissionDecision:"allow"}}}function Wt(t){return{continue:!1,stopReason:t,hookSpecificOutput:{permissionDecision:"deny",permissionDecisionReason:t}}}function Kt(t){return{continue:!0,suppressOutput:!0,hookSpecificOutput:{hookEventName:"PostToolUse",additionalContext:t}}}function at(t){return{continue:!0,suppressOutput:!0,hookSpecificOutput:{hookEventName:"UserPromptSubmit",additionalContext:t}}}function zt(t,o){let e={continue:!0,suppressOutput:!0};return t&&(e.systemMessage=t),o&&(e.hookSpecificOutput={hookEventName:"UserPromptSubmit",additionalContext:o}),e}function Zt(t,o){let e={continue:!0,hookSpecificOutput:{hookEventName:"PreToolUse",additionalContext:t,permissionDecision:"allow"}};return o?e.systemMessage=o:e.suppressOutput=!0,e}function Xt(t){return{continue:!0,systemMessage:t}}function qt(t){return{continue:!0,systemMessage:`\u26A0 ${t}`}}function Vt(t){process.stderr.write(`\u26A0 ${t}
`),process.exit(2)}function Qt(t){return{continue:!1,stopReason:t,hookSpecificOutput:{hookEventName:"PreToolUse",permissionDecision:"deny",permissionDecisionReason:t}}}function Yt(t){return{continue:!0,suppressOutput:!0,hookSpecificOutput:{hookEventName:"PreToolUse",updatedInput:t}}}var pt=200*1024,gt=100*1024;function b(t,o){if(E(t))try{if(nt(t).size>o){let n=`${t}.old.${Date.now()}`;ot(t,n)}}catch{}}function D(t){E(t)||et(t,{recursive:!0})}function c(t,o,e="debug"){if(!ct(e))return;let n=O(),r=`${n}/hooks.log`;try{D(n),b(r,pt);let i=new Date().toISOString().replace("T"," ").slice(0,19);H(r,`[${i}] [${e.toUpperCase()}] [${t}] ${o}
`)}catch{}}function tn(t,o,e){let n=O(),r=`${n}/permission-feedback.log`;try{D(n),b(r,gt);let i=new Date().toISOString(),s=e?.tool_name||process.env.HOOK_TOOL_NAME||"unknown",f=e?.session_id||m();H(r,`${i} | ${t} | ${o} | tool=${s} | session=${f}
`)}catch{}}function ft(t){if(!t)return 0;let n=(t.match(/[{};()=><]/g)||[]).length/t.length>.03?2.8:3.5;return Math.ceil(t.length/n)}function nn(t,o,e,n,r){let i=ft(t);return n&&n.isOverBudget(e)?(c(o,`Budget exhausted for ${e}, suppressing ${i}t`),u()):(r&&r.trackTokenUsage(o,e,i),at(t))}function on(){try{let t=[],e=Buffer.allocUnsafe(256),n,r=0;for(;;)try{if(n=rt(r,e,0,256,null),n===0)break;t.push(Buffer.from(e.subarray(0,n)))}catch{break}let i=Buffer.concat(t).toString("utf8").trim();return i?JSON.parse(i):{tool_name:"",session_id:m(),tool_input:{}}}catch{return{tool_name:"",session_id:m(),tool_input:{}}}}function en(t,o){let e=o.replace(/^\./,"").split("."),n=t;for(let r of e){if(n==null)return;n=n[r]}return n}function rn(t){return t.replace(/\\\s*[\r\n]+/g," ").replace(/\n/g," ").replace(/\s+/g," ").trim()}function sn(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}import{execSync as h}from"node:child_process";import{basename as lt}from"node:path";var C={permission_prompt:"Sosumi",idle_prompt:"Ping",default:"Ping"};function k(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function P(t){try{return h(`command -v ${t}`,{stdio:"ignore"}),!0}catch{return!1}}function dt(t){let o=t.match(/(?:feature|fix|bug|issue)[/-](\d+)/i);return o?`#${o[1]}`:null}function mt(){try{let t=S();return lt(t)}catch{return"Claude Code"}}function St(t,o){let e=dt(t),n=o==="permission_prompt"?"\u23F8 Permission needed":"\u{1F4A4} Waiting";return e?`${n} \xB7 ${e} \xB7 ${t}`:`${n} \xB7 ${t}`}function kt(t,o=120){return t.length<=o?t:t.substring(0,o-3)+"..."}function ht(t,o,e,n){try{let r=k(t),i=k(o),s=k(kt(e));return h(`osascript -e 'display notification "${s}" with title "${r}" subtitle "${i}" sound name "${n}"'`,{stdio:"ignore",timeout:5e3}),!0}catch{return!1}}function _t(t,o,e){try{let n=`${o}
${e}`;return h(`notify-send -- "${t}" "${n}"`,{stdio:"ignore",timeout:5e3}),!0}catch{return!1}}function p(t){let o=t.tool_input||{},e=o.message||t.message||"",n=o.notification_type||t.notification_type||"";if(c("desktop",`Notification: [${n}] ${e.substring(0,100)}`),n!=="permission_prompt"&&n!=="idle_prompt")return u();let r=mt(),i=T(),s=St(i,n),f=C[n]||C.default;return P("osascript")?ht(r,s,e,f):P("notify-send")&&_t(r,s,e),u()}import{execSync as v}from"node:child_process";var xt={permission_prompt:"/System/Library/Sounds/Sosumi.aiff",idle_prompt:"/System/Library/Sounds/Ping.aiff",auth_success:"/System/Library/Sounds/Glass.aiff"};function yt(){try{return v("command -v afplay",{stdio:"ignore"}),!0}catch{return!1}}function It(t){try{v(`afplay "${t}" &`,{stdio:"ignore"})}catch{}}function g(t){let e=(t.tool_input||{}).notification_type||"";if(c("sound",`Sound notification check: [${e}]`),yt()){let n=xt[e];n&&It(n)}return u()}var $=[{name:"desktop",fn:p},{name:"sound",fn:g}];async function N(t){let e=(await Promise.allSettled($.map(async n=>{try{let r=n.fn(t);return r instanceof Promise&&await r,{hook:n.name,status:"success"}}catch(r){let i=r instanceof Error?r.message:String(r);return c("notification-dispatcher",`${n.name} failed: ${i}`),{hook:n.name,status:"error",message:i}}}))).filter(n=>n.status==="rejected"||n.status==="fulfilled"&&n.value.status==="error");return e.length>0&&c("notification-dispatcher",`${e.length}/${$.length} hooks had errors`),u()}var w={"notification/desktop":p,"notification/sound":g,"notification/unified-dispatcher":N};function In(t){return w[t]}function Rn(){return Object.keys(w)}export{sn as escapeRegex,ft as estimateTokenCount,T as getCachedBranch,Mt as getEnvFile,en as getField,In as getHook,O as getLogDir,ut as getLogLevel,st as getPluginRoot,S as getProjectDir,m as getSessionId,w as hooks,Rt as isBashInput,Et as isEditInput,Ot as isReadInput,Ht as isWriteInput,Rn as listHooks,c as logHook,tn as logPermissionFeedback,rn as normalizeCommand,Gt as normalizeLineEndings,Zt as outputAllowWithContext,Wt as outputBlock,Qt as outputDeny,Xt as outputError,at as outputPromptContext,nn as outputPromptContextBudgeted,Jt as outputSilentAllow,u as outputSilentSuccess,Vt as outputStderrWarning,qt as outputWarning,Kt as outputWithContext,zt as outputWithNotification,Yt as outputWithUpdatedInput,on as readHookInput,ct as shouldLog};
//# sourceMappingURL=notification.mjs.map
