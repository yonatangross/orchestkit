// OrchestKit Hooks - notification bundle
// Generated: 2026-03-01T09:37:00.318Z

function Gt(t){return typeof t.command=="string"}function Wt(t){return typeof t.file_path=="string"&&typeof t.content=="string"}function Jt(t){return typeof t.file_path=="string"&&typeof t.old_string=="string"&&typeof t.new_string=="string"}function zt(t){return typeof t.file_path=="string"&&t.content===void 0}import{existsSync as l,statSync as dt,renameSync as mt,mkdirSync as N,readSync as ht,readFileSync as St,writeFileSync as _t}from"node:fs";import{join as xt}from"node:path";import{appendFileSync as J,mkdirSync as z}from"node:fs";import{dirname as K}from"node:path";var g=[],_=!1,C=!1;function k(t,e){g.push({filePath:t,content:e}),Z()}function x(){if(_||g.length===0)return;_=!0;let t=new Map;for(let e of g){let n=t.get(e.filePath);n?n.push(e.content):t.set(e.filePath,[e.content])}for(let[e,n]of t)try{z(K(e),{recursive:!0}),J(e,n.join(""))}catch{}g.length=0,_=!1}function Z(){C||(C=!0,process.on("exit",x),process.on("SIGTERM",()=>{x(),process.exit(0)}),process.on("SIGINT",()=>{x(),process.exit(0)}))}import{execSync as kt}from"node:child_process";import X from"node:os";import f from"node:path";function q(){return process.env.HOME||process.env.USERPROFILE||X.homedir()}function y(){return process.env.CLAUDE_PROJECT_DIR||"."}function O(){return process.env.CLAUDE_PLUGIN_ROOT||process.env.CLAUDE_PROJECT_DIR||"."}function v(){return process.env.CLAUDE_PLUGIN_ROOT?f.join(q(),".claude","logs","ork"):f.join(y(),".claude","logs")}var Yt=f.join,te=f.sep;import{execSync as V}from"node:child_process";import{createHash as Q}from"node:crypto";import{existsSync as $,readFileSync as Y,writeFileSync as tt,mkdirSync as et}from"node:fs";import{join as R,basename as nt}from"node:path";var ot=20,rt=15,it=/[^a-z0-9-]/g;function st(t){let e=t||process.env.CLAUDE_PROJECT_DIR||process.cwd(),n=nt(e);return w(n,ot)}function ut(t){if(process.env.ORCHESTKIT_SESSION_BRANCH)return process.env.ORCHESTKIT_SESSION_BRANCH;let e=t||process.env.CLAUDE_PROJECT_DIR||process.cwd();try{let n=V("git branch --show-current",{cwd:e,encoding:"utf8",timeout:2e3,stdio:["pipe","pipe","pipe"]}).trim(),o=w(n||"detached",rt);return process.env.ORCHESTKIT_SESSION_BRANCH=o,o}catch{return"nobranch"}}function ct(t){let e=t||new Date,n=String(e.getMonth()+1).padStart(2,"0"),o=String(e.getDate()).padStart(2,"0");return`${n}${o}`}function at(t){let e=t||new Date,n=String(e.getHours()).padStart(2,"0"),o=String(e.getMinutes()).padStart(2,"0");return`${n}${o}`}function pt(){let t=`${process.pid}-${Date.now()}-${Math.random()}`;return Q("sha256").update(t).digest("hex").slice(0,4)}function w(t,e){return t.toLowerCase().replace(it,"-").replace(/-+/g,"-").replace(/^-|-$/g,"").slice(0,e)}function gt(t,e){let n=st(t),o=ut(t),r=ct(e),i=at(e),u=pt();return`${n}-${o}-${r}-${i}-${u}`}function ft(t){let e=t||process.env.CLAUDE_PROJECT_DIR||process.cwd(),n=R(e,".instance","session-id.json");if($(n))try{let o=JSON.parse(Y(n,"utf8"));if(o.session_id&&o.created_at){let r=Date.now()-new Date(o.created_at).getTime(),i=1440*60*1e3;if(r<i)return o.session_id}}catch{}}function lt(t,e){let n=e||process.env.CLAUDE_PROJECT_DIR||process.cwd(),o=R(n,".instance"),r=R(o,"session-id.json");try{$(o)||et(o,{recursive:!0}),tt(r,JSON.stringify({session_id:t,created_at:new Date().toISOString()},null,2))}catch{}}function P(t){if(process.env.CLAUDE_SESSION_ID)return process.env.CLAUDE_SESSION_ID;let e=ft(t);if(e)return e;let n=gt(t);return lt(n,t),n}function A(){return v()}function H(){return y()}function yt(){return O()}function le(){return process.env.CLAUDE_ENV_FILE?process.env.CLAUDE_ENV_FILE:`${yt()}/.claude/.instance_env`}function I(){return P()}function U(t){if(process.env.ORCHESTKIT_BRANCH)return process.env.ORCHESTKIT_BRANCH;try{let e=kt("git branch --show-current",{cwd:t||H(),encoding:"utf8",timeout:5e3,stdio:["pipe","pipe","pipe"]}).trim();return process.env.ORCHESTKIT_BRANCH=e,e}catch{return"unknown"}}function Rt(){return process.env.ORCHESTKIT_LOG_LEVEL||"warn"}function de(t){return t.replace(/\r\n/g,`
`)}function It(t){let e=["debug","info","warn","error"];return e.indexOf(t)>=e.indexOf(Rt())}function c(){return{continue:!0,suppressOutput:!0}}function me(){return{continue:!0,suppressOutput:!0,hookSpecificOutput:{permissionDecision:"allow"}}}function he(t){return{continue:!1,stopReason:t,hookSpecificOutput:{permissionDecision:"deny",permissionDecisionReason:t}}}function Se(t){return{continue:!0,suppressOutput:!0,hookSpecificOutput:{hookEventName:"PostToolUse",additionalContext:t}}}function Ht(t){return{continue:!0,suppressOutput:!0,hookSpecificOutput:{hookEventName:"UserPromptSubmit",additionalContext:t}}}function _e(t,e){let n={continue:!0,suppressOutput:!0};return t&&(n.systemMessage=t),e&&(n.hookSpecificOutput={hookEventName:"UserPromptSubmit",additionalContext:e}),n}function xe(t,e){let n={continue:!0,hookSpecificOutput:{hookEventName:"PreToolUse",additionalContext:t,permissionDecision:"allow"}};return e?n.systemMessage=e:n.suppressOutput=!0,n}function ke(t){return{continue:!0,systemMessage:t}}function ye(t){return{continue:!0,systemMessage:`\u26A0 ${t}`}}function Re(t){process.stderr.write(`\u26A0 ${t}
`),process.exit(2)}function Ie(t){return{continue:!1,stopReason:t,hookSpecificOutput:{hookEventName:"PreToolUse",permissionDecision:"deny",permissionDecisionReason:t}}}function He(t){return{continue:!0,suppressOutput:!0,hookSpecificOutput:{hookEventName:"PreToolUse",updatedInput:t}}}var Et=200*1024,Tt=100*1024;function L(t,e){if(l(t))try{if(dt(t).size>e){let o=`${t}.old.${Date.now()}`;mt(t,o)}}catch{}}function F(t){l(t)||N(t,{recursive:!0})}function s(t,e,n="debug"){if(!It(n))return;let o=A(),r=`${o}/hooks.log`;try{F(o),L(r,Et);let i=new Date().toISOString().replace("T"," ").slice(0,19);k(r,`[${i}] [${n.toUpperCase()}] [${t}] ${e}
`)}catch{}}function Ee(t,e,n){let o=A(),r=`${o}/permission-feedback.log`;try{F(o),L(r,Tt);let i=new Date().toISOString(),u=n?.tool_name||process.env.HOOK_TOOL_NAME||"unknown",a=n?.session_id||I();k(r,`${i} | ${t} | ${e} | tool=${u} | session=${a}
`)}catch{}}function Te(t){return t.hookSpecificOutput?.additionalContext?t.hookSpecificOutput.additionalContext:t.systemMessage&&typeof t.systemMessage=="string"?t.systemMessage:null}function bt(t){if(!t)return 0;let o=(t.match(/[{};()=><]/g)||[]).length/t.length>.03?2.8:3.5;return Math.ceil(t.length/o)}function be(t,e,n,o,r){let i=bt(t);return o?.isOverBudget(n)?(s(e,`Budget exhausted for ${n}, suppressing ${i}t`),c()):(r&&r.trackTokenUsage(e,n,i),Ht(t))}function D(t){let e=2166136261;for(let n=0;n<t.length;n++)e^=t.charCodeAt(n),e=Math.imul(e,16777619);return(e>>>0).toString(16).padStart(8,"0")}function Ce(t,e,n,o){let r=xt(t,e);if(l(r))try{let i=St(r,"utf8");if(D(i)===D(n))return s(o,`Rules file ${e} unchanged, skipping write`),!1}catch{}return l(t)||N(t,{recursive:!0}),_t(r,n,"utf8"),s(o,`Wrote rules file: ${r}`),!0}function Oe(){try{let t=[],n=Buffer.allocUnsafe(256),o,r=0;for(;;)try{if(o=ht(r,n,0,256,null),o===0)break;t.push(Buffer.from(n.subarray(0,o)))}catch{break}let i=Buffer.concat(t).toString("utf8").trim();return i?JSON.parse(i):{tool_name:"",session_id:I(),tool_input:{}}}catch{return{tool_name:"",session_id:I(),tool_input:{}}}}function ve(t,e){let n=e.replace(/^\./,"").split("."),o=t;for(let r of n){if(o==null)return;o=o[r]}return o}function $e(t,...e){return t.split(`
`).some(n=>e.every(o=>n.includes(o)))}function we(t,...e){return t.split(`
`).some(n=>{let o=n.toLowerCase();return e.every(r=>o.includes(r.toLowerCase()))})}function Pe(t){return t.replace(/\\\s*[\r\n]+/g," ").replace(/\n/g," ").replace(/\s+/g," ").trim()}function De(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}import{execSync as T}from"node:child_process";import{basename as Ct}from"node:path";function d(t){return`'${t.replace(/'/g,"'\\''")}'`}function j(t){if(!t||!/^[a-zA-Z0-9_-]+$/.test(t))throw new Error(`Unsafe command name: ${JSON.stringify(t)}`);return t}function m(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}var E=new Map;function M(t){let e=E.get(t);if(e!==void 0)return e;try{return j(t),T(`command -v ${t}`,{stdio:"ignore"}),E.set(t,!0),!0}catch{return E.set(t,!1),!1}}function Ot(t){let e=t.match(/(?:feature|fix|bug|issue)[/-](\d+)/i);return e?`#${e[1]}`:null}function vt(){try{let t=H();return Ct(t)}catch{return"Claude Code"}}function $t(t,e){return e==="permission_prompt"?`${t} needs approval`:`${t} is waiting for you`}function wt(t){if(!t||t==="unknown")return"";let e=Ot(t);return e?`${t} (${e})`:t}function Pt(t,e){return t&&t!=="test"&&t.length>5?t:e==="permission_prompt"?"A tool needs your permission to proceed.":"Claude is idle and waiting for your response."}function Dt(t,e=120){return t.length<=e?t:`${t.substring(0,e-3)}...`}function Nt(){let t=process.env.TERM_PROGRAM||"";return{WarpTerminal:"Warp","iTerm.app":"iTerm2",Apple_Terminal:"Terminal",Alacritty:"Alacritty",kitty:"kitty",tmux:"Terminal"}[t]||"Terminal"}function At(t,e,n){try{let o=m(t),r=m(e),i=m(Dt(n)),u=m(Nt()),a=[`display notification "${i}" with title "${o}" subtitle "${r}"`,`tell application "${u}" to activate`].join(`
`);return T(`osascript -e ${d(a)}`,{stdio:"ignore",timeout:5e3}),!0}catch{return!1}}function Ut(t,e,n){try{let o=`${e}
${n}`;return T(`notify-send -- ${d(t)} ${d(o)}`,{stdio:"ignore",timeout:5e3}),!0}catch{return!1}}function h(t){let e=t.tool_input||{},n=e.message||t.message||"",o=e.notification_type||t.notification_type||"";if(s("desktop",`Notification: [${o}] ${n.substring(0,100)}`),o!=="permission_prompt"&&o!=="idle_prompt")return c();let r=vt(),i=U(),u=$t(r,o),a=wt(i),b=Pt(n,o);return M("osascript")?At(u,a,b):M("notify-send")&&Ut(u,a,b),c()}import{execSync as Lt,spawn as Ft}from"node:child_process";var jt={permission_prompt:"/System/Library/Sounds/Sosumi.aiff",idle_prompt:"/System/Library/Sounds/Ping.aiff",auth_success:"/System/Library/Sounds/Glass.aiff"},p=null;function Mt(){if(p!==null)return p;try{Lt("command -v afplay",{stdio:"ignore"}),p=!0}catch{p=!1}return p}function Bt(t){try{Ft("afplay",[t],{stdio:"ignore",detached:!0}).unref()}catch{}}function S(t){let e=t.tool_input?.notification_type||t.notification_type||"";if(s("sound",`Sound notification check: [${e}]`),Mt()){let n=jt[e];n&&Bt(n)}return c()}var B=[{name:"desktop",fn:h},{name:"sound",fn:S}];async function G(t){let n=(await Promise.allSettled(B.map(async o=>{try{let r=o.fn(t);return r instanceof Promise&&await r,{hook:o.name,status:"success"}}catch(r){let i=r instanceof Error?r.message:String(r);return s("notification-dispatcher",`${o.name} failed: ${i}`),{hook:o.name,status:"error",message:i}}}))).filter(o=>o.status==="fulfilled"&&o.value.status==="error");return n.length>0&&s("notification-dispatcher",`${n.length}/${B.length} hooks had errors`),c()}var W={"notification/desktop":h,"notification/sound":S,"notification/unified-dispatcher":G};function Qe(t){return W[t]}function Ye(){return Object.keys(W)}export{De as escapeRegex,bt as estimateTokenCount,Te as extractContext,D as fnv1aHash,U as getCachedBranch,le as getEnvFile,ve as getField,Qe as getHook,A as getLogDir,Rt as getLogLevel,yt as getPluginRoot,H as getProjectDir,I as getSessionId,W as hooks,Gt as isBashInput,Jt as isEditInput,zt as isReadInput,Wt as isWriteInput,$e as lineContainsAll,we as lineContainsAllCI,Ye as listHooks,s as logHook,Ee as logPermissionFeedback,Pe as normalizeCommand,de as normalizeLineEndings,xe as outputAllowWithContext,he as outputBlock,Ie as outputDeny,ke as outputError,Ht as outputPromptContext,be as outputPromptContextBudgeted,me as outputSilentAllow,c as outputSilentSuccess,Re as outputStderrWarning,ye as outputWarning,Se as outputWithContext,_e as outputWithNotification,He as outputWithUpdatedInput,Oe as readHookInput,It as shouldLog,Ce as writeRulesFile};
//# sourceMappingURL=notification.mjs.map
