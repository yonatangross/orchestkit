// Generated by OrchestKit Claude Plugin
// Created: 2026-02-06

/**
 * Shared event logger for lifecycle hooks.
 * Writes structured JSONL entries to .claude/logs/<filename>.
 */

import { writeFileSync, mkdirSync, existsSync } from 'node:fs';
import { join } from 'node:path';
import { getProjectDir } from './common.js';

/**
 * Append a structured event to a JSONL log file.
 * Creates the logs directory if needed. Silently ignores write failures.
 */
export function appendEventLog(
  filename: string,
  entry: Record<string, unknown>,
): void {
  const projectDir = getProjectDir();
  if (!projectDir) return;

  const logsDir = join(projectDir, '.claude', 'logs');
  if (!existsSync(logsDir)) {
    mkdirSync(logsDir, { recursive: true });
  }

  try {
    const logPath = join(logsDir, filename);
    writeFileSync(logPath, `${JSON.stringify(entry)}\n`, { flag: 'a' });
  } catch {
    // Non-critical logging â€” don't block hook execution
  }
}
