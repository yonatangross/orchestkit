// Generated by OrchestKit Claude Plugin
// Created: 2026-02-21

/**
 * Worktree Lifecycle Logger
 * Logs worktree creation and removal events, emits advisory context.
 *
 * Hook events: WorktreeCreate, WorktreeRemove
 */

import type { HookInput, HookResult } from '../types.js';
import { logHook, outputSilentSuccess, outputPromptContext } from '../lib/common.js';

export function worktreeLifecycleLogger(input: HookInput): HookResult {
  const event = input.hook_event;
  const worktreePath = input.tool_input?.file_path || input.tool_input?.path || 'unknown';

  if (event === 'WorktreeCreate') {
    logHook('worktree-lifecycle', `Worktree created: ${worktreePath}`);
    return outputPromptContext(
      `[WorktreeCreate] A new worktree was created at: ${worktreePath}. ` +
      'You are now working in an isolated worktree. Changes here do not affect the main working tree.'
    );
  }

  if (event === 'WorktreeRemove') {
    logHook('worktree-lifecycle', `Worktree removed: ${worktreePath}`);
    return outputPromptContext(
      `[WorktreeRemove] Worktree removed: ${worktreePath}. ` +
      'The isolated worktree has been cleaned up. You are back in the main working tree.'
    );
  }

  logHook('worktree-lifecycle', `Unexpected event: ${event}`);
  return outputSilentSuccess();
}
